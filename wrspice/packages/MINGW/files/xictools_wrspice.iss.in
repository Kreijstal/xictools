
[Setup]

AppName=wrspice
AppVerName=wrspice-VERSION
AppVersion=VERSION
AppPublisher=Whiteley Research Inc.
AppPublisherURL=http://wrcad.com
AppMutex=wrspiceMutex

OutputBaseFilename=APPNAME-OSNAME-VERSION-ARCH

Compression=bzip

DefaultDirName=c:\usr\local
DefaultGroupName=XicTools
DirExistsWarning=no

PrivilegesRequired=admin

UninstallFilesDir={app}\TOOLROOT\wrspice.current\uninstall
UninstallDisplayIcon={app}\TOOLROOT\wrspice.current\bin\GTK2\wrspice.exe

[Files]

Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\preinstall.bat"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\postinstall.bat"; DestDir: "{app}\TOOLROOT\wrspice.current\bin"; BeforeInstall: DoBeforeInstall
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\wrspice.bat"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\wrspice.sh"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\GTK2\wrspice.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin\GTK2";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\GTK2\wrspice.dll"; DestDir: "{app}\TOOLROOT\wrspice.current\bin\GTK2";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\QT6\wrspice.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin\QT6";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\QT6\wrspice.dll"; DestDir: "{app}\TOOLROOT\wrspice.current\bin\QT6";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\wrspiced.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\csvtoraw.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\multidec.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\proc2mod.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\printtoraw.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\bin\mmjco.exe"; DestDir: "{app}\TOOLROOT\wrspice.current\bin"; AfterInstall: DoAfterInstall

Source: "..\root\usr\local\TOOLROOT\wrspice.current\examples\*"; DestDir: "{app}\TOOLROOT\wrspice.current\examples"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\examples\JJexamples\*"; DestDir: "{app}\TOOLROOT\wrspice.current\examples\JJexamples"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\examples\JJexamples_old\*"; DestDir: "{app}\TOOLROOT\wrspice.current\examples\JJexamples_old"

Source: "..\root\usr\local\TOOLROOT\wrspice.current\help\*"; DestDir: "{app}\TOOLROOT\wrspice.current\help"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\help\screenshots\*"; DestDir: "{app}\TOOLROOT\wrspice.current\help\screenshots"

Source: "..\root\usr\local\TOOLROOT\wrspice.current\startup\*"; DestDir: "{app}\TOOLROOT\wrspice.current\startup"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\startup\devices\*"; DestDir: "{app}\TOOLROOT\wrspice.current\startup\devices"

Source: "..\root\usr\local\TOOLROOT\wrspice.current\scripts\*"; DestDir: "{app}\TOOLROOT\wrspice.current\scripts"

Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\admst\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\admst"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsim6\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsim6"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsim6\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsim6\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsim6\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsim6\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsim6.1\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsim6.1"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsim6.1\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsim6.1\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsim6.1\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsim6.1\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsimcmg\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsimcmg"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsimcmg\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsimcmg\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsimcmg\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsimcmg\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsoi44\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsoi44"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsoi44\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsoi44\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsoi44\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsoi44\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsoi45\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsoi45"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsoi45\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsoi45\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\bsoi45\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\bsoi45\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\cap\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\cap"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\cap\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\cap\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\cap\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\cap\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\ekv\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\ekv"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\ekv\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\ekv\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\ekv\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\ekv\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\hicum0\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\hicum0"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\hicum0\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\hicum0\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\hicum0\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\hicum0\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\hicum2\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\hicum2"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\hicum2\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\hicum2\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\hicum2\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\hicum2\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\ind\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\ind"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\ind\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\ind\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\ind\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\ind\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\jj\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\jj"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\jj\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\jj\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\jj\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\jj\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\mextram\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\mextram"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\mextram\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\mextram\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\mextram\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\mextram\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\psp102\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\psp102"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\psp102\tests\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\psp102\tests"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\psp102\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\psp102\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\psp103\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\psp103"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\examples\psp103\module_dist\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\examples\psp103\module_dist"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\devkit\include\*"; DestDir: "{app}\TOOLROOT\wrspice.current\devkit\include"

Source: "..\root\usr\local\TOOLROOT\wrspice.current\docs\wrs*"; DestDir: "{app}\TOOLROOT\wrspice.current\docs";
Source: "..\root\usr\local\TOOLROOT\wrspice.current\docs\README"; DestDir: "{app}\TOOLROOT\wrspice.current\docs"
Source: "..\root\usr\local\TOOLROOT\wrspice.current\docs\MSWINFO.TXT"; DestDir: "{app}\TOOLROOT\wrspice.current\docs"

[Icons]

Name: "{group}\wrspice"; Filename: "{app}\TOOLROOT\wrspice.current\bin\wrspice.bat"; WorkingDir: "c:\"; IconFilename: "{app}\TOOLROOT\wrspice.current\bin\GTK2\wrspice.exe"

[code]

#include "..\..\..\xt_base\packages\files\inno_uninstall"

function InitializeSetup(): Boolean;
begin
  Result := True;
end;

procedure DoBeforeInstall();
var
    resultCode:  Integer;
begin
    Exec(ExpandConstant('{app}\TOOLROOT\wrspice.current\bin\preinstall.bat'),
        '', ExpandConstant('{app}\TOOLROOT'), SW_HIDE, ewWaitUntilTerminated,
        resultCode);
end;

procedure DoAfterInstall();
var
    resultCode:  Integer;
begin
    Exec(ExpandConstant('{app}\TOOLROOT\wrspice.current\bin\postinstall.bat'),
        '', ExpandConstant('{app}\TOOLROOT'), SW_HIDE, ewWaitUntilTerminated,
        resultCode);
end;

function InitializeUninstall(): Boolean;
begin
    DoBeforeInstall();
    Result := True;
end;

