% -----------------------------------------------------------------------------
% Xic Manual
% (C) Copyright 2009, Whiteley Research Inc., Sunnyvale CA
% $Id: filemenu.tex,v 1.83 2017/03/22 07:29:56 stevew Exp $
% -----------------------------------------------------------------------------

% -----------------------------------------------------------------------------
% xic:filemenu 041215
\chapter{The File Menu:  {\Xic} Input/Output}
\index{File menu}
The {\cb File Menu} contains commands for opening, listing, and saving
files and cells.  The printer interface for hard-copy plots is also
found in this menu.

Some of the menu commands bring up more complicated panels which
themselves may contain various command buttons and other objects. 
Most of these windows can be moved by pressing the left mouse button
in the area outside of any buttons, or on a label object, and dragging
the outline to the desired location.  This applies to the error
message and information windows that pop up under certain
circumstances.  These windows can also be deleted by double clicking
with button 2 in the area outside of buttons or other objects.

The table below lists the commands found in the {\cb File Menu}, along
with the internal command name and function.
%\ifoa
The {\cb OpenAccess Libs} button will appear only if the OpenAccess
plug-in is loaded.
%\fi

\begin{tabular}{|l|l|l|p{2in}|} \hline
\multicolumn{4}{|c|}{\kb File Menu}\\ \hline
\kb Label & \kb Name & \kb Pop-up & \kb Function\\ \hline\hline
\et File Select & \vt fsel & \cb File Selection & Open file\\ \hline
\et Open & \vt open & none & Open new cell or file\\ \hline
\et Save & \vt sv & {\cb Modified Cells} & Save modified cells\\ \hline
\et Save As & \vt save & none & Save file, rename\\ \hline
\et Save As Device & \vt sadev & {\cb Device Parameters} & Electrical
  mode only,{\newline}apply defaults and save device\\ \hline
\et Print & \vt hcopy & \cb Print Control Panel & Hard copy plot\\ \hline
\et Files List & \vt files & \cb Path Files Listing & List search path files\\
  \hline
\et Hierarchy Digests & \vt hier & \cb Cell Hierarchy Digests &
  List of Cell Hierarchy Digests\\ \hline
\et Geometry Digests & \vt geom & \cb Cell Geometry Digests &
  List of Cell Geometry Digests\\ \hline
\et Libraries List & \vt libs & \cb Libraries & List libraries\\ \hline
%\ifoa
\et OpenAccess Libs & \vt oalib & \cb OpenAccess Libraries & List OA
  libraries (with OA only)\\ \hline
%\fi
\et Quit & \vt quit & none & Exit {\Xic}\\ \hline
\end{tabular}


% -----------------------------------------------------------------------------
% xic:fsel 102208
\index{File Select button}
\section{The {\cb File Select} Button: Pop Up File Selection Panel}

The {\cb File Select} button in the {\cb File Menu} brings up the {\cb
File Selection} panel.  The {\cb File Selection} panel can be used to
select files to edit, or to manage files and directories on disk.  The
button can be used to bring up more than one {\cb File Selection}
panel, and drag/drop can be used to move files and directories.  From
this button, the {\cb File Selection} panel will list files in the
current directory, but this can be changed from the panel.


% -----------------------------------------------------------------------------
% xic:open 040724
\section{The {\cb Open} Button: Open Cell or File}
\label{editbut}
\index{Open button}
\index{editing cells}

The {\cb Open} button in the {\cb File Menu} is used to read a file
and/or load a cell for editing.  The button presents a drop-down menu
containing the names of the last eight cells opened for editing, plus
``{\cb new}'' and ``{\cb prev}'' entries.  If {\cb prev} is clicked,
the last opened cell (if any) will be reopened in the main window.

If one holds down {\kb Shift} while selecting one of cells from the
history list, the {\cb Cell Placement Control} panel will appear with
that cell added as the current master.  This applies to cell names and
not {\cb new} or {\cb prev}.  This is a quick backdoor for
instantiating cells recently edited.

Selecting {\cb new} with the {\kb Shift} button held down opens a new
cell with a unique name.  This can be used for experimentation, or for
other purposes.  The {\cb Save As} command can be used to save the
contents to a cell with a more descriptive name, if desired.

Otherwise selecting {\cb new} will use the prompt line to request a
file or cell name to open.  The internal keyword {\vt open} is
associated with this button.  The accelerator actually maps to the
{\cb new} button in the pop-up menu, i.e., the accelerator will cause
prompting for the name of a file or cell to open.

The default name used in the prompt of the cell to edit will be one of
the following.  Each of these sources is tested in order, and the
first one that is visible and has a selection will yield the default
name.

\begin{itemize}
\item{A selection in the {\cb File Selection} pop-up from the {\cb
 File Select} button in the {\cb File Menu}.}
\item{A selection in the {\cb Cells Listing} pop-up from the {\cb
 Cells List} button in the {\cb Cell Menu}.}
\item{A selection in the {\cb Files Listing} pop-up from the {\cb Files
 List} button in the {\cb File Menu}, or its {\cb Content List}.}
\item{A selection in the {\cb Content List} of the
 {\cb Libraries} pop-up from the {\cb Libraries List} button
 in the {\cb File Menu}.}
\item{A selection in the {\cb Cell Hierarchy Tree} pop-up from the {\cb
 Show Tree} button in the {\cb Cell Menu} or from the {\cb Tree}
 button in the {\cb Cells Listing} pop-up.}
\item{A cell name that is selected in the {\cb Info} pop-up, from
 the {\cb Info} button in either the {\cb View Menu} or the {\cb
 Cells Listing} pop-up.}
\item{The name of a selected subcell in the drawing window, the most
 recently selected if there is more than one.}
\item{The next cell from the command line invoking {\Xic}.}
\item{The current cell name.}
\end{itemize}

\subsection{Input to the Open Command}

The text given to the {\cb Open} command must contain at least one and
at most two names.  If a name contains white space, the name must be
quoted with double quote marks ({\vt "name with space"}) for it to be
recognized as a single token.  The first name is generally that of a
multi-cell source, such as a path to a layout file.  The second name,
which is optional, is the name of a cell from that source to open as
the current cell.  If not given, depending on the source, either a
default cell is opened, or the user is presented a list of cells from
which to choose.  If a single name is given, it can also be the name
of a cell in memory, or the name of a cell resolvable through a
library or the search path for native cells.

In short, the first or only name given can be one of the following.

\begin{itemize}
%\ifoa
\item{The name of an OpenAccess library, if the OpenAccess     
plug-in has been loaded.}
%\fi

\item{A path to a layout file in a supported format.}

\item{The access name of a Cell Hierarchy Digest (CHD) in memory.}

\item{A path to a CHD file on disk.}

\item{A URL to a layout file on a remote server.  This can also apply
to a CHD file, but the layout file referenced by the CHD must be
available locally.}

\item{The name of a library file.}
\end{itemize}

In each of the cases above, a second name can appear, giving the name
of a cell to open.  If no cell name is given, the action depends on
the type of source.
%\ifoa
An OpenAccess library source requires that a cell name be given,
otherwise the OpenAccess database is not consulted.
%\fi

If no cell name is given and the source is a layout file containing
only one top-level cell, that cell will be opened.  If there are
multiple top-level cells, a pop-up will appear allowing the user to
choose which cell to open.  These calls will already be in memory, the
choice simply defines the current cell for editing.

If the source is a CHD and no cell name is given, the CHD's default
cell will be opened.  This is either a cell configured into the CHD,
or the first (lowest offset) top-level cell found in the original
layout file.  There will never be a selection pop-up with a CHD
source.

If the file is a library file, the second argument should be one of
the reference names from the library, or the name of a cell defined in
the library.  If no second name is given, a pop-up listing the library
contents will appear, allowing the user to select a reference or cell.

The {\cb Open} command can access the internet.  The name given to the
{\cb Open} command can be in the form of a URL, followed by options. 
The URL must begin with ``{\vt http://}'' or ``{\vt ftp://}'', and the
file is expected to be suitable {\Xic} input.

There is presently only one option that can follow the url:
\begin{description}
\item{\vt -o {\it filename}}\\
Ordinarily a temporary file is used for downloading, which is
destroyed.  The user must save the hierarchy to retain a copy on the
user's machine.  If this option is given, the downloaded file will be
saved in the given file and not destroyed.
\end{description}

If the name can not be resolved as a source archive as described
above, it may be the name of one of the special library files.  If
not, it is taken as a name for a cell.  If it can not be resolved as a
known cell, a new, empty cell is created with that name.

\begin{itemize}
\item{The name of the model or device library file.}

\item{The name of a cell already in memory.}

\item{The name of a cell resolvable through open libraries or the
native cell search path.}

\item{The name of a new cell to create and open.}
\end{itemize}

If the name of the file given is that of the present model library
(default ``{\vt model.lib}'') or device library (default ``{\vt
device.lib}''), the library file is first copied into the current
directory if it doesn't exist there, and the file in the current
directory is then opened for text editing.  These files contain the
devices and some of the models used in electrical mode for producing
SPICE files.

Cells can also be opened for editing within {\Xic} by dragging the
name from a file manager and dropping in the main drawing window, or
by pressing the {\cb Ok} or {\cb Open} buttons in the {\cb File
Selection} panel.  Files can also be opened from the {\cb Open}
buttons in the files, cells, and contents listing pop-ups in the {\cb
File Menu}.  These are all equivalent to opening the cell with the
{\cb Open} command, so that the information in this section applies in
those cases.

If the name string given to edit matches the name of a cell in memory,
the editing context is switched to that cell, and no disk file is read
in this case.  However, if the name given to edit contains a directory
separation character, i.e., is a path, then {\Xic} will always attempt
to read the file from disk.  Thus, if the user wants to re-read a
native cell file from disk, if the cell is already in memory, the user
should add a path prefix to the name.  For example ``{\tt ./noname}'',
assuming {\vt noname} is in the current directory, will force {\Xic}
to read the disk file, even if the {\vt noname} cell is already in
memory.

\index{NoReadExclusive variable}
\index{AddToBack variable}
The interpretation of any path prefix which is included with the name
of a native file to open for editing is set by the variables {\et
NoReadExclusive} and {\et AddToBack}.  The top level cell will always
be read from the given file if a path to the file is specified. 
Subcells are resolved by cell name only through the search path.  The
search path is modified during the read according to the state of the
{\et NoReadExclusive} and {\et AddToBack} variables.

All of the settings in the {\cb Setup} page of the {\cb Import
Control} panel (from the {\cb Convert Menu}) apply.  However, none of
the options, such as layer filtering or cell name modification, found
in the {\cb Read File} page of the same panel apply in this case.  If
these options are needed, the {\cb Read File} button in this page
should be used to read the file, rather than the {\cb Open} command. 
Note that this is different from pre-3.0.0 releases, in which cell
name case changes and file-based aliasing were supported in the {\cb
Open} command.

The table in \ref{features} lists the variables and modes that apply
to the {\cb Open} and similar commands.

\subsection{Reading Input With the Open Command}

While a layout file is being read and processed, a log file is
written.  This file contains a record of messages emitted during the
conversion.  If during a conversion an error or warning message is
emitted, a file browsing window containing the log file will appear
when the conversion is complete, though this can be suppressed by
setting the {\et NoPopUpLog} variable.  These messages also appear on
the prompt line during the conversion.  The file browser is a
read-only version of the text editor window (see \ref{textedit}).  The
log files can be accessed from the {\cb Log Files} button in the {\cb
Help Menu}.

When reading a layout file, there is a message updated periodically
on the prompt line indicating bytes read.  One can abort the read with
{\kb Ctrl-c}, and a `y' response to the resulting prompt.  It is
advisable to clear the cells from the partially read hierarchy from
memory with the {\cb Clear} button in the {\cb Cells Listing} pop-up.

CGX and GDSII files that have been compressed with the GNU {\et gzip}
program or have been written in compressed form by {\Xic} can be read
in directly, whether or not the file name contains the standard ``{\vt
.gz}'' suffix.  Support for compressed files extends to CGX and GDSII
only (OASIS files use a different compression methodology).

The header of a GDSII file optionally contains information about
fonts, reference libraries, and other things.  This information is
saved as properties of the top-level cells derived from the file,
i.e., those cells that are not used as subcells of another cell in the
file.  {\Xic} does not use this information, but it will be put back
into a GDSII file subsequently written by {\Xic}, as other
applications may need this information.

When reading GDSII or OASIS input, {\Xic} will attempt to map the
layer number and data type combinations found in the file to existing
{\Xic} layers, and if that fails a new {\Xic} layer will be created. 
This is described in the section on GDSII layer mapping
(\ref{gdslayer}).

When reading CIF, layer names are matched to those defined in the
current technology in a case-insensitive mode.  This differs from
native and CGX file types, which use case-sensitive matching.  Layers
found in the file which do not match any in the technology are
created, using default parameters.

When a cell is written to disk, it is by default written in the format
of origin, though a format change can be coerced in the {\cb Save As}
command by supplying a file extension.  Explicit conversions can also
be performed with the commands in the {\cb Convert Menu}.

\index{NoCheckEmpties variable}
If a cell is opened for editing that contains empty cells, the user is
given the option of deleting these references.  If empty cells are
found in the hierarchy, a pop-up appears, which allows their deletion. 
The cell names listed are those that for each mode (electrical and
physical) the named cell either does not exist or has no content.

This test can be performed at any time with the {\cb !empties}
command.  The test can be suppressed by setting the {\cb Skip testing
for empty cells} check box in the {\cb Setup} page of the {\cb Import
Control} panel from the {\cb Convert Menu}, or (equivalently) by
setting the {\et NoCheckEmpties} variable.

\subsection{Opening New Cells -- Conflict Resolution}

{\Xic} keeps an internal database of all cells that have been used, by
name.  When a new file is opened for editing, it may contain
definitions for cells with the same name as those already in memory. 
{\Xic} provides several features for dealing with this situation when
it arises.

The symbol table used to store cells can be changed.  Creating and
installing a new symbol table enables {\Xic} to start with a fresh
database, though the original database can be reinstalled at any time. 
There is no problem with cells of the same name existing in different
symbol tables.  The symbol tables are manipulated with the {\cb Symbol
Tables} panel from the {\cb Cell Menu}.  Symbol tables are useful for
global context saving and switching, but since only one table can be
installed at a time, it is generally not possible to access cells from
different symbol tables simultaneously.  Cells used in a hierarchy
must exist in or be saved in the same symbol table.

\index{Merge Control pop-up}
When a file is being read from disk and a cell whose name conflicts
with an existing cell in memory is encountered, a {\cb Merge Control}
pop-up will generally appear.  This allows the user to choose whether
or not to overwrite the physical and/or electrical part of the cell in
memory.  Press {\cb Apply} to continue with the conversion.  One must
press {\cb Apply} for each cell where there is a conflict, or press
{\cb Apply to Rest} to apply the present setting to the rest of the
cells that clash.  Dismissing the pop-up performs the same function as
{\cb Apply to Rest}.  The pop-up is removed when all conversions are
done.

\index{NoAskOverwrite variable}
If the {\et NoAskOverwrite} variable is set (with the {\cb !set}
command), or equivalently the {\cb Don't prompt for overwrite
instructions} button in the {\cb Setup} page of the {\cb Import
Control} panel (from the {\cb Convert Menu}) is active, no {\cb Merge
Control} pop-up will appear, and the default action will be used.  The
default action will also be used in non-graphics (server or batch)
mode.

\index{default cell name conflict action}
\index{NoOverwritePhys variable}
\index{NoOverwriteElec variable}
The default action can be specified by setting the {\et
NoOverwritePhys} and/or the {\et NoOverwriteElec} variables, or
equivalently by making a selection from the {\cb Default when new
cells conflict} menu in the {\cb Setup} page of the {\cb Import
Control} panel.  If no choice is made by any means, the default is to
overwrite the cell in memory, both physical and electrical parts.  The
initial selections in the {\cb Merge Control} pop-up will reflect the
settings of the default action.

\subsection{Object Tests}

While a file is being read, tests for reentrant or otherwise strange
polygons are normally performed.  A polygon that is reentrant overlaps
itself.  This can be a problem since the polygon may be rendered
differently on different CAD systems, as the presentation of the
polygon may become ambiguous.  The test is performed on physical data
only.  This adds a little overhead.  The test is skipped if the
boolean variable {\et NoPolyCheck} is set (with the {\cb !set}
command).  This test can also be turned off from the {\cb Setup} page
of the {\cb Import Control} panel.

There will also be a warning message added to the log if a polygon
vertex list is modified by {\Xic}.  The checking function will remove
duplicate, inline, and ``needle'' vertices.  This does not change the
shape of the polygon, but reduces complexity and memory use.  If the
file is written back to disk, the warnings will not reappear when
reading the new file.

Similarly, wire objects are also tested for rendering difficulties. 
Wire objects consist of a vertex list, a width parameter, and an end
style parameter.  To render or otherwise process a wire, a polygon
representing the actual shape has to be generated internally, making
use of these parameters.  With some parameter sets, this can be
difficult or impossible.  In addition, ambiguity arises between
different tools in how (for example) acute angles are rendered, and
how the ``rounded'' end style is implemented.

Wires that are impossible or difficult to render are logged.  Wires
that are impossible to render are never added to memory.  Wires that
are difficult to render are listed as ``questionable'' in the log
file.  These may or may not look ``good'' in the {\Xic} display.  It
is possible that wires that look good in {\Xic} will not be processed
correctly in another tool, and vice-versa, so the user should be
aware of the presence of these wires. 

If when reading a file a warning message about ``badly formed
polygons'' appears in the log file, here is how to proceed.  Note the
cell that contained the polygon, and edit it.  Use the {\cb
!polycheck} command to select the bad polygons.  The {\cb Info}
command in the {\cb View Menu} can be used to obtain the vertex list. 
In many cases, the polygon will not cause problems, however it is
wise to recreate one that is flagged as bad.  The {\cb Create Cell}
command can be used to save the bad polygons to a separate cell for
further inspection.  A {\cb !split} operation followed by a {\cb
!join} should effectively repair a degenerate polygon.

Similarly, there is a {\cb !wirecheck} command that can be used to
identify ``questionable'' wires in the current cell.  To avoid
problems down-stream, these should probably be converted to polygons. 
This can be done with {\cb !split}/{\cb !join}, or with the polygon
creation command in the side menu.

By default, {\Xic} checks for identical, coincident objects when
reading input files, and prints a warning message in the log file if
such objects are found.  The {\cb Duplicate item handling} menu in the
{\cb Setup} page of the {\cb Import Control} panel can be used to set
the action to perform on duplicates.  Choices are no checking at all,
warn only, or warn and remove duplicates.


% -----------------------------------------------------------------------------
% filesel 032513
\subsection{The File Selection Panel}
\label{filesel}
\index{file manager}
\index{file selection}

The {\cb File Selection} panel allows the user the navigate the
host's file systems, and select a file for input to the program.

The panel provides two windows; the left window displays the
subdirectories in a tree format, and the right window displays a
listing of files in a columnar form.  The panel is similar in
operation to the {\et Windows Explorer} tool provided by {\et
Microsoft}.
       
When the panel first appears, the directories listing contains a
single entry, which is shown selected, and the files window contains a
list of files found in that directory.  The tree "root" is selected by
the application, and may or may not be the current directory.  If the
directory contains subdirectories, a small box containing a `{\vt +}'
symbol will appear next to the directory entry.  Clicking on the `{\vt
+}' will cause the subdirectories to be displayed in the directory
listing, and the `{\vt +}' will change to a `{\vt -}'.  Clicking again
on the `{\vt -}' will hide the subdirectory entries.  Clicking on a
subdirectory name will select that subdirectory, and list its files in
the files listing window.  The `{\vt +}' box will appear with
subdirectories only after the subdirectory is selected.
 
Clicking on the blue triangle in the menu bar will push the current
tree root to its parent directory.  If the tree root is pushed to the
top level directory, the blue triangle is grayed.  The label at the
bottom of the panel displays the current root of the tree.  There is
also a {\cb New Root} item in the {\cb File} menu, which allows the
user to enter a new root directory for the tree listing.  In Windows,
this must be used to list files on a drive other than the current
drive.

The {\cb Up} menu is similar, but it produces a drop-down list of
parent directories.  Selecting one of the parents will set the root to
that parent, the same as pressing the blue triangle button multiple
times to climb the directory tree.

The {\cb New CWD} button in the {\cb File} menu allows the user to
enter a new current working directory for the program.  This will also
reset the root to the new current working directory.  The small dialog
window which receives the input, and also a similar dialog window
associated with the {\cb New Root} button, are sensitive as drop
receivers for files.  In particular, one can drag a directory from the
tree listing and drop it on the dialog, and the text of the dialog
will be set to the full path to the directory.

The files listed in the files listing always correspond to the
currently selected directory.  File names can be selected in the files
listing window, and once selected, the files can be transferred to the
calling application.  The ``Go'' button, which has a green octagon
icon, accomplishes this, as does the {\cb Open} entry in the {\cb
File} menu.  These buttons are only active when a file is selected. 
One can also double-click the file name which will send the file to
the application, whether or not the name was selected.

Files can be dragged and dropped into the application, as an
alternative to the ``Go'' button.  Files and directories can also be
dragged/dropped between multiple instances of the {\cb File Selection}
panel, or to other file manager programs, or to other directories
within the same {\cb File Selection} panel.  The currently selected
directory is the target for files dropped in the files listing window. 
When dragging in the directory listing, the underlying directory is
highlighted.  The highlighted directory will be the drop target.

By default, a confirmation pop-up will always appear after a
drag/drop.  This specifies the source and destination files or
directories, and gives the user the choice of moving, copying or (if
not in Windows) symbolically linking, or aborting the operation.

In {\Xic}, the variable {\et NoAskFileAction} can be set to skip the
confirmation.  This was the behavior in releases prior to 3.0.0, and
experienced users may prefer this.  However, some users may find it
too easy to inadvertently initiate an action.

If the {\et NoAskFileAction} variable is set, the following paragraphs
apply.

The drag/drop operation is affected by which mouse button is used for
dragging, and by pressing the {\kb Shift} and {\kb Ctrl} buttons
during the drag.  The normal operation (button 1 with no keys pressed)
for drag/drop is copying.  The other options are as follows:

\begin{tabular}{|l|l|} \hline
\multicolumn{2}{|c|}{\kb Operations}\\ \hline
\et Button 1 & Copy\\ \hline
\et Shift-Button 1 & Move\\ \hline
\et Control-Button 1 & Copy\\ \hline
\et Shift-Control-Button 1 & Link\\ \hline
\et Button 2/3 & Ask\\ \hline
\end{tabular}

Above, ``Ask'' means that a dialog will appear asking the user what
operation to perform.  Options are {\vt move}, {\vt copy}, or
(symbolically) {\vt link}.  Both the source and destinations are shown
in the pop-up, and can be modified.

If a directory is the source for a copy, the directory and all files
and subdirectories are copied recursively, as with the ``{\vt -R}''
option of the Unix ``{\vt cp}'' command.

Only one file or directory can be selected.  When the operation is
{\vt copy}, the cursor icon contains a `+' in all cases.  This will
appear when the user presses the {\kb Ctrl} key, if the underlying
window supports a {\vt move} operation.

The {\cb File} menu contains a number of commands which provide
additional manipulations.  The {\cb New Folder} button will create a
subdirectory in the currently selected directory (after prompting for
a name).  The {\cb Delete} button will delete the currently selected
file.  If no file is selected, and the currently selected directory
has no files or subdirectories, it will be deleted.  The {\cb Rename}
command allows the name of the currently selected file to be changed. 
If no file is selected, the name change applies to the currently
selected directory.

The {\cb Listing} menu contains entries which affect the file name
list.  By default, all files are listed, however the user can restrict
the listing to certain files with the filtering option.  The {\cb Show
Filter} button displays an option menu at the bottom of the files
listing.  The first two choices are ``all files'' and the set of
extensions known to correspond to supported layout file formats.  The
remaining choices are editable and can be set by the user.  The format
is the same as one uses on a Unix command line for, e.g., the {\vt ls}
command, except that the characters up to the first colon (`:') are
ignored.  It is intended that the first token be a name for the
pattern set, followed by a colon.  The remaining tokens are
space-separated patterns, any one of which if matching a file will
cause the file to be listed.

In matching filenames, the character `{\vt .}' at the beginning of a
filename must be matched explicitly.  The character `{\vt
*}' matches any string of characters, including the null string.  The
character `{\vt ?}' matches any single character.  The sequence
`$[...]$' matches any one of the characters enclosed.  Within
`$[...]$', a pair of characters separated by `{\vt -}' matches any
character lexically between the two.  Some patterns can be negated: 
The sequence `$[\symbol{94}...]$' matches any single character not
specified by the characters and/or ranges of characters in the braces. 
An entire pattern can also be negated with `{\vt \symbol{94}}'.  The
notation `{\vt a}\{{\vt b,c,d}\}{\vt e}' is a shorthand for `{\vt abe
ace ade}'.

The {\cb Relist} button will update the files list.  The file listing
is automatically updated when a new filter is selected, or when {\kb
Enter} is pressed when editing a filter string.

The files are normally listed alphabetically, however if {\cb List by
Date} is selected, files will be listed in reverse chronological order
of their creation or last modification time.  Thus, the most-recently
modified file will be listed first.

The {\cb Show Label} toggle button controls whether or not the label
area is shown.  The label area contains the root directory and current
directory, or a file info string.  By default, the label area is shown
when the pop-up is created as a stand-alone file selector, but is not
shown when the pop-up appears as an adjunct when soliciting a file
name.

When the pointer is over a file name in the file listing, info about
the file is printed in the label area (if the label area is visible). 
This is a string very similar to the ``{\vt ls -l}'' file listing in
Unix/Linux.  It provides:

\begin{enumerate}
\item{The permission bit settings and file type codes as in 
  ``{\vt ls -l}'' (Unix/Linux only).}
\item{The owner and group (Unix/Linux only).}
\item{The file size in bytes.}
\item{The last modification date and time.}
\end{enumerate}

While the panel is active, a monitor is applied to the listed files
and directories which will automatically update the display if the
directories change.  The listings should respond to external file or
directory additions or deletions within half a second.

\index{open file dialog}
\index{save file dialog}
The {\cb File Selection} pop-up appears when the {\cb File Select}
button in the {\Xic} {\cb File Menu} is pressed.  Variations of {\cb
File Selection} panel appear when the user is being prompted (from the
prompt line) for a path to a file to open or write, such as for the
commands in the {\cb Convert Menu}.  The {\cb Open File} dialog is
used when a path to a file to open is being requested.  It is almost
the same as the {\cb File Selection} panel, except that selecting a
file will load that path into the prompt line.  The {\cb Save File}
dialog is used when the user is being prompted for the name of a file
to save.  This does not contain the list of files found in the other
variations, but allows the user to select a directory.


% -----------------------------------------------------------------------------
% xic:sv 030713
\section{The {\cb Save} Button: Save Modified Cells}
\index{Save button}
\index{saving cells}

The {\cb Save} button in the {\cb File Menu} allows saving unsaved
work to disk files, under the present file/cell name.
 
If there are cells in memory that have been modified, the {\cb
Modified Cells} pop-up will appear.  This is the same pop-up that
appears when exiting {\Xic} if there are unsaved cells.  It can also
be invoked with the {\cb !sv} command.

The pop-up displays a listing of all modified cells and hierarchies,
each with a yes/no entry that can be toggled by the user to set
whether the cell or hierarchy will be saved.  The display has four
columns.  Column 1 gives the name of the cell, which for a hierarchy
is the top level cell.

The second column is ``{\vt yes}'' or ``{\vt no}''.  Clicking on this
word will toggle between the two states.  The buttons at the top of
the panel will set the states of all of these words:  {\cb Save All}
sets them to ``{\vt yes}'', {\cb Skip All} sets them to ``{\vt no}''.

Initially, all normal cells in the listing will be set to ``{\vt
yes}'', meaning that all of the listed items will be updated on disk. 
If PCell submasters are being listed, then their initial state is
``{\vt no}'', meaning that the master cell of a specific PCell
instance and parameter set will not be written to disk.  By default,
the PCell sub-masters that are created in memory when a PCell is
instantiated are not listed in the {\cb Modified Cells} pop-up.

PCell sub-master cells are normally recreated in memory from the
original parameterized cell definition when needed.  However, there
may be times when keeping a cache of PCell sub-masters is useful for
performance reasons, or to export where the original PCell is not
available or the format not supported.

\index{PcListSubMasters variable}
If the boolean variable {\et PcListSubMasters} is set, then
sub-masters created in memory for PCell instantiation will be listed
in the {\cb Modified Cells} pop-up.

The third column gives the type of file that will be created or
updated.  This entry is shown in color, and the color used for
archives is different than the color used for native and other
single-cell files.

\begin{quote}
\begin{tabular}{ll}
\vt X & {\Xic} native\\
\vt B & CGX\\
\vt C & CIF\\
\vt G & GDSII\\
\vt O & OASIS\\
%\ifoa
\vt A & OpenAccess\\
%\fi
\vt P & PCell sub-masters (native)\\
\end{tabular}
\end{quote}

%\ifoa
If a cell was read from an OpenAccess library and modified, it will
(by default) be saved to the same library.  {\Xic} can write only to
OpenAccess libraries that were created by {\Xic} or otherwise
``branded'' by {\Xic} (with the {\cb !oabrand} command).  This should
prevent unintentional overwriting of Virtuoso cells.  Overwriting a
Virtuoso cell from {\Xic} will hopelessly clobber the cell for
Virtuoso.  Some day this may work, but for now expect the worst.
%\fi

If saved, PCell sub-masters will be saved as native cell files in the
current directory.

The fourth column is the full path name of the file that will be
written if the second column is ``{\vt yes}''.
%\ifoa
In the case of OpenAccess, this will be the library name.
%\fi

{\Xic} native cells are saved under their own name, in the directory
containing the file the cell was read from, or the current directory
if the cell was created within {\Xic}.  If a cell from an archive file
was modified, the hierarchy is saved in the name of the original
archive file, or the top-level cell name with an extension if the
original file name is unknown.  The file type is the same as the
origin of the hierarchy.  The {\cb Save As} button can be used to save
under a different name or file type.

In all cases, the previous version of an overwritten file is given a
``{\vt .bak}'' extension and retained (any existing ``{\vt .bak}''
file will be overwritten, however).

While the pop-up is visible, most other controls are inoperable. 
Pressing {\cb Apply - Continue}, or deleting the window, will save the
files marked ``{\vt yes}'', retire the pop-up, and allow {\Xic} to
continue.  Pressing the {\cb ABORT} button will retire the pop-up and
abort the present command.
 

% -----------------------------------------------------------------------------
% xic:save 022316
\section{The {\cb Save As} Button: Save Cell, Renaming}
\index{Save As button}
\index{saving cells}

The {\cb Save As} button in the {\cb File Menu} will save to disk the
cell or hierarchy currently being edited, possibly under a new name or
file type.

If editing a cell from the device library, the {\cb Save As} command
will bring up the {\cb Library Cell Parameters} panel (see
\ref{devedit}), which allows device defaults to be edited, and has
provision for saving the cell into a device library file or as a
native cell file.
 
Otherwise, the {\cb Save File} dialog appears which provides an
expandable and selectable tree representation of the directory
structure, rooted in the directory where the file was originally read
from, or the current directory.  The name or path to the file can be
modified on the prompt line, or directories can be selected from the
pop-up which will modify the prompt line.

If the default is accepted, the cell or hierarchy will be saved in the
format of origin:  one of the archive formats, or native.

The response string actually supports syntax which provides coercion
to another format, and other features.  The general form of the
response string is:

\begin{quote}
[{\it filetype\/}] {\it file\_path} [{\it cellname\/}]
\end{quote}

If the first word in the string is a recognized file format keyword,
which is a known file format suffix {\bf without} the period, output
will be generated in that format.  The following {\it filetype}
keywords are recognized:

\begin{tabular}{ll}\\
CGX & ``{\vt cgx}''\\
CIF & ``{\vt cif}''\\
GDSII & ``{\vt gds}'', ``{\vt str}'', ``{\vt strm}'', ``{\vt stream}''\\
OASIS & ``{\vt oas}''\\
%\ifoa
OpenAccess & ``{\vt oa}''\\
%\fi
Native & ``{\vt xic}''\\
\end{tabular}

If the first word is not one of the recognized format keywords, then
it is taken as a path to the output to produce.  If this path has a
file extension from the list above, meaning that the file name ends
with a period followed by one of the words from the table, this will
specify that format type for output.
%\ifoa
This does not apply to OpenAccess, however.

OpenAccess is available only if the plug-in
was successfully loaded (see \ref{oaplugin}).
%\fi

If the specified output format is one of the archive formats (CGX,
CIF, GDSII, OASIS), then the entire cell hierarchy under the current
cell will be saved in the output file produced.

If saving a hierarchy in CGX or GDSII format, the file name can be
given an additional, final suffix ``{\vt .gz}'', which will cause the
file to be written in compressed (gzipped) format.  These compressed
files can be read into {\Xic} directly, and can be uncompressed using
the widely available GNU {\vt gzip} or {\vt gunzip} programs. 
Compression is supported for CGX and GDSII files only.  The ``{\vt
.gz}'' suffix can be removed, if already present, to suppress
compression.

If the file extension given is ``{\vt .xic}'', then the current cell
(not hierarchy) is saved in the file specified as a native cell file. 
The file, and the new cell name, will include the ``{\vt .xic}''
extension.  It is usually preferable to use the ``{\vt xic} {\it
filetype} keyword to coerce native output to avoid changing the cell
name.

There are a number of ways to save to native symbol files, as
explained below.  The general form is
\begin{quote}
[{\vt xic}] [{\it word1} [{\it word2\/}]]
\end{quote}

\begin{tabular}{llp{5in}}
\bf word1 & \bf word2 & \bf description\\
blank & blank & Save the current cell (only) as a native cell file in
 the current directory.\\
\vt * & blank & A literal asterisk indicates to save all cells in the
 current hierarchy as native cell files in the current directory.\\
\it word & blank & If {\it word} is a path to an existing directory,
 save the current cell as a native cell file in that directory.  If
 {\it word} is a path to an existing file, first move the existing
 file out of the way by giving it a {\vt .bak} extension, then save
 the cell under the given file name.  Otherwise, {\it word} is taken
 as a new name for the cell, which may contain a directory path.  The
 native cell will be saved under that name.\\
\it word1 & \it word2 & The first word is taken as a directory path.
 This directory will be created if it doesn't exist, if possible.  The
 second word is a new name for the cell.  This must be a simple name,
 not a path.  The current cell will be saved in the directory as a
 native cell file using the new name.\\
\it word & \bf . & The first word is taken as a directory path.  This
 directory will be created if it doesn't exist, if possible.  The
 literal period as the second word indicates to save the  current
 cell it the directory as a native cell file, using the present cell
 name.  This form is useful to force creation of the directory.\\
\it word & \vt * & The first word is taken as a directory path.  This
 directory will be created if it doesn't exist, if possible.  The
 literal asterisk as the second word indicates to save all cells in
 the hierarchy of the current cell, as native cell files in the 
 directory.\\
\end{tabular}

The {\vt xic} filetype specifier can be omitted if the source of the
current cell is a native cell file.  If omitted, in any case if the
{\it word1} is a path to an existing directory (including ``{\bf .}''
as the current directory), the ``{\vt xic}'' is understood, and the
behavior is as described in the table above.

%\ifoa
To save to an OpenAccess library, the ``{\vt oa}'' {\it filetype}
{\bf must} be given, any added file extensions are not recognized.  The
remainder of the line is interpreted as follows:

\begin{tabular}{llp{5in}}
\bf word1 & \bf word2 & \bf description\\
blank & blank & The current cell is written to the library named in
 the {\et OaDefLibrary} variable.\\
\vt * & blank & If only an asterisk appears, the current cell and
 its hierarchy are written to the library named in the {\et
 OaDefLibrary} variable.\\
\it library & blank & If a single word is given, it is taken as
 the name of a library in which to save the current cell.  If no
 such library exists, the user will be prompted to create it.\\
\it library & \it cell & If two words are given, the first word is
 taken as the library name as above.  The second word is the name
 that the current cell will be saved under, thus the OpenAccess
 cell name can be different.\\
\it library & \vt * & If an asterisk follows the library name, the
 current cell and its hierarchy will be written to the library.
\end{tabular}
%\fi

When a file is read into {\Xic}, the full path to that file is saved
within {\Xic}, and that file is the default written to during a save. 
The previous version of a file that has been overwritten is saved in a
file in the same directory with the same name, but with a ``{\vt
.bak}'' extension added.  Cells that are created within {\Xic}, i.e.,
that do not have a known origin file, are saved by default in the
current directory.  This includes native-format versions of cells that
were read in as part of an archive file.


% -----------------------------------------------------------------------------
% xic:sadev 081418
\section{The {\cb Save As Device} Button:  Editing Devices}
\index{Save As Device button}
\label{devedit}

The {\cb Save As Device} button appears in the {\cb File Menu} in
electrical mode only.  If the current cell is suitable as a device
definition, meaning that the physical part is empty and there are no
subcells, then the {\cb Device Parameters} panel will appear.  From
this panel, the default device properties can be set, and the current
cell saved as a device in either a file or an updated device library.

Devices in the device library can be edited, while in electrical mode,
by simply giving the device name to the {\cb Open} command or
equivalent, and enabling editing mode with the {\cb Enable Editing}
button in the {\cb Edit Menu}.  When saving, with either {\cb Save} or
{\cb Save As}, the {\cb Device Parameters} pop-up will appear, as it will,
of course, with the {\cb Save As Device} button.

The panel will also appear in the {\cb Save As} command if the name of
the cell or file to save has been specified as the name of the device
library file (default ``{\vt device.lib}'').  Again, the cell must
contain geometry appropriate for a device, i.e., no physical data and
no subcells. 

When creating a new device symbol, one can use an existing symbol from
the device library as a starting point, and save under a new name. 
This will tend to keep the new device size and other characteristics
similar to existing devices.

The remainder of this section describes the controls found in the 
{\cb Device Parameters} panel.

The {\cb subct} side-menu command is used to set the device connection
points.  The order of appearance on the SPICE line is the same as the
numerical order in the marks shown in the {\cb subct} command.  The
{\cb subct} command creates the {\et node} properties required for
electrical connection.  At least one connection point is required,
unless the {\cb SPICE Prefix} begins with `x' or `X' (indicating a
macro) in which case a connection point is not required.  Thus it is
possible for a macro, like a subcircuit, to connect to global nodes
only.

The {\cb Device Name} entry area contains the device (cell) name. 
This is arbitrary and can be changed, however a name must appear. 
This is the name by which the device is known to {\Xic}, and the name
that will appear in the device selection menu.

The {\cb SPICE Prefix} is one or more characters that will be
prepended to the device instance lines when a SPICE file is created. 
An entry in this field is usually mandatory.  The pop-up will accept
anything, however the first character should match the requirements of
SPICE, which expects a certain key letter for each device, such as
`{\vt R}' for resistors (case independent).  Additional characters can
appear, and should be alphanumeric.  An exception is the terminal
device, which is not instantiated in SPICE, and must have a prefix
starting with the character `{\vt @}' for internal use by {\Xic}.  In
{\it Xic}, the {\cb SPICE prefix} for normal devices has no internal
significance except as a unique identifier of that particular device,
so the prefix should be unique in the device library file.  The prefix
is saved in a {\et name} property applied to the device.

If the prefix entry contains a second word ``{\vt macro}''', then the
{\vt macro} flag will be set in the {\et name} property.  In this
case, if the name prefix does not start with ``{\vt X}'' or ``{\vt
x}'', {\Xic} will prepend an ``{\vt X}'' to instance calls, so that
they are actually resolved as subcircuits.  See the description of the
name property for implications and use of this.  A {\et model}
property supplies the name of the SPICE {\vt .subckt} that will be
used.  This must be supplied in the generated SPICE netlist by some
means.

If the name prefix starts with ``{\vt X}'' or ``{\vt x}'', it is taken
as a macro whether or not the keyword is given, to differentiate it
from a normal subcircuit (which is not a ``device'').  A macro
subcircuit is expected to reference a {\vt .subckt} macro in the model
library or another source.  The name of the macro is given to
instances of the device as a {\et model} property.  A default model
property can be supplied to the device.  In the example in the
provided device and model libraries, the name of the device is ``{\vt
opamp}'', and the {\et model} property is given as ``{\vt ua741}''. 
There should be a file in the models subdirectories along the library
search path, or an entry in the model library file, starting with
``{\vt .subckt ua741} ...'' and containing the subcircuit definition,
terminated with ``{\vt .ends}''.  Note that subcircuits and models can
be intermixed freely in the model files, but the reference names must
be unique.

There is one special case:  ground terminals.  These have exactly one
connection (a {\et node} property), and no other properties including
a {\et name} property (prefix).  If this matches the current cell, and
a ground terminal in intended, then the {\cb SPICE Prefix} should be
left blank.

The {\cb Default Model} and {\cb Default Value} fields are optional
for devices.  Either one, but not both can be given, providing a
default model name or default value to the device.  If both are given,
the {\cb Default Value} entry will be ignored.  These entries
translate into {\et model} and {\et value} properties applied to the
device.  Instances will inherit which ever of these properties is
given, but they can be changed on a per-instance basis.

If the device is a macro, i.e., the {\vt macro} keyword is given or
the SPICE prefix starts with `{\vt x}' or `{\vt X}', then the {\cb
Default Model} field is mandatory and contains the name of the
subcircuit that will be instantiated.  This name should be found in a
{\vt .subckt} line in the model library or elsewhere.

The {\cb Default Parameters} field provides a default parameter set
for the device or macro.  The string can be any text relevant to the
device in the context of SPICE, and will appear as a {\et param}
property when the device is instantiated.  This property can
subsequently be changed in the instances.

The {\cb Hot Spot} button, and associated menu and entry area, allows
a {\et branch} property to be applied to the device.  The {\et branch}
property allows an internal value or function to be associated with a
location in the schematic symbol, which can be clicked on in the
drawing to obtain the values, after a simulation.  For most devices,
this will yield the current through the device.  The {\et branch}
property is ``internal'', meaning that it can not be changed in
instances by the user.

The {\cb Hot Spot} button will be active when the device contains a
{\et branch} property.  Pressing the button will create the property.

The {\et branch} property contains the hot spot coordinates, which are
marked on-screen with a white cross when the {\cb Hot Spot} button is
active.  While the {\cb Hot Spot} button is active, clicking in the
drawing will move the hot spot, and the white cross, to the
button-down location.  The user should click to locate the hot spot
where desired in the drawing.  In most of the devices in the supplied
device library file, the hot spot is located on the `$+$' symbol that
appears near the top device terminal.

The menu contains an orientation for the hot spot data.  This is
needed when the returned value is a current, and indicates the actual
direction of positive current flow, relative to the device symbol. 
Typically, the two device terminals are oriented vertically, with the
`$+$' associated with the top terminal, which would imply that the
orientation choice should be ``{\cb Down}''.  If a scalar value is
returned, so that there is no orientation, the correct choice would be
``{\cb none}''.  This selection will set the style and orientation of
the plot trace marker applied when the hot spot is clicked on in the
{\cb plot} and {\cb iplot} (electrical side menu) commands.

The text entry provides an expression for the value to be returned. 
The description of the {\et branch} property in \ref{branchprop}
describes this.  This is the {\it string} part of the property
description line, and may be empty for inductors and voltage sources.

The {\cb No Physical Implementation} box should be checked if the
device will never have a direct correspondence to geometry in the
physical layout.  This is true for example for voltage and current
sources.  Devices with this property set will not be considered in LVS
testing and will never appear in netlists extracted from physical
data.  The device terminals will never appear in physical layouts. 
This will apply a {\et nophys} property to the device.

Once all needed fields have been filled in, the device can be saved. 
The {\cb Save in Library} button will perform the following steps:
\begin{enumerate}
\item{The device library file will be copied to the current directory,
    if it doesn't already exist in the current directory.  If it does
    exist in that directory, the file will be copied and given a
    ``{\vt .bak}'' extension.}

\item{The present device is written into the device library file.  If
    the name already appears in the file, the existing device will be
    replaced.  If the name does not appear, the device will be
    appended to the file.

It is critical that the first line of a device description in the
device library be a comment naming the device, in the form
\begin{quote}
({\vt Symbol:} {\it devname});
\end{quote}
When updating the library, the process looks for lines of this form. 
{\Xic} will always add this line, but it may not be present if the
file has been hand edited.}

\item{The modified device library is read back into {\Xic}, and {\Xic}
    is updated to use the new library.}

\item{The pop-up is retired, and a message indicates completion.}
\end{enumerate}

If, instead, it is desirable to avoid touching the device library but
the user wishes to save the device, the {\cb Save as Cell File}
button can be used to save the device as a native cell file.

After saving, the device selection menus are updated, in case the
device was saved to a location that was referenced in the device
library, such as by a {\vt Directory} keyword.

{\bf Warning}:  Be aware that it is not good to have cell files lying
around that conflict with cells provided by the device library, as
they can potentially cause trouble.  Such files should be moved
somewhere safe, at least out of the search path.


% -----------------------------------------------------------------------------
% xic:hcopy 081824
\section{The {\cb Print} Button: Print Control Panel}
\index{hcopy button}
\index{hardcopy plots}

The {\cb Print} button from the {\cb File Menu} brings up the {\cb
Print Control Panel} for controlling hard copy plot generation.  The
panel supports a variety of printers and file formats through internal
drivers.

While the {\cb Print Control Panel} is visible, {\Xic} is in ``print
mode'' where the colors and other attributes of the main drawing
window are set to those in force for the current print driver.  The
print driver is selected with the {\cb Format} menu in the {\cb Print
Control Panel}.

Each print driver can have its own set of attributes and colors, which
can be set from the technology file.  Thus colors, fill, etc., can be
set to provide best results from the driver.  Changing the colors or
attributes while in print mode will affect the setting for the current
print driver only, and the original setting will be restored when
print mode is exited.  The settings applied to a driver are remembered
the next time the driver is selected in print mode.

If, after setting up print driver-specific attributes and colors, the
{\cb Save Tech} button is used to generate a technology file, the file
will contain the driver-specific information.

The driver-specific attributes include all of the settings from the
{\cb Main Window} sub-menu of the {\cb Attributes Menu}, including all
grid settings other than the spacing and snapping values.  Grid
spacing and snapping values carry over when switching to and from
print mode.  Individual layer colors, as well as the other attribute
colors used in drawing windows, can be set for the driver with the
{\cb Color Selection} panel from the {\cb Set Color} button in the
{\cb Attributes Menu}.  Fill patterns are set with the {\cb Fill
Pattern Editor}, from the {\cb Set Fill} button.  Layer visibility can
be set for the driver by clicking with mouse button 2 in the layer
table.  All of these settings apply only to the current print driver
when in print mode, instead of the general screen display as when not
in print mode.

\index{HPGLfilled keyword}
\index{XfigFilled keyword}
Not all attributes will be recognized and used by all print drivers. 
In particular, the ``line draw'' drivers will typically ignore the
fill pattern and simply draw an outline, though the HPGL and Xfig
drivers have a means to use predefined fill patterns defined in the
specific interface protocol.  This can be set up in the technology
file by use of the {\vt HPGLfilled} and {\vt XfigFilled} keywords,
respectively.

When using the Image driver, a {\cb No Backg} check box will appear
above the driver selection menu.  When checked, image files produced
will use a transparent background, meaning that existing background
will show through when the image is used in a document.  This
applies to PNG and other formats that support this feature.
(Qt releazes only)

\index{XIC\_TMP\_DIR environment variable}
The temporary file produced may be quite large in some cases.  This
file is created in the {\vt /tmp} directory by default.  If this
directory has insufficient disk space the {\et XIC\_TMP\_DIR}
environment variable should be set to a path to a suitable directory.


% -----------------------------------------------------------------------------
% hcopypanel 092817
\subsection{Print Control Panel}
\index{hardcopy panel}

The {\cb Print Control Panel} is a highly configurable multi-purpose
printer interface used in many parts of {\Xic} and {\WRspice}.  This
section describes all of the available features, however many of these
features may not be available, depending upon the context when the
panel was invoked.  For example, a modified version of this panel is
used for printing text files.  In that case, only the {\cb Dismiss},
{\cb To File}, and {\cb Print} buttons are included.  Most of the
choices provided by the interface have defaults which can be set in
the technology file.  The driver default parameters and limits are
modifiable in the technology file.  The {\cb Print Control Panel} is
made visible, and hardcopy mode is made active, by the {\cb Print}
button in the {\cb File Menu}.

Under Windows, the {\cb Printer} field contains a drop-down menu
listing the names of available printers.  The initial selection is the
system default printer.  This default can be set with the {\et
DefaultPrintCmd} variable.

Under Unix/Linux, the operating system command used to generate the
plot is entered into the {\cb Print Command} text area of the {\cb
Print Control Panel}.  In this string, the characters ``{\vt \%s}''
will be replaced with the name of the (temporary) file being printed. 
If there is no ``{\vt \%s}'', the file name will be added to the end
of the string, separated by a space character.  The string is sent to
the operating system to generate the plot.

The temporary file used to hold plot data before it is sent to the
printer is {\it not\/} deleted, so it is recommended that the print
command include the option to delete the file when plotting is
finished.  The {\et RmTmpFileMinutes} variable can be set to enable
automatic deletion of the temporary file, if necessary.

\index{plot to file}
If the {\cb To File} button is active, then this same text field
contains the name of a file to receive the plot data, and nothing is
sent to the printer.  The user must enter a name or path to the file,
which will be created.

{\Xic} normally supplies a legend on the hardcopy output, which can be
suppressed by un-checking the {\cb Legend} check box.  The legend is
an informational area added to the bottom of a plot.  In contexts
where there is no legend, this button will be absent.  In {\Xic}, a
legend containing a list of the layers is available.  In {\WRspice},
there is no legend.

The size and location of the plot on the page can be specified with
the {\cb Width}, {\cb Height}, {\cb Left}, and {\cb Top}/{\cb Bottom}
text areas.  The dimensions are in inches, unless the {\cb Metric}
button is set, in which case dimensions are in millimeters.  The
width, height, and offsets are always relative to the page in portrait
orientation (even in landscape mode).  The vertical offset is relative
to either the top of the page, or the bottom of the page, depending on
the details of the coordinate system used by the driver.  The label is
changed from ``{\vt Top}'' to ``{\vt Bottom}'' in the latter case. 
Thus, different sized pages are supported, without the driver having
to know the exact page size. 

The labels for the image height and width in the {\cb Print Control
Panel} are actually buttons.  When pressed, the entry area for
height/width is grayed, and the auto-height or auto-width feature is
activated.  Only one of these modes can be active.  In auto-height,
the printed height is determined by the given width, and the aspect
ratio of the cell, frame box, or window to be printed.  Similarly, in
auto-width, the width is determined by the given height and the aspect
ratio of the area to print.  In auto-height mode, the height will be
the minimum corresponding to the given width.  This is particularly
useful for printers with roll paper.

The full-page values for many standard paper sizes are selectable in
the drop-down {\cb Media} menu below the text areas.  Selecting a
paper size will load the appropriate values into the text areas to
produce a full page image.  Under Windows, the {\et Windows Native}
driver requires that the actual paper type be selected.  Otherwise,
this merely specifies the default size of the image.

Portrait or landscape orientation is selectable by the drop-down menu. 
In portrait mode, the plot is in the same orientation as seen
on-screen, and in landscape mode, the image is rotated 90 degrees. 
However, if the {\cb Best Fit} check box is checked, the image can
have either orientation, but the legend will appear as described.  If
using auto-height, the legend will always be in portrait orientation.

\index{hardcopy panel!Best Fit}
When the {\cb Best Fit} button is active, the driver is allowed to
rotate the image 90 degrees if this improves the fit to the aspect
ratio of the plotting area.  This supersedes the {\cb Portrait}/{\cb
Landscape} setting for the image, but not for the legend, if
displayed.

The landscape mode is available on all print drivers.  The behavior
differs somewhat between drivers.  The PostScript and PCL drivers
handle the full landscape presentation, i.e., rotating the legend as
well as the image by 90 degrees.  The other drivers will rotate the
image, however, the legend will always be on the bottom.  In this
case, the image may have been rotated anyway if the {\cb Best Fit}
button is active, and rotating provides a larger image.  The landscape
mode forces the rotation.

{\Xic} provides a {\cb Frame} button which allows a portion of the
graphical display to be selected for plotting.  This sets the view
produced in the print, which otherwise defaults to the full object
shown on-screen (the full cell in {\Xic}).  To set the frame, one uses
the mouse to define the diagonal endpoints of the region to be
plotted.  This region will appear on-screen as a dotted outline box. 
Deselect the {\cb Frame} button to turn this feature off, and plot the
full object.  In {\Xic}, if the display contains transient objects
such as rulers, DRC error indications, or terminals, it may be
necessary to use the {\cb Frame} command if these objects are not
included in the cell bounding box.  If the objects extend outside of
the cell boundary, they may be clipped in the plot, unless the frame
is used.

The available output formats are listed in a drop-down menu.  Printer
resolutions are selectable in the adjacent resolution menu.  Not all
drivers support multiple resolutions.  Higher resolutions generate
larger files which take more time to process, and may cause fill
patterns to become less differentiable.

When a PostScript line-draw driver is selected, a {\cb Line Width}
numeric entry area appears, which can be used to set the width of the
lines used for drawing.  The value given is in points, a point being
1/72 of an inch.  Different printers may respond to the specified
width in different ways, depending on physical characteristics.  The
default, when the line width is set to 0, is to use the narrowest line
provided by the printer.  At times, using fatter lines improves
visibility for presentation graphics and similar.

Pressing the {\cb Print} button actually generates the plot or creates
the output file.  This should be pressed once the appropriate
parameters have been set.  A pop-up message appears indicating success
or failure of the operation.

Pressing the {\cb Dismiss} button removes the panel and takes {\Xic}
out of hardcopy mode.  The same effect is achieved by
pressing the {\cb Print} button in the {\cb File Menu} a second time. 


% -----------------------------------------------------------------------------
% hcopyfmt 041110
\subsection{The {\cb Format} Menu: Hardcopy File Formats}
\index{hardcopy panel!format}
\label{hcformat}

The printing system for {\Xic} and {\WRspice} provides a number of
built-in drivers for producing output in various file formats.  In
Windows, an additional {\et Windows Native} driver uses the operating
system to provide formatting, thus providing support for any graphical
printer known to Windows.  The data formats are selected from a
drop-down menu available in the {\cb Print Control Panel}.  The name
of the currently selected format is displayed on the panel.  In {\Xic}
only drivers that have been enabled in the technology file are listed
(all drivers are enabled by default).  The format selections are
described below.

Except for the {\et Windows Native} driver all formatting is done in the
{\Xic}/{\WRspice} printer drivers, and the result is sent to the
printer as ``raw'' data.  This means that the selected printer {\it
must} understand the format.  In practice, this means that the printer
selected must be a PostScript printer, and one of the PostScript
formats used, or the printer can be an HP Laserjet, and the PCL format
used, etc.  The available formats are listed below.

\index{Postscript}
\index{PCL}
\begin{description}
\item{PostScript bitmap}\\
The output is a two-color PostScript bitmap of the plotted area.

\item{\et PostScript bitmap, encoded}\\
This also produces a two-color PostScript bitmap, but uses compression
to reduce file size.  Some elderly printers may not support the
compression feature.

\item{\et PostScript bitmap color}\\
This produces a PostScript RGB bitmap of the plotted area.  These
files can grow quite large, as three bytes per pixel must be stored.

\item{\et PostScript bitmap color, encoded}\\
This generates a compressed PostScript RGB bitmap of the plotted area. 
Due to the file size, this format should be used in preference to the
non-compressing format, unless the local printer does not support
PostScript run length decoding.

\item{\et PostScript line draw, mono}\\
This driver produces a two-color PostScript graphics list representing
the plotted area.

\item{\et PostScript line draw, color}\\
This produces an RGB color PostScript graphics list representing the
plotted area.

\item{\et HP laser PCL}\\
This driver produces monochrome output suitable for HP and compatible
printers.  This typically processes more quickly than PostScript on
these printers.

\item{\et HPGL line draw, color}\\
This driver produces output in Hewlett-Packard Graphics Language,
suitable for a variety of printers and plotters.  In {\Xic}, the fill
patterns are defined in the technology file with the {\vt HPGLfilled}
keyword.  Other fill pattern definitions are ignored.  See the
description of the {\et HPGLfilled} keyword in the technology file
(section \ref{techlayers}) for more information.

\item{\et Windows Native} (Microsoft Windows versions only)\\
This selection bypasses the drivers in {\Xic} or {\WRspice} and uses
the driver supplied by Windows.  Thus, any graphics printer supported
by Windows should work with this driver.

The {\et Windows Native} driver should be used when there is no other
choice.  If the printer has an oddball or proprietary interface, then
the {\et Windows Native} driver is the one to use.  However, for a
PostScript printer, better results will probably be obtained with one
of the built-in drivers.  The same is true if the printer understands
PCL, as do most laser printers.  This may vary between printers, so
one should experiment and use whatever works best.

In the Unix/Linux versions, selecting a page size from the {\cb Media}
menu will load that size into the entry areas that control printed
image size.  This is the only effect, and there is no communication of
actual page size to the printer.  This is true as well under Windows,
except in the {\et Windows Native} driver.  Microsoft's driver will
clip the image to the page size before sending it to the printer, and
will send a message to the printer giving the selected paper size. 
The printer may not print if the given paper size is not what is in
the machine.  Thus, when using this driver, it is necessary to select
the actual paper size in use.

\item{\et Xfig line draw, color}\\
{\et Xfig} is a free (and very nice) drafting program available over
the internet.  Through the {\vt transfig} program, which should be
available from the same source, output can be further converted to a
dozen or so different formats.  In {\Xic}, the fill patterns are
defined in the technology file with the {\vt XfigFilled} keyword. 
Other fill pattern definitions are ignored.  See the description of
the {\et XfigFilled} keyword in the technology file (section
\ref{techlayers}) for more information.

\item{\et Image: jpeg, tiff, png, etc.}\\
This driver converts into a multitude of bitmap file formats.  This
supports file generation only.  The type of file is determined by the
extension of the file name provided (the file name should have one!). 
The driver can convert to several formats internally, and can convert
to many more by making use of ``helper'' programs that may be on your
system.

\begin{tabular}{|l|l|}\hline
\multicolumn{2}{|c|}{\kb Internal formats}\\ \hline
\kb Extension & \kb Format\\ \hline
\vt ppm, pnm, pgm & portable bitmap (netpbm)\\ \hline
\vt ps            & PostScript\\ \hline
\vt jpg, jpeg     & JPEG\\ \hline
\vt png           & PNG\\ \hline
\vt tif, tiff     & TIFF\\ \hline
\end{tabular}

For the bitmap image formats, the driver resolution choice really
doesn't change image resolution, but changes the size of the image
bitmap in pixels.  The image ``resolution'' is the number of pixels
per inch in the image size entries.  Thus, selecting a 4x4 inch image
with resolution 100 would create a 400x400 pixel image.  Note that
selecting resolution 200 and size 4x4 would produce the same bitmap
size as 100 and 8x8.

Under Microsoft Windows, an additional feature is available.  If the
word ``{\vt clipboard}'' is entered in the {\cb File Name} text box,
the image will be composed in the Windows clipboard, from where it can
be pasted into other Windows applications.  There is no file generated
in this case.

\index{IMSAVE\_PATH environment variable}
On Unix/Linux systems, if you have the open-source {\bf ImageMagick}
or {\bf netpbm} packages installed then many more formats are
available, including GIF and PDF.  These programs are standard on most
Linux distributions.  The {\vt imsave} system, which is used to
implement this driver and otherwise generate image files, employs a
special search path to find helper functions ({\vt convert} from
ImageMagick, the netpbm functions, {\vt cjpeg} and {\vt djpeg}).  The
search path (a colon-delimited list of directories) can be provided in
the environment variable {\et IMSAVE\_PATH}.  If not set, the internal
path is ``{\vt /usr/bin:/usr/local/bin:/usr/X11R6/bin}''.  The helper
function capability is not available under Microsoft Windows.

If the {\cb Legend} button is active, the image will contain the
legend.  If {\cb Landscape} is selected, the image will be rotated 90
degrees.

\end{description}

The choice between PostScript line draw and bitmap formats is somewhat
arbitrary.  Although the data format is radically different, the plots
should look substantially the same.  A bitmap format typically takes
about the same amount of time to process, independent of the data
shown, whereas a line draw format takes longer with more objects to
render.  For very simple layouts and all schematics and {\WRspice}
plots, the line draw formats are the better choice, but for most
layouts the bitmap format will be more efficient.

The necessary preamble for Encapsulated PostScript (EPSF-3.0) is
included in all PostScript files, so that they may be included in
other documents without modification.


% -----------------------------------------------------------------------------
% xic:files 090914
\index{Files List button}
\index{files panel}
\index{listing files}
\section{The {\cb Files List} Button: {\cb Path Files Listing} Panel}

The {\cb Path Files Listing} panel lists the layout files found along
the search path, including the files found through redirect files. 
The panel can be used to open files and cells for editing and
placement, among other useful features.  The file is brought up with
the {\cb Files List} button in the {\cb File Menu}.

The panel contains a drop-down menu which has an entry for each
directory in the search path, and each directory referenced in a
redirect file.  The main text area lists the files found in the
currently selected directory.

File names are listed in columns.  A character specifies the file
type:  ``X'' for {\Xic}, ``B'' for CGX, ``C'' for CIF, ``G'' for
GDSII, ``O'' for OASIS, and ``L'' for library files.  Unrecognized
file types are not listed.  The directories are polled periodically,
and the file listing is refreshed when changes are found. 
Unfortunately, this is not available under Windows 95/98/ME.  In that
case, resizing the window or popping the listing down then up again
will refresh the listing.

The text area of the files listing is a drag and drop source and
receiver.  As a receiver, files or directories dropped in this area
will appear in the directory that contains the listed files.  By
default, a confirmation pop-up will appear before any action occurs,
but experienced users can disable this by setting the {\et
NoAskFileAction} variable.  See the description of the {\cb File
Selection} panel in \ref{filesel} for the operations that can be
performed via drag/drop.  File names from the listing can be dragged
into the drawing windows, which will load the file into the window.

A file can be selected by clicking on the name, and while selected it
will be highlighted.  When a file name is selected, the {\cb Open},
{\cb Place}, and {\cb Contents} command buttons become active.  These
buttons are inactive (grayed) unless a file name is selected.

\index{files panel!Open}
\index{editing files}
With a file name selected, pressing the {\cb Open} button will load
the file into the main window, as if the file was opened with the {\cb
Open} command in the {\cb File Menu}.  If the file is a library or has
multiple top-level cells, a window appears which enables the user to
make a selection to resolve the ambiguity.  If the current cell is
modified, the user will be given the opportunity to save it before
switching to the new cell.

\index{files panel!Place}
Similarly, pressing the {\cb Place} button will load the top-level
cell (after ambiguity resolution, if necessary) into the {\cb Cell
Placement Control} panel, from which it can be instantiated.

\index{files panel!Contents}
The {\cb Contents} button brings up a panel which displays a listing
of the cells found in the currently selected archive file, or a list
of references if the selected file is a library.  This button is
enabled only when the selected file name corresponds to an archive or
library (codes B, C, G, O, or L).  The {\cb Contents} button makes it
possible to extract individual cells and subcells from an archive
file, without having to load the whole file.  It also provides access
to the references contained within a library file.

The contents listing window contains {\cb Open} and {\cb Place}
buttons.  These buttons are normally grayed, but become active when a
name is selected in the contents listing.  Names are selecting by
clicking with the mouse, as in the {\cb Path Files Listing} panel.

Pressing the {\cb Open} button will extract the named cell from the
source file or library, along with its hierarchy, and load it into the
main window.  If the current cell is modified, the user will be given
the opportunity to save it before switching to the new cell.

Similarly, pressing the {\cb Place} button will load the selected
cell into the {\cb Cell Placement Control} panel, from which it can be
instantiated.

The contents listing is a drag source for drag/drop.  Names from the
list can be dropped into a drawing window, with an effect similar to
using the {\cb Open} button.  If a cell name from the contents list is
dragged and dropped into a drawing window, that cell and its
descendents will be extracted from the archive and displayed in the
window.

When {\Xic} is in CHD display mode, i.e., the {\cb Display} button in
the {\cb Cell Hierarchy Digests} panel is active, the {\cb Open} and
{\cb Place} buttons in the {\cb Path Files Listing} and the contents
window are not available.  The {\cb Place} buttons are not available
in the {\Xiv} feature set. 


% -----------------------------------------------------------------------------
% xic:chdcgd 012411
\index{Cell Hierarchy Digests}
\index{Cell Geometry Digests}
\section{Cell Hierarchy and geometry Digests}
Cell Hierarchy Digests (CHDs) are in-memory objects that map a cell
hierarchy from a layout archive into a compact form, and are used to
extract cell data.  A ``bare'' CHD contains an offset into the
original file for each cell, so that cell data are acquired by reading
the original file.

The CHD facilitates extracting geometric information from the layout
file on a per-cell basis, and is used internally during certain
operations, including windowing, flattening, and empty cell filtering.

A CHD will contain physical and possibly electrical cell hierarchy
data, as extracted from an archive file.  Operations with a CHD that
contains electrical data will either pass-through electrical data
untouched, or strip it entirely.  If the CHD is used to read into the
database or to write a file, and there is no windowing or flattening,
the electrical data will appear in the database or in the output file. 
If windowing or flattening is employed, only the physical data will be
processed.  The output will contain only the physical data.

A CHD facilitates random-access to cells within the file, which in
general is a reasonably efficient process.  However, if the source
file is gzip-compressed (GDSII and CGX files only), random seeking can
be a very slow process, as the decompression state must evolve from
the beginning of the file.  Seeking backwards requires rewinding the
file and decompressing to the desired offset.

\index{ChdRandomGzip variable}
However, there is a random-access mapping option available, controlled
by the setting of the {\et ChdRandomGzip} variable.  This can speed
random access into gzipped files, but requires some memory overhead. 
See the variable description for more information, this feature is not
available in all {\Xic} distributions.

\index{ChdCmpThreshold variable}
The CHD is designed to minimize memory use, and allows processing of
huge layout files that can not fit entirely in virtual memory in the
normal database.  Additional memory reduction is accomplished by
saving cell instance lists in compressed form in memory.  However,
this may have a small computation overhead due to the required
decompression before use.  The {\et ChdCmpThreshold} variable can be
used to turn off this compression, if speed is paramount and memory
use is not an issue.

Optionally, a CHD can be linked to a companion data structure, called
a Cell Geometry Digest (CGD).  A CGD is a compact object that supplies
cell geometry data.  When a CGD is linked, cell geometry are obtained
through the CGD (if present in the CGD), instead of from the original
archive file.  This can reduce access time considerably.

When using a CHD to access cell data, and the CHD has a linked CGD,
and the cell data were previously removed from the CGD, the data will
be obtained from the original layout file.  Thus the CGD can be used
as a kind of cache.

There are three types of CGD:
\begin{enumerate}
\item{The ``memory'' CGD saves all geometry data in memory.  The
 geometry data are highly compressed, so that this makes sense even
 for very large layouts.}
\item{A ``file'' CGD instead stores offsets into a CGD file on disk. 
 The disk file can also contain the CHD representation.  This access
 method is not quite as fast as the in-memory variant, but is still
 generally much faster that reading the original layout file since 1)
 the data are highly compressed so fewer bytes are read, and 2) the
 data are sorted by layer so per-layer searches are more direct.}
\item{A ``remote access'' CGD obtains geometry data from a remote host
 which is running {\Xic} in server mode.  The CGD is a stub which
 links to a CGD in server memory, and data are returned via
 interprocess communication calls.}
\end{enumerate}

The three types indicate the creation mode of a CGD.  In fact, the
data access is specified on a per-record basis, so that a CGD could
contain records of each type.  The mixing of types, and specifically
the ability to bring some records into memory (i.e., caching), will be
more fully developed in future releases.

The CGD contains a reference count, which is incremented when the CGD
is linked to a CHD, and decremented when unlinked.  It is possible for
a CGD to be used by multiple CHDs.  It is not possible to destroy a
CGD while the reference count is nonzero, i.e., when it is linked to a
CHD.

In {\Xic}, CHDs and CGDs are given access names, which are used to
access the CHD or CGD in memory.  These names are arbitrary but must
be unique among the CHDs or CGDs.  They may be assigned by the user or
generated within {\Xic}.

The {\cb Cell Hierarchy Digests} panel, from the {\cb Hierarchy
Digests} button in the {\cb File Menu} is the main entry point for
creation and manipulation of CHDs.  Similarly, the {\cb Cell Geometry
Digests} panel from the {\cb Geometry Digests} button in the {\cb File
Menu} is the main entry point for CGD creation and manipulation. 
These two panels provide the GUI interface to CHD/CGD creation and
manipulation.

In most if not all {\Xic} commands that prompt for the name of a
layout file, instead of a file name, the access name of an existing
CHD can be given, or the name of a saved CHD file can be given.  In
the latter two cases, the command obtains geometric data through the
CHD, which can be much faster, but operates as one would expect if
directly giving the name of the referenced layout file.

However, a linked CGD provides only physical data, and properties and
text labels are stripped.


% -----------------------------------------------------------------------------
% xic:hier 022816
\index{Hierarchy Digests button}
\index{Cell Hierarchy Digests panel}
\index{Cell Hierarchy Digests}
\section{The {\cb Hierarchy Digests} Button: List {\cb Cell Hierarchy Digests}}

The {\cb Hierarchy Digests} button in the {\cb File Menu} brings up the
{\cb Cell Hierarchy Digests} listing of the Cell Hierarchy Digests
(CHDs) currently in memory.  A CHD is a compact representation of a
cell hierarchy, which facilitates access to data on a per-cell basis. 
The CHD and companion Cell Geometry Digest (CGD) data structures
provide a foundation for many of the operations in {\Xic}, including
windowing, flattening, and empty cell removal.  An overview of CHD/CGD
capabilities was provided in the previous section.

Each saved CHD has a unique but otherwise arbitrary access name.  The
access name is initially assigned by the user or generated by {\Xic}. 

The listing consists of the CHDs by access name.  The middle column in
the CHD listing will show the name of a linked CGD, if any.  The right
column lists the source file name and default top-level cell.

Most {\Xic} commands that take a layout file path as input will
accept a CHD access name.  The command will operate with the data
obtained through the CHD, which can be identical with
that from the original layout file, but operations will in general
proceed more quickly.

Clicking on one of the rows in the listing will select that CHD.  The
selected CHD is acted on by most of the command buttons arrayed along
the top of the panel, which provide the following functions.

\begin{description}
\item{\cb Add}\\
This button brings up the {\cb Open Cell Hierarchy Digest} panel
(described in \ref{chdadd}) which allows a new CHD to be created and
added to the list.

\item{\cb Save}\\
A CHD can be saved to a file, and recalled into memory later.  This
button produces the {\cb Save Hierarchy Digest File} pop-up that
solicits a file name/path into which a representation of the currently
selected CHD will be saved.  A previously saved CHD can be recalled
with the {\cb Add} button.

If the {\cb Include geometry records in file} check box in the pop-up
is checked, geometry records will be included in the file.  These
records are effectively a concatenation of a Cell Geometry Digest file
representation.  Layer filtering (see \ref{layerchange}) can be
employed to specify layers to include, through the layer filtering
control group which is activated when including geometry.

The resulting file is a highly compact but easily random-accessible
representation of the layout file.  However, it does not include text
labels, properties, or electrical data.

\item{\cb Delete}\\
The presently selected CHD is destroyed, after confirmation.

\item{\cb Config}\\
This brings up the {\cb Configure Cell Hierarchy Digest} panel
(described in \ref{chdcfg}) which enables configuration of the CHD. 
There are two attributes that may be configured:  the assumed
top-level cell in the hierarchy, and the linking of a CGD for geometry
access.  The pop-up provides control of these attributes.

\item{\cb Display}\\
When this toggle button is pressed, the main window and new sub-windows
display the cell hierarchy in the CHD.  Editing is not possible in any
window in this mode, so the side menu becomes invisible.  The display
is very similar to that of the normal display mode.  The usual
zooming/panning, expansion, and other modes apply, though no selection
operations are available.  In CHD display mode, the {\cb Edit}, {\cb
Modify}, {\cb DRC}, and {\cb Extract} menus are unavailable, and
various other functions in the other menus are unavailable.

When the {\cb Display} button is pressed, a small pop-up appears,
which allows the user to select an area to display before the image is
created, which is compute intensive and time consuming.  The user
should enter the center x and y and display width (in microns) of the
region of the top-level cell to be displayed.  Pressing {\cb Apply}
will create and display the image.  Alternatively, the {\cb Center
Full View} button can be pressed to display the entire cell.

The features in the display are obtained through the CHD, and thus no
additional memory is required than that used by the CHD itself.  Since
the CHD occupies a small fraction of the memory required to hold the
originating layout file in the main database, very large files can be
viewed, much larger than files viewed the normal way for a given
amount of available system memory.

The row in the CHD listing that is currently being displayed is
marked, by an ``open'' icon in Windows, or by a different background
color.  This display mode will persist as long as the {\cb Display}
button is active, whether or not the pop-up is visible.

The root cell in the display is initially the default cell from the
CHD.  This cell can be specified in the pop-up from the {\cb Config}
button.  If no cell name is specified, the top-level cell in the CHD
(a cell not used as a subcell within the CHD) with the lowest offset
(there may be more than one) is assumed.  If a Cell Geometry Digest
(CGD) has been linked to the CHD in the configuration panel, the
displayed geometry is obtained from the CGD.  In this case, text
labels, which are never included in the CGD database, are absent from
the display.

Drag and drop can be used from the contents listing (below) to change
the root cell in the display.  This does not change the default cell
of the CHD, and only applies to the display in the drop-target window.

\item{\cb Contents}\\
This button brings up or updates a listing of the cells in the
currently selected CHD.  The cell names can be selected by clicking in
the listing.  Only cells which correspond to the current display mode
(physical or electrical) are shown.

The contents listing pop-up contains {\cb Info}, {\cb Open}, and {\cb
Place} buttons, which are active when a name is selected.  Pressing
{\cb Info} will display info about the selected cell, as saved in the
CHD.  Pressing {\cb Open} will extract the selected cell and its
hierarchy from the source file into the main database, and display it
in the main window, as if opened with the {\cb Open} button in the
{\cb File Menu}.  Pressing {\cb Place} will likewise extract the cell
hierarchy, but load it into the {\cb Cell Placement Control} panel for
instantiation.

The contents listing is enabled as a drag source.  If an item is
dragged to a drawing window and dropped the following will happen.  If
the drop window is displaying the CHD (the {\cb Display} button is
active), the window display will become rooted in the dropped cell. 
Nothing new is read into memory.  If the drop window is in normal
display mode, the cell and its hierarchy will be read from the CHD's
source into the main database, and the cell will be displayed.  Note
that this can cause out-of-memory problems if one isn't careful.

\item{\cb Cell}\\
It is possible to create ``reference cells'' in the main database that
reference the CHD.  These cells are otherwise empty, but when placed
in a layout, and the layout is saved to disk, the hierarchy from the
CHD will be written into the output file.  See \ref{refcell} more more
information about reference cells.

This can be used to assemble a top-level cell or reticle containing
very large amounts of data, far more than can be kept in memory in the
usual way.

Pressing the {\cb Cell} button will solicit the name of the reference
cell.  This is the name of a cell found in the CHD, and will also be
the name of the reference cell created in memory.  The pop-up is
initially loaded with the name of the default cell of the CHD, but
another cell name can be dragged from the contents listing or entered
manually.

Pressing {\cb Apply} in the solicitation pop-up will create the
reference cell in memory.

In normal editing mode, the reference cells can be placed in the
normal way (though they appear to have no content -- they display as
an empty box).  The reference cells can be saved as native cells, in
which case they remain as reference cells, and can be loaded into
{\Xic} just as any native cell.

When a reference cell is written to an archive file such as GDSII or
OASIS, the reference cell is replaced by the cell and its hierarchy,
as extracted from the original layout file.

Reference cells cannot be flattened with the {\cb Flatten} command,
they will simply disappear.

\item{\cb Info}\\
Pressing this button will bring up or update a window containing
information about the currently-selected CHD.

\item{\cb ?} (quick info)\\
This button brings up ``quick info'' about the currently selected CHD,
including the full path to the source file.  The same information can
be obtained from the {\cb Info} button, but this is much more
extensive and may take some time to compute.  The quick info is
instantaneous.

\item{\cb Help}\\
This brings up the help window describing the {\cb Cell Hierarchy
Digests} pop-up.
\end{description}

The buttons and controls below the listing window provide general
CHD-related functions, that do not make use of selections in the
listing.

\begin{description}
\item{\cb Use auto-rename when writing CHD reference cells}\\
This mode applies when writing a cell hierarchy containing reference
cells.  A reference cell is a cell in memory that has no content of
its own, but rather serves as a pointer to a cell hierarchy obtained
through a CHD (Created with the {\cb Cell} button described above). 
When such cells are encountered when writing a hierarchy from the main
database, the reference cell is replaced with the hierarchy obtained
through the referenced CGD.

When writing CHD reference hierarchies, there are two algorithms that
can be employed that prevent writing duplicate cell names.  When this
check box is not checked, cells encountered with the same name as a
cell previously written will be skipped, i.e., no new cell definition
will be added to the output file, and all subsequent instances of the
cell will call the existing definition.

When this box is checked, and a duplicate cell name is encountered,
and the existing definition came from a different CHD, the name is
changed and a new cell definition is added to the output file. 
References to the cell will call the cell by its new name.  However,
name clashes from equivalent CHD's will cause the new cell definition
to be skipped, as in the default mode.  An ``equivalent CHD'' can mean
the same CHD in memory, or a different CHD but opened on the same file
with the same aliasing.

This button tracks the state of the {\et RefCellAutoRename} variable.

\item{\cb Load top cell only}\\
When a cell is brought into the main database through a CHD, if
this box is checked:
\begin{enumerate}
\item{Only that cell, and not its subcells, will be loaded into the
main database.  Any subcells of the cell become reference cells (see
\ref{refcell}) in the main database.}
\item{The name of the cell will be added to the
override table.}
\end{enumerate}

This allows editing of the requested cell, and when written to disk
the complete hierarchy will appear, however loading the whole
hierarchy into memory is avoided.

This check box tracks the state of the {\et ChdLoadTopOnly} variable.

\item{\cb Fail on unresolved}\\
This check box tracks the state of the {\et ChdFailOnUnresolved}
variable.  When set, when using a CHD to access cell data and a cell
is found that can't be resolved in the source file or through the
library mechanism, the operation will halt with a fatal error.  If not
set, processing will continue, with the non-references either being
ignored (e.g., when flattening), or converted to empty cells (when
reading into the database), or propagated to output (when writing
output), depending on the operation.

\item{\cb Use cell table}\\
When checked, when a CHD is used to access cell data, cells found in
the override table (see \ref{overtab}) will override those in the
source.  Depending on settings, such cells may be effectively replaced
by cells in memory, or simply skipped.

This check box tracks the state of the {\et UseCellTab} variable.

\item{\cb Edit Cell Table}\\
This button displays the {\cb Cell Table Listing} panel.  This enables
editing of the list of cell names that are treated specially during
CHD file-access operations, the ``override table''.

\item{\cb Default Geometry Handling}\\
This menu sets the default way to handle geometry records found when
reading a saved CHD file.  This mode will apply when a CHD file name
is given as input for a command (which is generally possible for
commands that are soliciting a layout file), and there is no specific
means of controlling the geometry record processing.

There are three choices.  The initial default is to create a
memory-type CGD from the geometry records, and link it to the CHD.  In
this case, all geometry data will reside in memory, which makes sense
even for very large designs as the data are highly compressed.  The
second option is to create a file-type CGD and link it to the CHD.  In
this type of CGD, geometry is obtained from the geometry records in
the CHD file when needed, and does not reside in memory.  The third
option is to ignore the geometry records, and therefor not create a
linked CGD.  Geometry will be obtained from the original layout file
in this case (the original layout file must still exist in the same
location as when the CHD file was created).
\end{description}


% -----------------------------------------------------------------------------
% xic:chdadd 012511
\index{Open Cell Hierarchy Digest panel}
\subsection{The {\cb Open Cell Hierarchy} Panel}
\label{chdadd}

This panel specifies a path to a layout or saved Cell Hierarchy Digest
(CHD) file, from which a new CHD will be created in memory and added
to the {\cb Cell Hierarchy Digests} listing.  The panel is brought up
with the {\cb Add} button in the {\cb Cell Hierarchy Digests} panel.

The panel provides two separate ``notebook'' tabs that specify the
type of file to read: layout file or saved CHD file.  The notebook
pages expose the controls applicable to the type of input, however
either type of file can be entered in the entry area of either page.
The tabs serve to simplify the panel.

All cell hierarchy data, both physical and electrical, will be
extracted from a layout file.  However, if the {\cb LockMode} variable
is set while in physical mode, the electrical data, if any, will be
omitted.  If the source is a saved CHD file, the CHD in memory will be
recreated verbatim, ignoring current mode settings.

When the source is a layout file, systematic cell name modifications
can be applied, if desired.  This is sometimes useful for avoiding
name clashes.  If cell name modification is used, the modified names
must be used when specifying a cell to the new CHD, the original cell
names are not retained.

When reading a layout file, it is possible to save some statistical
information in the CHD, regarding counts of the geometrical objects in
the file.  This information will increase the size of the CHD in
memory, with the bottom selection requiring the most memory, the top
selection the least.  The information saved is counts of the number of
boxes, polygons, and wires seen.  The choices are:

\begin{description}
\item{\cb no geometry info saved}\\
Don't save any statistical information.

\item{\cb totals only}\\
This is the default, the totals for the file will be available.

\item{\cb per layer counts}\\
The total counts for the file will be available for each layer used.

\item{\cb per cell counts}\\
The counts will be available for each cell in the file.

\item{per-cell and per-layer counts}\\
The counts will be available for each layer used in each cell.
\end{description}

This information will be printed in the {\cb Info} window of the {\cb
Cell Hierarchy Digests} pop-up.  The file totals are shown in the CHD
info, which is shown when there is no selection in the {\cb Contents}
window.  The per-cell counts are shown in the {\cb Info} window when a
cell name is selected in the {\cb Contents} listing.

If the CHD is going to be used in an operation with layer filtering,
it is recommended that {\cb per-cell and per-layer counts} be
selected, as this allows efficient removal of cells made empty by the
layer filtering (see \ref{ecfilt}).

If the file name specified is a saved CHD file (previously created
from the {\cb Save} button in the {\cb Cell Hierarchy Digests}
pop-up), then the other entries (cell name mapping and geometry
counts) are ignored.  The cell name mapping is retained from the
original CHD that was saved.  The geometry counts are presently
discarded when a CHD is saved.

If the CHD file being read contains geometry records, the processing
of these records can be specified by the radio buttons in the {\cb CHD
file} page.  There are three choices.  The first option is to create a
memory-type CGD from the geometry records, and link it to the CHD.  In
this case, all geometry data will reside in memory, which makes sense
even for very large designs as the data are highly compressed.  The
second option is to create a file-type CGD and link it to the CHD.  In
this type of CGD, geometry is obtained from the geometry records in
the CHD file when needed, and does not reside in memory.  The third
option is to ignore the geometry records, and therefor not create a
linked CGD.  Geometry will be obtained from the original layout file
in this case (the original layout file must still exist in the same
location as when the CHD file was created).

These options are identical to default options which can be set from
the {\cb Cell Hierarchy Digests} panel, but the present panel
overrides the default setting and applies only to the current
operation.


% -----------------------------------------------------------------------------
% xic:chdconfig 012511
\index{Configure Cell Hierarchy Digest panel}
\subsection{The {\cb Configure Cell Hierarchy Digest} Panel}
\label{chdcfg}

The {\cb Config} button in the {\cb Cell Hierarchy Digests} panel
brings up the {\cb Configure Cell Hierarchy Digest} panel, with which
it is possible to change the default top cell of a Cell Hierarchy
Digest (CHD), and to link a Cell Geometry Digest (CGD) which can
accelerate geometry record access.

The present default top-level cell name is shown in the editable area
near the top of the pop-up.  In an unconfigured CHD, the default
top-level cell is the first cell encountered in the layout file that
is not used as a subcell by any other cell in the file.  Any cell
defined in the file can be assigned as the top-level cell of the CHD. 
In any operation involving the CHD when a top-level cell is not
otherwise specified, the configured cell will be taken as the default.

To configure a new top-level cell, use the {\cb Contents} listing of
the {\cb Cell Hierarchy Digests} panel, if necessary, to identify an
alternate cell name.  Note that this is the name after any cell name
modification is applied.  A cell name can be dragged from the contents
listing and dropped in the entry area, or the name can be entered
manually.

Pressing the {\cb Apply} button in this group will complete the cell
name configuration.  The label of the {\cb Apply} button will change
to ``{\vt Clear}'', and the controls in this group will be grayed. 
The label at the top of the panel will indicate that a top-level cell
has been configured.  Pressing {\cb Clear} will un-configure the
top-level cell, reverting to the default.

The {\cb Last} button will recall the last cell name used, if any.

A Cell Geometry Digest can be linked to the CHD.  In this case,
geometrical data retrieved through the CHD will be obtained from the
CGD, and not the original layout file.  This linking can be
accomplished, or removed, with the lower group of controls.

To link an existing CGD, one enters its access name into the {\cb CGD
name} entry area.  This is the name shown in the first column of the
{\cb Cell Geometry Digests} listing.  Pressing the {\cb Apply} button
in this group will perform the link, gray the entries, and the button
label will change to ``{\vt Clear}''.  The label text at the top of
the panel will indicate that the CHD is now configured ``with
geometry''.  Pressing the {\cb Clear} button will reverse the process.

If the name in the {\cb CGD name} entry area matches an existing CGD,
that CGD will be linked, whatever the status of the {\cb Open new CGD}
check box.  If {\cb Open new CGD} is checked, and the {\cb CGD name}
is empty or a non-matching name, a new CGD will be created, and either
saved under the name given, or assigned a new name by {\Xic} if no
name is given.

Pressing {\cb Apply} when a new CGD is to be created will bring up the
{\cb Open Cell Geometry Digest} panel.  This allows setting up
parameters in the new CGD as needed.  Pressing {\cb Apply} in this
panel will complete the operation, as reflected by the state shown in
the {\cb Configure Cell Hierarchy Digest} panel.  The new CGD will be
listed in the {\cb Cell Geometry Digests} panel, if it is visible.

When a CGD is created in this manner, specifically for linking to a
CHD, the new CGD will be automatically destroyed when unlinked from
the CHD (or when the linking CHD is destroyed).  One can see the CGD
disappear from the {\cb Cell Geometry Digests} panel when unlinked
({\cb Clear} is pressed) in this case.

Please note that there is no way for the CHD to know whether the
linked CHD applies to the same original layout file.  Linking to a CHD
produced from a completely different layout will ``succeed'', and there
will be no errors even in use.  As geometry is being read, if a cell
is not found in the linked CGD, no geometry will be returned, and the
cell will appear to contain no geometry.  If is up to the user to make
sure that CHD and linked CGD cell name spaces are compatible.


% -----------------------------------------------------------------------------
% refcell 030216
\subsection{Reference Cells}
\label{refcell}
\index{reference cells}
Reference cells are ``pseudo cells'' which exist in memory or on disk
as native cell files only.  These cells contain no content, but
instead reference another cell hierarchy.  Reference cells have the
same name as the top-level cell assumed in the referenced hierarchy. 
Reference cells can be used with physical layout data only.

When reference cells are placed in a layout, and the layout is written
to an archive file format on disk, the reference cells are replaced
with the hierarchy referenced.

Reference cells can be created from the {\cb Cell Hierarchy Digests}
panel, with the {\cb Cell} button. 

Here is an example to illustrate how reference cells may be created
and used.  Assume that we have a file named ``{\vt input.gds}'' that
contains a cell named ``{\vt input\_top}.

From the {\cb ell Hierarchy Digests} panel, the {\cb Add} button is
used to create a CHD for {\vt input.gds}.

The resulting CHD is selected in the listing, and the {\cb Cell}
button is pressed.  A pop-up will appear requesting the name for the
cell.  The default name is the default top-level cell for the CHD, or
the configured name.  If this is not our desired name ``{\vt
input\_top}'', the text is changed accordingly, and {\cb Apply} is
pressed.  The reference cell will be created in memory (it will be
listed in the {\cb Cells Listing} panel).

If memory is tight, the CHD that was just created can be deleted.  It
will be recreated if necessary.  The {\cb Cell Hierarchy Digests}
panel can be dismissed.

The user can view the new cell with the {\cb Open} command.  Note that
it has a bounding box, but no content.  Trying to modify the cell by
adding a box, for example, will fail.  Reference cells are immutable -
meaning read-only.

The reference cell named ``{\vt input\_top}'' is ready to be placed
into another hierarchy.  One can begin editing a new cell, assume that
it is called ``{\vt foo}''.  The user will be asked whether to save
the previous (reference) cell.  The reference cell can be saved as a
native cell, however it is not possible to change the cell name.  The
cell can be saved in this manner if the user wants a copy which can be
reused in the future.  Incidently, it is possible to coerce saving of
a reference cell to an archive format, as usual, in which case the new
file will contain the referenced cell hierarchy.

The user should make sure that the current expansion level is set to
0.  When editing ``{\vt foo}'', the {\cb place} button in the side
menu can be used to place one or more instances of ``{\vt
input\_top}'', perhaps using the {\cb Current Transform} to rotate,
mirror, or magnify the instances.  This will be no different than
placing normal instances.  The bounding boxes of the newly placed
cells will be visible, as normal, however if the expansion level is
increased, the bounding boxes disappear and there is no visible
indication of the newly place cells, except that the overall bounding
box encompasses them.  Again, the reference cells have no content.

The hierarchy under {\vt foo} can be saved to an archive format in the
usual manner, for example one can type ``{\vt sav}'' in the drawing
window or press the {\cb Save As} button in the {\cb File} menu.  In
response to the prompt, one can enter ``{\vt foo.gds}'', for example,
to produce a GDSII file, and press {\kb Enter}.  The user should then
confirm saving to GDSII format at the confirmation prompt, and the
file {\vt foo.gds} will be created.

To have a look at the new GDSII file, the user can clear the database
with the {\cb Symbol Tables} pop-up or by typing ``{\vt !!Clear(0)}''. 
Then, the {\cb Open} command can be used to open {\vt foo.gds}.  The
unexpanded display will look the same as before, but note now that
when expanded, the contents of the cells are displayed, as obtained
from the {\vt input.gds} file, but this content is now included in
{\vt foo.gds}.

This procedure serves a similar purpose to the {\cb Layout File Merge
Tool} and the {\cb !assemble} command, but is graphical and easier to
perform.  It enables assembling a higher-level layout file from
lower-level component files.  Since the component files don't have to
be in memory, one can assemble huge layouts with a modest computer,
using any of these techniques.

\subsubsection{Reference Cell Structure}

A reference cell is basically an empty physical native cell with a
{\et refcell} property (property number 7150, as described in
\ref{physpropfmt}).  This property contains the information that ties
the reference cell to a source and provides a bounding box.  A
complete example of a reference cell is shown below,

\begin{quote}
\begin{verbatim}
(Symbol asic2);
(xic 4.2.9 LinuxRHEL7_64 03/01/2016 04:36 GMT);
(PHYSICAL);
(RESOLUTION 1000);
( CREATED 3/1/2016 4:36:34, MODIFIED 3/1/2016 4:36:34 );
5 7150 filename="/usr/local/cad/layouts/asic2.gds" cellname=asic2
    bound=0.000,0.000,2328.100,2543.700;
9 asic2;
DS 0 1 1;
DF;
E
\end{verbatim}
\end{quote}

This reference cell is a stand-in for a cell named ``{\vt asic2}''
which is found in the path given.  Note the simple form of the cell,
particularly realizing that the comment lines (enclosed in
parentheses) are optional.  It is completely feasible to create
reference cells with a text editor.  The only reason that the CHD was
used is that it provides the correct cell bounding box.  The bounding
box is used in the display, but does not affect the actual location or
size of the cell hierarchy when expanded.


% -----------------------------------------------------------------------------
% xic:overtab 022816
\subsection{The {\cb Cell Table Listing} Panel: Set Override Cells}
\label{overtab}
\index{Cell Table Listing panel}
Whenever a Cell Hierarchy Digest (CHD) is used to access a cell
hierarchy for any purpose {\it other} than to read the cells into the
main database, a cell substitution mechanism can be employed.  This
mechanism is enabled by setting the {\et UseCellTab} variable, or the
{\cb Use cell table} check box in the {\cb Cell Hierarchy Digests}
panel.

Each symbol table contains a hash table for cell names, which is used
as the "cell override table" when working with CHDs.  The {\cb Cell
Table Listing} panel lists the cell names in this table, for the
current symbol table.  This panel is made available through the {\cb
Edit Cell Tab} button in the {\cb Cell Hierarchy Digests} panel.

The names listed in the table are cells found in the global string
table for cell names.  This includes the names of cells read into
memory, and the names of cells referenced in CHDs in memory.  The
names persist even if the corresponding cell or CHD is removed from
memory, until a global clear is performed with the {\vt ClearAll}
script function.

The panel provides the following buttons to manipulate the table
contents.

\begin{description}
\item{\cb Add}\\
The {\cb Add} button produces an entry form that allows the user to
enter a new cell name into the table.  The name given must be that of
a cell previously opened or referenced by a CHD, as explained above.

The listing window is also sensitive as a drop receiver, so that cell
names can be dragged/dropped from other windows, such as the {\cb
Cells Listing} panel, or the {\cb Contents} listing of the {\cb Cell
Hierarchy Digests} panel.

If a cell is read into the main database from a CHD, and the {\et
ChdLoadTopOnly} variable is set, then the cell will automatically be
added to the table.

The state of the {\et ChdLoadTopOnly} variable (set or not) tracks the
state of the {\cb Load top cell only} check box in the {\cb Cell
Hierarchy Digests} panel.

\item{\cb Remove}\\
This button allows names to be removed from the table, individually.

\item{\cb Clear}\\
The {\cb Clear} button will remove all names from the table, after
confirmation.

\item{\cb Override} and {\cb Skip}\\
These two mutually-exclusive selections set how entries in the table
are to be used.  When {\cb Override} is selected, listed cells that
exist in the main database will override the cell in the CHD, as
described below.  If an override cell does not exist in the main
database in the current symbol table, the operation will fail with an
error.

If {\cb Skip} is selected, the cells will simply be skipped.  This is
applicable when writing an archive file via a CHD, in which case cell
definitions for the override cells will not appear, however references
to the cells will remain.  The file will require the library mechanism
or some other means of satisfying the references when the file is
read.  In this mode, it does not matter whether or not the named cells
exist in the main database.

These two choices track the state of the {\et SkipOverrideCells}
variable.
\end{description}

The table can also be maintained through use of the script functions
described in \ref{celltab}.

When a CHD is accessing cell data, if overriding is enabled and the
cell name matches a name in the table, the CHD will access the cell in
main memory and not from any other source.  The contents of the cell
will be streamed recursively, however only subcells with names that
are also in the table will have cell definitions included.  Subcells
that are not included in the table should exist in the CHD, otherwise
there will be an undefined cell in output.

Note that substituting cells will not prevent the CHD from outputting
cells that, given the substitutions, are not used in the hierarchy. 
For example, suppose cell A in the CHD has an instance of cell B, and
this is the only instantiation of B.  Consider that A is overridden by
a version that does not instantiate B.  In the current release, the
output file will contain B, as an unused cell (top-level).

As an example of how the override mechanism and related features can
be used, imagine that we have a large GDSII layout file, and we would
like to make a small modification to the top-level cell.  Suppose that
the file to too large to load into main memory in the usual way for
editing.

The first step is to create a CHD for the file, using the {\cb Cell
Hierarchy Digests} panel from the {\cb File Menu}.  The {\cb Add}
button can be used to create the CHD, which will be listed on the
panel.

Next, we grab the cell that we wish to modify into the main database. 
Select the CHD and press the {\cb Contents} button in the {\cb Cell
Hierarchy Digests} panel.  A listing of all cells in the file will
appear, with the top-level cells listed first, with an asterisk.

Press the {\cb Load Top Cell} button.  With this button pressed, when
a cell is opened in the main database from the CHD, only that cell,
and not its complete hierarchy, will be opened in memory.  This is
important, since we know that the complete hierarchy of the cell we
plan to edit will not fit in memory.

In the content listing, drag the name of the cell to be edited to the
main drawing window and drop it there.  The cell will be displayed,
and is ready for editing.  Note that, when unexpanded, all of the
subcells appear normal, however when expanded, they disappear.  The
subcells are actually CHD reference cells, which have no content but
serve as a pointer to the CHD when the subcell data is needed.

Once the appropriate changes have been made, there are two ways to
save the modifications.  The first way relies on the assumption we
made earlier that the cell being edited is the top-level cell in the
hierarchy.  Since this is so, we could simply save the current cell as
GDSII.  When saving, the reference cells are expanded to the full
hierarchy during writing.

The second method illustrates the use of the override cells.  Press
the {\cb Edit Cell Tab} button to bring up the editor window for the
override cell table.  The cell of interest will already be listed,
since it was automatically inserted when it was opened for editing
from a CHD when the {\cb Load Top Cell} button was active.

Press the {\cb Use Cell Tab} button in the {\cb Cell Hierarchy
Digests} panel, which will enable use of the override table.

In the {\cb Convert Menu}, press the {\cb Conversion} button to bring
up the {\cb Conversion} panel.  At the top of the {\cb Conversion}
panel, set the {\cb Input Source} to {\cb Cell Hier Name}, select the
{\cb GDSII} output format tab, then press the {\cb Convert} button. 
When prompted, give the name of the CHD we created, from the {\cb Cell
Hierarchy Digests} panel, it will be something like ``CellHier1''. 
Then, give the name of a GDSII file to create.  The new file will
contain the modifications we performed.


% -----------------------------------------------------------------------------
% xic:geom 032111
\index{Geometry Digests button}
\index{Cell Geometry Digests panel}
\index{Cell Geometry Digests}
\section{The {\cb Geometry Digests} Button: List {\cb Cell Geometry Digests}}

This panel, brought up with the {\cb Geometry Digests} button in the
{\cb File Menu}, provides a list of Cell Geometry Digests currently in
memory.  A Cell Geometry Digest (CGD) is a per-layer/per-cell database
of highly compacted representations of cell geometry.  Logically, a
cell name and layer name are passed to the database, which returns a
data block which when expanded yields a representation of the geometry
on the given layer in the given cell.  The database contains no
information about cell instances, and text labels and object
properties are excluded.

This is basically a companion to the Cell Hierarchy Digest (CHD),
which contains hierarchy information but no geometry information.  The
two data types together provide complete physical information about
the file.

A CGD can be linked to a CHD.  After linking, the CHD will retrieve
needed geometrical information from the linked CGD, rather than from
the original layout file.  This can be faster, since the CGD geometry
data may be in memory, and are sorted by layer and compacted.  Even
with all geometry data residing in memory, the combined size of the
CHD/CGD structures is still much smaller than the memory required for
loading the original layout file into the main database in the normal
way.  The main database, however, provides the spatial sorting for
fast access of objects at a given location, which is absent in the
CHD/CGD combination.

Each saved CGD is given a unique but otherwise arbitrary name, which
is used to access the CGD.  The CGDs presently in memory are listed by
name, and can be selected by clicking.

The listing contains a middle column labeled {\cb Type, Linked}, which
will contain {\cb Mem}, {\cb File}, or {\cb Rem} indicating the
geometry storage type of the CGD.  This will be followed by {\cb yes}
if the CGD is linked to a CHD.  An asterisk `{\cb *}' will follow {\cb
yes} if the CGD will be destroyed when unlinked from its CHD.  The
right column contains the source file name, if any.  The {\cb Info}
button will provide more information about the CGD, including the full
path to the source file.

The selected CGD is used as input for operations initiated by the row
of buttons arrayed across the top of the panel.  These buttons are:

\begin{description}
\item{\cb Add}\\
This button brings up the {\cb Open Cell Geometry Digest} panel, from
which a new CGD can be created and added to the list (see \ref{cgdadd}).

\item{\cb Save}\\
The currently selected CGD can be saved to a file, for later recall. 
This button brings up a pop-up which solicits a name for this file. 
Pressing {\cb Apply} will save the selected CGD to a disk
representation in the given file path.  A previously saved CHD can be
recalled into memory from the panel brought up by the {\cb Add}
button.

\item{\cb Delete}\\
This will destroy the selected CGD, after confirmation.  Only CGDs
that are not currently linked to a CHD can be destroyed.

\item{\cb Contents}\\
This will pop up or update a listing of the cells found in the
selected CGD.  With a name selected, the {\cb Info} button becomes
active.  Clicking {\cb Info} will pop up or update another window,
which lists the layers used in the selected cell.  Only layers that
have associated geometry are saved in the CGD.  Each layer is listed
with two numbers, representing the size of the compressed data stream
for the layer ('c') and the uncompressed size ('u').  These aren't
particularly useful to the user, but do give some indication of how
much geometry is associated with each layer.  Beware, however, that
gigabytes of replicated features may be represented by only a few
bytes.

\item{\cb Info}\\
This button pops up a window listing information about the 
selected CGD.  The information includes the type of CGD, and other
parameters such as memory use, cell count, etc.
\end{description}

% -----------------------------------------------------------------------------
% xic:cgdcopen 012511
\index{Open Cell Geometry Digest panel}
\section{The {\cb Open Cell Geometry Digest} Panel}
\label{cgdadd}
This panel is used to create a new {\cb Cell Geometry Digest} in
memory, which is added to the listing in the {\cb Cell Geometry
Digests} panel.  This panel is brought up with the {\cb Add} button in
the {\cb Cell Hierarchy Digests} panel.

There are three ``notebook'' tabs that correspond to the three types
of CGD.  Each corresponding page contains controls for setting the
parameters appropriate for the selected CGD type.

\begin{description}
\item{\cb in memory}\\
The {\cb in memory} tab corresponds to a ``memory'' CGD.  This type of
CGD saves all geometry data in memory.  The geometry data are highly
compressed, so that this makes sense even for very large layouts.

The source from which to create the CGD is entered into the entry area
at the top of the page.  The source can be one of the following:

\begin{enumerate}
\item{A path to a layout (archive) file.}\\
\item{The access name of a CHD already in memory.}\\
\item{A path to a saved CHD file.}\\
\item{A path to a saved CGD file.}\\
\end{enumerate}

If the source is a layout file, one can apply layer filtering as the
file is being read.  It is also possible to apply cell name mapping. 
If mapping is employed, layer data are accessed via the modified cell
names.  If the CGD is to be linked with a CHD, the cell name mapping,
if any is used, should be the same when creating the CHD and the CGD. 
The control groups below the entry expose the layer filtering and
cell name mapping capabilities.

If the source is a CHD access name, or a CHD file, the cell name
mapping is automatically set to the same as was used in creating the
CHD.  The layer filtering is available if the source is a CHD access
name, or if the source is a CHD file saved without geometry records
(with the {\cb Save} button in the {\cb Cell Hierarchy Digests}
panel).  If the source is a CHD file containing geometry records, the
CGD uses those geometry records verbatim.

If the source is a saved CGD file (from the {\cb Save} button in the
{\cb Cell Geometry Digests} panel), the CGD will import this file
verbatim.

\item{\cb file reference}\\
The {\cb file reference} tab corresponds to a ``file'' CGD.  This type
of CGD stores offsets into a CGD file on disk.  The disk file can
potentially also contain a CHD representation.  This access method is
not quite as fast as the in-memory variant, but is still generally
much faster that reading the original layout file since 1) the data
are highly compressed so fewer bytes are read, and 2) the data are
sorted by layer so per-layer searches are more direct.

This page consists of an entry area, into which a source is entered. 
The source can be either a path to a saved CGD file, or to a saved CHD
file that contains geometry records.  In either case, the new CGD is
created to reference the geometry data by offset into the source file.

During its lifetime, this type of CGD maintains an open file
descriptor to its source file.  Although it is not likely, it may be
possible to hit a system limit for open file descriptors if too many
file CGDs are simultaneously open.

\item{\cb remote server reference}\\
The {\cb remote server reference} tab corresponds to a ``remote
access'' CGD.  This type of CGD obtains geometry data from a remote
host which is running {\Xic} in server mode (see \ref{servermode}). 
The remote access CGD is a stub which links to a CGD in server memory,
and data are returned via interprocess communication calls.

This page provides separate entry areas for the host name, port, and
remote CGD access name.  These correspond to the remote host running
the {\Xic} server, which must have a CGD in memory (of any type).  The
new CGD will transparently link to the remote CGD, under a local
access name.

The {\cb Host name} entry must contain the network host name of the
machine running the server.  The {\cb Port number} is optional, if not
specified the port used defaults to 6115, which is the IANA registered
port number for the ``{\vt xic/tcp}'' service.  If the server is for
some reason using a different port number, that same port number must
be entered.  The access name of the CGD to reference on the server
must be entered into the {\cb Server CGD access name} entry area.

During its lifetime, this type of CGD maintains an open socket to the
server.  Since the number of connections is limited, it is best to
free this type of CGD as soon as possible.
\end{description}

Below the notebook area is an entry for access name.  This is the name
under which the new CGD will be listed in the {\cb Cell Geometry
Digests} panel.  A default is provided that is guaranteed not to
conflict with an existing CGD.

The user can specify an access name.  If the name is in use by an
existing CGD, and the existing CGD is not linked to a CHD, it will be
destroyed, and the new CGD will be created and saved under the same
name.  However, if the existing CGD is linked, it cannot be destroyed,
and the CGD creation will fail with an error message.

When the {\cb Apply} button is pressed, if all goes properly the
source will be processed, the new CGD will be created, and added to
the list in memory under the access name given.




% -----------------------------------------------------------------------------
% xic:libs 022116
\section{The {\cb Libraries List} Button:  List Open Libraries}
\label{libraries}
\index{Libraries List button}
\index{listing libraries}

The {\cb Libraries List} button in the {\cb File Menu} brings up the
{\cb Libraries} panel, which displays a listing of libraries found
along the present search path.  To speed the search, only files with a
``{\vt .lib}'' extension are checked for the library keyword at the
top of the file, so library files that do not have a ``{\vt .lib}''
extension will not appear in this list.  The first column in the
listing contains an icon which indicates whether the library is open
or closed.

Open libraries are searched to resolve cells when a layout file is
being read.  Closed libraries are ignored.  A library is opened if it
is ever listed in a content window from the {\cb Path Files Listing}
panel, or if a cell from that library is ever directly opened, such as
by giving ``/{\it path\/}/{\it library} {\it cellname}'' to the {\cb
Open} command in the {\cb File Menu}, or if opened with the {\cb
Open/Close} button (see below).

Libraries are an important component of the {\Xic} cell resolution
capability.  Immediately after an archive file has been read into the
main database, the new hierarchy is traversed to identify cells that
are referenced in the hierarchy but were not defined in the file. 
First, the open libraries are searched, and if an unresolved cell name
matches a name in a library, the cell is read into memory through the
library.  The library file itself is usually only an indirection
mechanism, with the actual cells saved in another archive file, or as
native cell files, though it is also possible to define inline cells
in the library file.

If a cell is not resolved in the open libraries, then the search path
is traversed for a native cell file that matches the cell name.  If
one is found, it is read into memory.  If not found, the unresolved
cell becomes an empty cell, and will otherwise behave normally in the
database.  A warning will be issued in the log file when a cell is
found to be unresolved.

The library mechanism is also available when a Cell Hierarchy Digest
(CHD) is used for file access.  If the archive file source for the CHD
contained unresolved references, the CHD will likewise have unresolved
references.  These cells can be resolved when reading with the CHD if
they match an open library reference to a cell in an archive file. 
Presently, native and inlined cells can not resolve CHD references,
except when reading into the main database.

By default, a cell that can't be resolved through a library is not an
error, it will be handled appropriately.  Processing will continue,
with the non-references either being ignored (e.g., when flattening),
or converted to empty cells (when reading into the database), or
propagated to output (when writing output), depending on the
operation.

However, if the {\cb Fail on Unresolved} button in the {\cb Cell
Hierarchy Digests} pop-up, or equivalently the {\cb
ChdFailOnUnresolved} variable is set, an unresolved cell will halt the
operation with a fatal error.

When reading a library cell into memory, the hierarchy under the cell
will also be read, unless the subcell name already exists in memory in
which case that subcell will not be read.

Cells read through the library mechanism have two internal attribute
flags set, which affect their behavior.  First, the LIBRARY flag will,
by default, prevent the cell from being written when a hierarchy
containing the cell is written to an archive file.  This means that
the file will not be self-contained, and will require the presence of
the (open) library to completely resolve all cells.  Second, the
IMMUTABLE flag is set, which prevents a cell from being modified or
renamed.  Thus, library cells by default can not be edited when opened
in this manner.

The flags can be switched on and off for any cell with the {\cb Set
Cell Flags} panel from the {\cb Flags} button in the {\cb Cells
Listing} panel.

Libraries are listed and searched in the order opened, and shown in
the listing.  When resolving a reference, the first match will apply,
superseding any later entries.  The libraries can be selected by
clicking on the entries.  When a library is selected, the {\cb
Open/Close} and {\cb Contents} buttons become enabled, which will act
on the selection.  The selection has no other purpose.

The {\cb Open/Close} button toggles the open state of the selected
library.  The {\cb Open/Close} button is active when a library is
selected in the {\cb Libraries} panel.  Without a selection, the
button is grayed.  Clicking the open/closed folder icon in the
selected row will have the same effect as pressing the button. 
Closing a library merely removes it from the search list, and any
cells in memory from the library remain.

The {\cb Contents} button is also activated when a library is selected
in the {\cb Libraries} panel.  Pressing {\cb Contents} will pop up a
listing of the contents of the selected library.  The entries can be
cells, archives, or other libraries.  The contents items can be
selected by clicking on the names.  When a selection is active, the
{\cb Open} and {\cb Place} buttons become active.  The {\cb Open}
button will load the selected cell into the main window.  The {\cb
Place} button will pop up the {\cb Cell Placement Control} panel,
loaded with the selected cell, with which the cell can be
instantiated.  If the selected item is another library or an archive
file, an intermediate ambiguity resolution pop-up will appear, and the
user must select a cell to edit or place.

The above is manifestly true only if the referenced cell is in an
archive file.  A native cell will always be superseded by an inlined
cell of the same reference name found earlier in the library search. 
Also, the {\et NoReadExclusive} and {\et AddToBack} variables will
affect cell name resolution as in a normal open.

The {\cb No Overwrite Lib Cells} button tracks the state of the {\et
NoOverwriteLibCells} variable.  By default, cells in memory that were
read from a library can be overwritten by cells of the same name
subsequently read into memory from an archive or native cell file.  If
this button is set, library cells (with the LIBRARY flag set) in
memory will not be overwritten.

The contents listing is a drag source for drag/drop.  Names from the
list can be dropped into a drawing window, with an effect similar to
using the {\cb Open} button.

When {\Xic} is in CHD display mode, i.e., the {\cb Display} button in
the {\cb Cell Hierarchy Digests} panel is active, the {\cb Open} and
{\cb Place} buttons in the contents window are not available.  The
{\cb Place} button is not available in the {\Xiv} feature set.


%\ifoa
% -----------------------------------------------------------------------------
% xic:oalib 030416
\section{The {\cb OpenAccess Libs} Button:  List OpenAccess Libraries}
\label{oalibs}
\index{OpenAccess Libs button}
\index{listing libraries}
\index{OpenAccess libraries}

The {\cb OpenAccess Libs} button will appear in the {\cb File Menu}
only if the OpenAccess plug-in has been loaded, in which case there is
a connection to an OpenAccess database on the current computer. 
Pressing the {\cb OpenAccess Libs} button brings up the {\cb
OpenAccess Libraries} panel.  The release number of the OpenAccess
database software in use is shown in the panel above the listing of
available libraries.  The listing displays the names of libraries
specified in the OpenAccess {\vt lib.defs} or {\vt cds.lib} file.

Similar to the {\cb Libraries List} panel, the first column in the
listing contains an icon which indicates whether the library is open
or closed.  The comments in that description apply to OpenAccess (OA)
cells opened in this manner as well.  However, it is possible to list
the content of OA libraries whether or not they are open.  Regular
libraries must be open for the contents to be listed.

Open libraries are searched to resolve cells when a layout file is
being read into {\Xic}.  Closed libraries are ignored in this case. 
However, direct references to an OA library from an OA cell are always
``open''.  The open and closed status is toggled by the {\cb
Open/Close} button in the panel, which acts on the entry which has
been selected by clicking on it.

The {\cb Open/Close} button toggles the open state of the selected OA
library.  The {\cb Open/Close} button is active when a library is
selected in the {\cb OpenAccess Libraries} panel.  Without a
selection, the button is grayed.  Clicking the open/closed folder icon
in the selected row will have the same effect as pressing the button. 
Closing a library merely removes it from the search list, and any
cells in memory from the library remain.

The second column in the listing indicates whether or not the library
is writable from {\Xic}.  By default, libraries created in {\Xic} are
writable from {\Xic}, other libraries are not.  This prevents, for
example, Virtuoso cells from being overwritten from {\Xic}, which
could cause loss of data (putting it mildly).  The writability of the
currently-selected library can be toggled with the {\cb Writable Y/N}
button.  Clicking on the {\cb Y} or {\cb N} in the selected line will
toggle the state, as if the button was pressed.  Library writability
can also be set with the {\cb !oabrand} command.

The {\cb Contents} button is also activated when a library is selected
in the {\cb OpenAccess Libraries} panel.  Pressing {\cb Contents} will
pop up a listing of the cells in the selected OA library.  The
contents items can be selected by clicking on the names.  When a
selection is active, the {\cb Open} and {\cb Place} buttons become
active.  The {\cb Open} button will load the selected cell into the
main window.  The {\cb Place} button will pop up the {\cb Cell
Placement Control} panel, loaded with the selected cell, with which
the cell can be instantiated.

One can specify whether to read and write physical or electrical data
from OpenAccess, or both, with the {\cb Data to use from OA} radio
button group.  These buttons track the {\et OaUseOnly} variable.  If
this variable is set to ``1'' or any word starting with ``p'' or
``P'', only physical data will be converted.  If set to ``2'' or any
word starting with ``e'' or ``E'', only electrical data (schematic and
symbol) will be converted.  If set to anything else or not set, both
physical and electrical data will be converted.

The restriction applies to conversion to and from OpenAccess, by any
method in {\Xic}.

When a cell is read into {\Xic} from OA, the OA ``layout'' view is
read as the physical cell data, the ``schematic'' view is read as the
schematic data, and the ``symbol'' view is read as the symbolic
representation.  These need not all exist.  The same view names apply
when writing data to OpenAccess.

These view names are the defaults, as used by Cadence Virtuoso. 
However, any of the {\et OaDefLayoutView}, {\et OaDefSchematicView},
and {\et OaDefSymbolView} variables can be defined to provide
alternate default view names.

When reading electrical info into {\Xic}, a simulator-specific view is
used for obtaining CDF (component data, from Virtuoso) parameters and
properties.  By default, this view is named ``{\vt HspiceD}'', but
another view can be chosen by setting the variable {\et
OaDefDevPropView}.  The default choice provides compatibility with
Hspice, and therefor {\WRspice} in fair measure.  If is not an error
if no {\vt HspiceD} views are found.

These four variables have corresponding entry areas in the {\cb
OpenAccess Defaults} panel brought up with the {\cb Defaults} button. 
The text of the variables and entry areas track one another.

The contents listing is a drag source for drag/drop.  Names from the
list can be dropped into a drawing window, with an effect similar to
using the {\cb Open} button.

When OpenAccess if available, the {\cb Open} command and similar, when
prompting for the name of a file or cell to load, will recognize an
OpenAccess library name followed by a cell name (two space-separated
words).

When {\Xic} is in CHD display mode, i.e., the {\cb Display} button in
the {\cb Cell Hierarchy Digests} panel is active, the {\cb Open} and
{\cb Place} buttons in the contents window are not available.  The
{\cb Place} button is not available in the {\Xiv} feature set.

The {\cb Create} button allows a new library to be created.  When
pressed, a pop-up appears, requesting a name for the library, which
can be any name allowed by OpenAccess.  Pressing the {\cb Create}
button in the pop-up will create the library, and its name will appear
in the listing.  The new library has write permission from {\Xic}.  It
will attach the default technology if set, otherwise there is no
technology associated with the new library, the user will probably
need to use the {\cb Tech} button to either create a local tech
database in the library, or link to the tech database in another
library.  New libraries can also be created with the {\cb !oanewlib}
command.

The {\cb Tech} button, which is un-grayed when a library is selected,
brings up the {\cb OpenAccess Tech} panel described in \ref{oatech}. 
This panel allows control of the technology database associated with
the library.  The {\cb !oatech} command can also be used to set the
technology database.

The {\cb Defaults} button displays the {\cb OpenAccess Defaults} panel
described in \ref{oadefs}, from which some parameters used by the
OpenAccess interface can be defined.

The {\cb Destroy} button is un-grayed when a library is selected. 
When pressed, and after confirmation, the selected library and all of
its content will be destroyed.  Presently, the library is removed from
the {\vt lib.defs} file, but not otherwise touched.  To reclaim the
disk space used by the library, the user can manually delete the
corresponding directory.  The {\cb !oadelete} command can also be used
to delete libraries, and to delete cells in libraries.
%\fi

%\ifoa
% ----------------
% xic:oatech 041415
\section{The {\cb OpenAccess Tech} Panel}
\label{oatech}

The {\cb OpenAccess Tech} panel is brought up with the {\cb Tech}
button in the {\cb OpenAccess Libraries} panel.  This panel is only
available when an OpenAccess database is being accessed with the
plug-in, in which case the {\cb OpenAccess Libs} button appears in the
{\cb File Menu}.

In OpenAccess, every library is generally required to have an
associated technology database.  The technology database contains
information about layers, physical attributes, design constraints,
etc., similar to the {\Xic} technology file.  The database can either
be ``attached'' or ``local''.  When attached, it references the
technology database from another library.  If local, the library
contains its own private technology database, to which other libraries
can attach.  This panel controls the technology database for the
library initially selected in the {\cb OpenAccess Libraries} panel.

The settings indicate the current status of the library.  The top line
contains buttons and an entry area that control attached technology. 
In libraries containing user cells, it is most common that an
attachment is used, typically to a library supplied by the foundry in
a process design kit.  In a typical situation, an organization may
make use of a single foundry process for several users and projects. 
It is likely then that all of the user/project libraries attach to the
one foundry library.  In this case, the {\cb Default Tech Library} in
the {\cb OpenAccess Defaults} panel or equivalently the <a {\et
OaDefTechLibrary} variable can be set to the name of the foundry
library.  Then, new libraries will automatically attach this library,
and the user will never have to use the {\cb OpenAccess Tech} panel.

If a database is currently attached.  the {\cb Unattach} button will
be un-grayed, and the name of the attached library will appear in the
status area, just above the {\cb Dismiss} button.  Pressing {\cb
Unattach} will (you guessed it) unattach the referenced database, and
the {\cb Unattach} button will become grayed.  One can reattach, or
attach the technology from a different library, by entering the name
of the target library and pressing the {\cb Attach} button.  The {\cb
Default} button will enter the default tech library name (if any) or
the previous attachment name (if any) into the text entry area when
pressed, and the entry area is not grayed.

If there is no attachment, then the {\cb Create new Tech} button will
be un-grayed, along with the {\cb Attach} button.  Pressing {\cb
Create New Tech} will create a new local technology database.  The
{\cb Attach} button will be grayed, as it is not possible to have an
attached database if a local database is present.  The {\cb Destroy
Tech} button becomes un-grayed, and will destroy the local database
when pressed.

The {\cb !oatech} command can perform may of the same operations.
%\fi


%\ifoa
% ----------------
% xic:oadefs 022216
\section{The {\cb OpenAccess Defaults} Panel}
\label{oadefs}

The {\cb OpenAccess Defaults} panel is brought up with the {\cb
Defaults} button in the {\cb OpenAccess Libraries} panel.  This panel
is only available when an OpenAccess database is being accessed with
the plug-in, in which case the {\cb OpenAccess Libs} button appears in
the {\cb File Menu}.

Each of the entry areas tracks a variable that is used to set default
behavior in the interface to the OpenAccess database.

\begin{description}
\item{\cb Library Path}\\
This entry tracks the setting of the {\et OaLibraryPath} variable.  It
can be set to a full path to a directory.  If a library to be accessed
is not listed in the {\vt lib.defs} (or {\vt cds.lib}) file, the
system will look for the library as a subdirectory of the directory
path given.  This allows use of OpenAccess libraries that are hidden
from other tools.

\item{\cb Default Library}\\
This tracks the setting of the {\et OaDefLibrary} variable.  It can be
set to a library name found in the {\vt lib.defs} (or {\vt cds.lib})
file, or to a subdirectory of the {\cb Library Path} if any.  This
will be used when reading from or writing to the OpenAccess database,
if the library name is not otherwise specified.

\item{\cb Default Tech Library}\\
This tracks the setting of the {\cb OaDefTechLibrary} variable.  It
can be set to a library name found in the {\vt lib.defs} (or {\vt
cds.lib}) file, or to a subdirectory of the {\cb Library Path} if any. 
When a library is created, it will attach the technology database
associated with the library name entered, if any.  If the named
library has an attached technology, the same attachment will be
applied to the new library.  Otherwise, the new library will attach
the local technology database of the named library.

\item{\cb Default Layout View}\\
This tracks the setting of the {\et OaDefLayoutView} variable.  It
specifies an alternate view name for physical layout data.  If not
specified, the default layout view name is ``{\vt layout}''.

\item{\cb Default Schematic View}\\
This tracks the setting of the {\et OaDefSchematicView} variable.  It
specifies an alternate view name for electrical schematic data.  If
not specified, the default schematic view name is ``{\vt schematic}''.

\item{\cb Default Symbol View}\\
This tracks the setting of the {\et OaDefSymbolView} variable.  It
specifies an alternate view name for electrical symbol data.  If not
specified, the default symbol view name is ``{\vt symbol}''. 

\item{\cb Default Properties View}\\
This tracks the setting of the {\et OaDefDevPropView} variable.  It
specifies an alternate view name for the simulator-specific view which
(if present) provides values for certain device properties (from the
Common Design Framework (CDF) database).  If not specified, the
default simulator view name is ``{\vt HspiceD}''.  This specifies
Hspice compatibility in Virtuoso, which is a good match for
{\WRspice}.

\item{\cb Dump CDF files while reading}\\
This check box tracks the set/unset status of the {\et OaDumpCdfFiles}
variable.  When checked, when a parameterized cell is opened in
OpenAccess, the Common Design Framework (CDF) data for the cell will
be dumped to a file in the current directory.  The file name is the
cell name with a ``{\vt .cdf}'' extension.  This is for
development/debugging.
\end{description}
%\fi


% -----------------------------------------------------------------------------
% xic:quit 061608
\section{The {\cb Quit} Button: Exit {\Xic}}
\index{Quit button}
\index{exiting Xic}

Pressing the {\cb Quit} button in the {\cb File Menu} will exit
{\Xic}, after confirmation is there is unsaved work.

If there are modified cells, the pop-up described for the {\cb Save}
command appears.  This displays a list of the cells and hierarchies
that have been modified, and allows the user to save them.

