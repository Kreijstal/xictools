 -----------------------------------------------------------------------------
% Xic Manual
% (C) Copyright 2009, Whiteley Research Inc., Sunnyvale CA
% $Id: cnvrtmenu.tex,v 1.77 2017/03/22 07:29:56 stevew Exp $
% -----------------------------------------------------------------------------

% -----------------------------------------------------------------------------
% xic:cnvrt 102208
\chapter{The Convert Menu:  Data Input/Output, Format Conversion}
\index{Convert Menu}
\index{conversion, file format}
In addition to the native cell-per-file format, {\Xic} has
interoperability with the archive file formats listed below.  These
file types can be read into {\Xic} directly with the {\cb Open}
command, and generated with the {\cb Save As} command.  The {\cb
Convert Menu} provides for setting format-specific conversion
parameters, and contains other conversion commands.

Under Unix/Linux, files are opened in 64-bit offset mode.  This
enables files larger than 2Gb to be processed.

Native {\Xic} cells use a CIF-like ASCII format, with one cell per
file.  This is the default format used by {\Xic}, but is not
particularly efficient with respect to input/output speed and disk
space.

% -----------------------------------------------------------------------------
% xic:fsaf 021912
In addition to the native cell-per-file format, {\Xic} supports a
number of archive formats, which can contain one or more cell
descriptions.

\begin{description}
\item{GDSII}\\
The GDSII (Stream) format is an industry-standard binary file format
for cell hierarchies and libraries.  {\Xic} can read Format Release
3--7 files, and write either Format Release 7 or Format Release 3
(which is readable on systems supporting Format Release 3--7).  GDSII
files that have been compressed with the GNU {\vt gzip} program or
equivalent can be read directly, and similarly compressed GDSII output
can be generated by {\Xic}.

The GDSII directives absolute magnification, absolute angle, and
absolute path width are not supported in {\Xic}.  If found in input,
the values are taken as relative, and a warning is issued.  These are
not supported by other file formats in a portable way, and should be
considered obsolete.

\item{CGX}\\
The CGX (Computer Graphics eXchange) format is a public-domain binary
archive format developed by Whiteley Research Inc.  Similar in
structure to GDSII, the advantages are more efficient data
representation for reduced file size and ease of parsing for faster
read/write.  Although presently available only in Whiteley Research
products, it is anticipated that the format will eventually be
supported by other vendors.  CGX files that have been compressed with
the GNU {\vt gzip} program or equivalent can be read directly, and
similarly compressed CGX output can be generated by {\Xic}.

\item{OASIS}\\
The Open Artwork System Interchange Standard (OASIS) is a new standard
for mask layout data being developed by the SEMI organization.  This
is a binary format which features more compact representation and thus
smaller files than GDSII.

More information is available from {\vt wrcad.com/oasis}.

The present status of OASIS support in {\Xic} is complete:
\begin{enumerate}
\item{{\Xic} can read any spec-conforming OASIS file.}
\item{OASIS output from {\Xic} is readable by any other
spec-conforming tool.}
\item{Exceptions to the above are {\cb bugs}, please report!}
\end{enumerate}

Although it is ``not documented'', {\Xic} can directly read OASIS
files that have been compressed with the {\vt gzip} program or
equivalent.  Unlike for GDSII files, this is not really supported,
and it is not possible to write gzipped OASIS output from {\Xic}.  It
is preferable to use the compression provided in the OASIS format.

% 111513
\item{CIF}\\
The CIF format, though a bit archaic, is still popular.  {\Xic}
supports a number of selectable dialects and extensions.

If the input file is in CIF format, and symbol (cell) names are not
provided (i.e., no symbol name extension is found), the generated
symbol names will be ``{\vt Symbol}{\it N}'', where {\it N} is the
integer symbol number given in the CIF file.
\end{description}

{\bf In general, files produced with this {\Xic} release are NOT
compatible with pre-{\Xic}-4.0 releases.}

The native cell files and CIF now accept and generate arbitrarily long
layer names.  These are not compatible with traditional CIF, or with
older {\Xic} releases.  Older {\Xic} releases will fail to read native
cell files, or CIF files, with non-traditional layer names. 
Traditional CIF layer names contain four characters or fewer.

Native cell files and CIF files from the 4.0 branch that use
traditional CIF layer names should be backward compatible in this
respect.

There is a new syntax used for electrical {\et node} property strings. 
This will, in general, prevent backwards compatibility of schematic
files.  If the {\et Out32nodes} variable is set, files written will
use the old node syntax, with loss of some data that is not supported
by the older syntax, but files will be readable by older {\Xic}
programs.

% -----------------------------------------------------------------------------
% xic:cvrtmenu 022916
The {\cb Convert Menu} entry brings up a menu containing commands
which perform explicit translations and other manipulations and
diagnostics.

The table below lists the commands found in the {\cb Convert Menu},
and gives the internal name and a brief description.

\hspace*{-1.5em}
\begin{tabular}{|l|l|l|l|} \hline
\multicolumn{4}{|c|}{\kb Convert Menu}\\ \hline
\kb Label & \kb Name & \kb Pop-up & \kb Function\\ \hline\hline
\et Export Cell Data & \vt exprt & \cb Export Control &
  Create a cell data file\\ \hline
\et Import Cell Data & \vt imprt & \cb Import Control &
  Read a cell data file\\ \hline
\et Format Conversion & \vt convt & \cb Format Conversion & Direct file-to-file
  format conversions\\ \hline
\et Assemble Layout & \vt assem & \cb Layout File Merge Tool &
  Merge layout data\\ \hline
\et Compare Layouts & \vt diff & \cb Compare Layouts &
  Find differences between layouts\\ \hline
\et Cut and Export & \vt cut & \cb Export Control &
  Write out part of a layout\\ \hline
\et Text Editor & \vt txted & \cb Text Editor & Text edit cell file\\ \hline
\end{tabular}

The {\cb Open} command in the {\cb File} menu can be used directly to
read files in the supported formats for editing.  When a cell is
written to disk, it is by default written in the format of origin,
though a format change can be coerced in the {\cb Save As} command by
supplying a file extension.  Thus, there are alternatives to using
many of the commands in the {\cb Convert Menu}.

During a conversion, a log file is written by the converters.  This
file contains a record of messages emitted during the conversion.  If
during a conversion an error or warning message is emitted, a file
browsing window containing the log file will appear when the
conversion is complete, though this can be suppressed by setting the
{\et NoPopUpLog} variable.  These messages also appear on the prompt
line during the conversion.  The file browser is a read-only version
of the text editor window, and has a number of associated keyboard
commands, including word searching.  See \ref{textedit} for a listing
of these commands.

On GDSII and OASIS input, if there is no specified mapping for a given
layer and datatype, an attempt is made to map to the existing {\Xic}
layers, and if that fails, a new layer is created.

When reading CIF, layer names are matched to those defined in the
current technology in a case-insensitive mode.  This differs from
native and CGX file types, which use case-sensitive matching.  Layers
found in the file which do not match any in the technology are
created, using default parameters.

% -----------------------------------------------------------------------------
% xic:cvrtmenu 022n16
\newpage
\section{Feature Availability Table}

\label{features}
The rather complicated table below describes how various features
apply to the input and output generation panels and functions.

\begin{tabular}{|l|l|l|l|l|} \hline
\kb Operation From & \kb Scaling & \kb Layer Filter &
  \kb Cell Name Mapping & \kb Windowing\\ \hline\hline
\multicolumn{5}{|c|}{\kb Windows}\\ \hline
\cb Export Control      & W &   & w C,F,P   & o F,W,C\\ \hline
\cb Import Control      & R & Y & r A,C,F,P & \\ \hline
\cb Format Conversion   & C & Y & r C,F,P & c W,C,F,E\\ \hline
\cb Open Cell Hierarchy & R &   & r C,F,P & \\ \hline
create CGD              & C & Y & r C,F,P & c W,C,F,E\\ \hline
{\cb Open}/{\cb Place}/drag-drop
                        &   &   &         & \\ \hline
\multicolumn{5}{|c|}{\kb Script Functions}\\ \hline
\multicolumn{5}{|c|}{Current Cell}\\ \hline
\vt Edit                &   &   &         & \\ \hline
\vt OpenCell            & R & Y & r A,C,F,P & \\ \hline
\vt Save                &   &   &         & \\ \hline
\multicolumn{5}{|c|}{Layout File Format Conversion}\\ \hline
\vt FromArchive         & C & Y & r C,F,P & c W,C,F,E\\ \hline
\vt FromNative          & C & Y & r C,F,P & \\ \hline
\multicolumn{5}{|c|}{Export Layout File}\\ \hline
\vt SaveCellAsNative    &   &   &         & \\ \hline
\vt Export              & W &   & w C,F,P & o F,W,C\\ \hline
\vt ToXIC               & W &   & w C,F,P & o F,W,C\\ \hline
\vt ToCG                & W &   & w C,F,P & o F,W,C\\ \hline
\vt ToCIF               & W &   & w C,F,P & o F,W,C\\ \hline
\vt ToGDS               & W &   & w C,F,P & o F,W,C\\ \hline
\vt ToGdsLibrary        & W &   & w C,F,P & o F\\ \hline
\vt ToOASIS             & W &   & w C,F,P & o F,W,C\\ \hline
\vt ToTxt               &   &   &         & \\ \hline
\multicolumn{5}{|c|}{Cell Hierarchy Digest}\\ \hline
\vt OpenCellHierDigest  &   &   & r C,F,P & \\ \hline
\vt ChdLoadGeometry     &   & Y &         & \\ \hline
\vt ChdEdit             & s & Y &         & \\ \hline
\vt ChdOpenFlat         & s & Y &         & w,c\\ \hline
\vt ChdWrite            & s & Y &         & w,c,f,e\\ \hline
\vt ChdWriteSplit       &   & Y &         & \\ \hline
\multicolumn{5}{|c|}{Assembly Stream}\\ \hline
\vt StreamSource        &   & Y & r C,P   & \\ \hline
\multicolumn{5}{|c|}{Trapezoid Lists and Layer Expressions}\\ \hline
\vt ChdGetZlist         & s & Y &         & w,c\\ \hline
\multicolumn{5}{|c|}{Polymorphic Flat Database}\\ \hline
\vt ChdOpenOdb          & s & Y &         & w,c\\ \hline
\vt ChdOpenZdb          & s & Y &         & w,c\\ \hline
\vt ChdOpenZbdb         & s & Y &         & w\\ \hline
\end{tabular}

Notes:
\begin{enumerate}
\item{There are three internal global scale factor registers, which
are set in the various windows and with the {\vt SetConvertScale}
script function.  One scale (R) is for reading, another (W) is for
writing, and the third (C) is for format conversion.  This indicator
is shown in the {\kb Scaling} column.  The lower case `s' applies to
script functions that take a local scale value.}

\item{The layer filtering and aliasing module is a group of controls
that appear in the {\cb Format Conversion} panel and elsewhere.  These
maintain the values in the {\et LayerList} variable and related.  A
`Y' in the {\kb Layer Filter} column appears where layer filtering can
apply.}

\item{The {\cb Cell Name Mapping} module is a group of controls that
allow cell name aliasing, case changing, etc.  This module appears in
the {\cb Format Conversion} panel and elsewhere.  The state for this
module tracks two sets of variables, similar to {\it InToLower} and
{\it OutToLower}, depending on whether the panel is controlling input
or output.  The code letters in the {\cb Cell Name Mapping} are:

\begin{tabular}{ll}
r or w & Reading or writing variables.\\
A      & The auto-aliasing feature for cell name clashes is available.\\
C      & Case conversion is available.\\
F      & Alias files can be used.\\
P      & A prefix and/or suffix can be added to cell names.\\
\end{tabular} }

\item{The {\cb Format Conversion} panel and others contain a windowing
module, containing controls for entering a rectangle, plus {\cb Use
Window}, {\cb Clip}, {\cb Flatten}, and empty cell filtering buttons. 
Internally, there are two global register sets for the state of these
controls, one for output and one for format conversion (windowing is
never used for input).  The {\vt SetConvertFlags} and {\vt
SetConvertArea} functions can also be used to set the flag states and
the windowing area.

The codes in the {\kb Windowing} column are:

\begin{tabular}{ll}
c or o & Conversion or output values.\\
W      & Windowing is available.\\
C      & Clipping to the window is possible.\\
F      & Flattening is available.\\
E      & Empty cell filtering is available.\\
\end{tabular}

If flattening (F) is listed first, the other options are only
available when flattening.  The option letters are listed in lower
case for script functions that take local values as arguments.}
\end{enumerate}


% -----------------------------------------------------------------------------
% cellname 022916
\section{Cell Name Mapping}
\label{cellname}
\index{cell name mapping}
\index{conversion, file format!cell names}

Releases of {\Xic} prior to 3.0.5 allowed white space in cell names. 
However, some {\Xic} features, such as selection of cell names in the
{\cb Cells Listing} panel will not work with cell names containing
white space, and there are probably many other examples.  Most basic
operations will work, though the cell name containing white space will
have to be quoted when given in the prompt area and elsewhere.  The
use of white space in cell names can lead to trouble and is
discouraged.

In the present release, by default, white space is not permitted in
cell names.  When reading archive files, the cell name alias mechanism
(described below) is used to convert white space characters found in
cell names to underscore characters.  Attempts to open a new cell with
a name containing white space will fail.  However, white space is
allowed, as in older {\Xic} releases, if the {\et NoStrictCellnames}
variable is set.

There is provision for modifying cell names as archive files are read,
written, or format converted.  The {\cb Import Control}, {\cb Export
Control}, and {\cb Format Conversion} panels available from the {\cb
Convert Menu} each contain a cell name mapping module for controlling
modification of cell names during their respective operations.  This
module contains the following controls:

\begin{description}
\item{{\cb Auto-Rename}}\\
This is a choice in the {\cb Default when new cells conflict} menu in
the {\cb Setup} page of the {\cb Import Control} panel.  Selecting
this item sets the state of the {\et AutoRename} variable.  When set,
cell names that clash with the name of a cell in memory encountered
when an archive file is being read into memory will be changed to
avoid a clash.

This will apply to files read with the {\cb 102208} command and
equivalent, in addition to files opened from the panels and through
script functions.

\item{{\cb Prefix} and {\cb Suffix} text entries}\\
Text entered into these text areas will be added as a prefix or suffix
to cells encountered when reading an archive file.  A limited text
substitution mechanism is available.  In the {\cb Format Conversion}
and {\cb Import Control} panels, these text areas track the {\et
InCellNamePrefix} and {\et InCellNameSuffix} variables.  In the {\cb
Export Control} panel, these text areas track the {\et
OutCellNamePrefix} and {\et OutCellNameSuffix} variables.

This will apply to files read with the panels and through
script functions only.

\item{{\cb To Lower} and {\cb To Upper} check boxes}\\
If set, {\cb To Lower} will convert upper case cell names to lower
case, and {\cb To Upper} will convert lower case cell names to upper. 
Mixed case cell names are not affected.  Case conversion is performed
before any applied prefix/suffix.  In the {\cb Import Control} and
{\cb Format Conversion} panels, these buttons track the state of the
{\et InToLower} and {\et InToUpper} variables.  In the {\cb Export
Control} panel, these buttons track the state of the {\et OutToLower}
and {\et OutToUpper} variables.

This will apply to files read with the panels and through
script functions only.

\item{{\cb Read Alias} and {\cb Write Alias} check boxes}\\
These buttons control whether an alias file (see next section) is read
before a file is processed, and updated after processing is complete. 
In the {\cb Import Control} and {\cb Format Conversion} panels, the
buttons track the {\et InUseAlias} variable, and in the {\cb Export
Control} panel, the buttons track the {\et OutUseAlias} variable. 
Aliasing from the alias file is applied before any other name change.

This will apply to files read with the panels and through
script functions only.

\item{GDSII conformance}\\
When writing GDSII files, cell names will be forced to conform to the
GDSII specification.  For format level 3, this limits the cell name
length to 32 characters.  The character set is limited to
alpha-numerics plus `{\vt ?}', `{\vt \_}', and `{\vt \$}'.  This
action is automatic when writing GDSII files and can not be disabled.

\item{Device Library name clashes}\\
When reading any of the archive formats into memory, if a cell name is
encountered which clashes with a library device name, that cell name
is modified.  A warning message is added to the conversion log file
indicating the change.
\end{description}


% -----------------------------------------------------------------------------
% aliasfile 060108
\section{Cell Name Alias File}
\label{aliasfile}
\index{alias file}
\index{cell name alias file}
\index{conversion, file format!alias file}
When reading and writing archive files, an alias file may be used or
created.  This file controls the renaming of cells between {\Xic} and
the archive file.  Use of the alias file is optional, and by default
is neither created or used.

The {\et InUseAlias} variable, if set (with the {\cb !set} command or
equivalent buttons), enables utilization of the alias file when
reading from an archive.  Similarly, the {\et OutUseAlias} variable
enables utilization of the alias file when writing to an archive. 
These variables have corresponding buttons in the panels found in the
{\cb Convert Menu}.

If the variable is simply set as a boolean, i.e., to no value, the
alias file will be read before a read or write operation, and created
or updated if necessary after the operation completes.  If the
variable is set to a word starting with `{\vt r}' (case insensitive),
then the alias file will be read before the operation and used during
the operation (if it exists), but will not be created or updated after
the operation completes.  If the variable is set to a word starting
with `{\vt w}' or `{\vt s}' (case insensitive), the alias file will
not be read before an operation, but will be created or updated after
the operation completes.

If enabled, after a read/write operation on an archive file, an alias
file may be created, or updated if it already exists.  This file will
be created in the same directory as the archive file, where it must
remain in order to be found.  The name of the alias file is the same
as that of the archive file, with ``{\vt .gz}'' stripped (if present)
and ``{\vt .alias}'' appended.

The alias file consists of lines with two tokens:  the first token is
a cell name found in the archive file, and the second token is the
name of the cell as known to {\Xic}, which will be different from the
first token (i.e., cell names that are unchanged do not appear).  The
file will be used, if it exists and the operation is enabled, to
translate cell names to and from the archive format, as the file is
written or read.  The alias file will be written or updated, if
necessary and the operation is enabled, after an operation that reads
or writes an archive file.  No file is produced unless a name was
changed.

On reading or writing an archive file, a name will potentially change
if any of the cell name aliasing features are enabled.  This includes
enforcement of the GDSII standard for cell names when writing GDSII. 
Any name change will be indicated in the log file.  If a name changes,
the alias file will be updated, if updating is enabled.  The sense of
the substitutions from the alias file is reversed when reading vs. 
writing.

It is not an error if no alias file exists.

When the alias file utilization is enabled, one should be aware that
the alias file is controlling cell naming when converting to and from
that file, since occasionally this can lead to confusion.  The values
in the alias file have precedence over other directives, such as case
changes.  For example, suppose that an archive file is created with
case mapping applied.  This will produce an alias file, if updating is
enabled.  If the case conversion is then turned off, and the write
operation repeated to the same file name with alias file reading
enabled, the cell names will {\it still} be case-converted, due to
the alias file.  Similarly, when reading the archive file produced,
the cell names will be back-converted by the alias file.  If the
translations are no longer wanted, the switches controlling alias file
usage should be turned off, or the alias file deleted.

Note that it is possible for the user to hand edit the alias file to
produce an arbitrary cell name mapping.  For example, it might be used
to convert all cell names in a design to nondescriptive random strings
before sending a design file to another site, to mask the function of
the circuitry.


% -----------------------------------------------------------------------------
% layername 032017
\section{Layer Names}
\label{layername}
\index{layer names}

{\Xic} follows the Virtuoso/OpenAccess concept of component layers,
purposes, and layer-purpose pairs.  Component layers are represented
by a name and a number, and are abstract.  Likewise, purposes are an
abstraction represented by a name and a number.  An actual {\Xic}
layer, which appears in the layer table, is a layer-purpose pair.

Every {\Xic} layer has a component layer name and purpose.  The name
of an {\Xic} layer is given or printed in the form
\begin{quote}
{\it component\_layer\/}[{\vt :}{\it purpose\/}]
\end{quote}
If the purpose name is ``{\vt drawing}'', then it is not printed or
given explicitly.  Otherwise, the purpose is separated from the
component layer name by a colon (`{\vt :}') character.  Note that when
the purpose is {\vt drawing}, the {\Xic} layer name is simply the
component layer name, so if the only purpose used is {\vt drawing},
the distinction between component and {\Xic} layer names vanishes.

Example {\Xic} layer names:
\begin{quote}
{\vt m1}\\
{\vt m1:pin}
\end{quote}
The first name corresponds to component layer name {\vt m1}
and purpose {\vt drawing}.  The second example uses a purpose
named ``{\vt pin}''.

In {\Xic}, layer names of both types, and purpose names, are always
recognized and treated without case-sensitivity.  There is no limit on
the length of these names.  Component layer and purpose names can
contain alphanumeric characters plus dollar sign (`{\vt \$}') and
underscore (`{\vt \_}').

All of the component layer and purpose names also have corresponding
numbers.  These may be assigned by the user, or assigned internally by
{\Xic}.  {\Xic} will maintain the associations, but the numbers are
not used by {\Xic}.  They are, however, important for compatibility
with other tools such as Virtuoso.

All {\Xic} layers may be given an alias name.  The layer will be
recognized by this name, as well as its normal name.  {\Xic} layers
may also contain a description string, presentation attributes such as
color and fill pattern, and a host of other flags and properties for
use within {\Xic}.

When working with GDSII and other files that use a numeric
layer/datatype combination to designate layers, the layer/datatype
combinations can be mapped into arbitrary {\Xic} layers using the
mapping constructs described in \ref{gdslayer}.  If no such mapping is
found, a default name will be used.  The default name strings apply to
{\Xic} layers that use the default {\vt drawing} purpose.

\index{hex format layer names}
When the layer and datatype numbers are in the range 0--255 the
default name string takes the form of a four-byte upper case
hexadecimal integer.  The two left characters indicate the layer
number, zero padded.  Similarly, the two right characters represent
the datatype number.  For example, layer 33, datatype 15 has the name
``{\vt 210F}''.

{\Xic} supports layer and datatype numbers in the range 0--65535. 
Although values larger than 255 are outside of the GDSII
specification, they are compatible with the GDSII file format and are
used as extensions in some vendor's products.  To represent the case
where either value is larger than 255, an eight digit hex number is
used.  This is analogous to the four character encoding, but each
field uses four characters.

\index{decimal format layer names}
When providing a layer name of this type to {\Xic}, an alternate
``decimal'' form can be used.  This is ``{\it layer\/},{\it
datatype\/}'' where the two integers are separated by a comma (no
space).  Thus, ``{\vt 33,15}'' is an equivalent way to specify the
layer name for the example above.  This is a convenience for entering
layer names into the input fields of files and graphical windows of
{\Xic}.  Internally, the layer name is always stored as the hex name.

In some cases when working with layer/datatype combinations, one of
the two fields can be a wildcard.  In the hex format, the hex digits
of the appropriate field can be set to ``{\vt X}''.  In the decimal
representation, a single `$-$' replaces the appropriate digits.  For
example, ``{\vt 0FXX}'' and ``{\vt 15,$-$}'' equivalently specify
layer number 15 and any datatype number.


% -----------------------------------------------------------------------------
% layerchange 022916
\section{Layer Filtering and Aliasing}
\label{layerchange}
\index{layer filtering}
\index{layer aliasing}
The {\cb Import Control} and {\cb Format Conversion} panels have a
common module for layer operations.  There is provision for
controlling which layers from an input archive file are read.  The
default action is to read all layers contained in the archive file,
however this can be changed for physical data only with the {\cb Layer
list}, and the {\cb Layers Only} and {\cb Skip Layers} buttons. 
Layers can be mapped to other layer names with the layer alias list,
when enabled by the {\cb Use Layer Alias} button.  The layer alias
list can be edited with a pop-up editor.

The module contains the following controls:
\begin{description}
\item{{\cb Layer List} text area}\\
The {\cb Layer List} can be set to a space-separated list of layer
names.  Each layer name is expected to match an effective layer name
in the file being read.  For file types such as GDSII that designate
layers with layer/datatype integers, either the hex encoding or
decimal form can be used, with wildcarding accepted.  This text area
tracks the value of the {\et LayerList} variable.

\item{{\cb Layers Only} check box}\\
If this box is checked, only the layers listed in the {\cb Layer List}
will be read.  The button tracks the state of the {\et UseLayerList}
variable.

\item{{\cb Skip Layers} check box}\\
This box can be checked if the {\cb Layers Only} box is unchecked, and
this also tracks the status of the {\cb UseLayerList} variable.  When
checked, layers listed in the {\cb Layer List} will be ignored in
input.

\item{{\cb Use Layer Aliases} check box}\\
When set, the current layer alias list will be applied to layers
found in the file.  This button tracks the state of the {\et
UseLayerAlias} variable.  The layer alias list tracks the value of
the {\et LayerAlias} variable.  Aliases are applied before the
{\cb Layer List} tests.

\item{{\cb Edit Layer Aliases} button}\\
This button brings up a panel for editing the layer alias list.  This
amounts to setting or modifying the value of the {\et Layer Alias}
variable.

The panel contains a listing of two columns:  the left column for
layer names, and the right column for the alias.  There are three
drop-down menus:  {\cb File}, {\cb Edit}, and {\cb Help}.

The {\cb File} menu contains entries for saving the layer alias list
to a disk file, and for reading in the entries from a disk file.

The {\cb Edit} menu contains entries to add, delete, and edit
individual aliases, and to select listing layer names in ``decimal''
form.

A row in the listing can be selected by clicking on it.  The selected
entry is acted on by the {\cb Delete} and {\cb Edit} commands.

The {\cb New} command brings up a text input pop-up to solicit a name
and alias pair (separated by space and/or an equal sign).  Both
entries must be valid layer names or encodings.  Either entry can use
the decimal or hex notation, or can be a CIF name, as appropriate for
the type of file.

If the {\cb Decimal Form} menu item is checked, the listing will use
the decimal form for layer/datatype entries.  Otherwise, the hex form
will be displayed.
\end{description}


% -----------------------------------------------------------------------------
% gdslayer 022716
\section{GDSII Layer Mapping}
\label{gdslayer}
\index{GDSII layer mapping}

The GDSII file format does not use layer names.  Instead, geometry
can exist on a numbered layer and datatype.  Typically, the layer
number and datatype can be in the range 0--255, or 0--63 for some
older versions of the GDSII specification.  Here, the combination
of a GDSII layer number and datatype is referred to as a
``specification''.

Although the GDSII file format documentation, which is maintained by
Cadence Design Systems, Inc., specifies the 0--255 range for the
current GDSII release, the file format uses 16-bit integers to store
these values, and other vendors support layer and datatype numbers
outside of this range.  {\Xic} release 2.5.67 and later can
semi-transparently handle layer and datatype values in the range
0--65535.

Although this section refers to the GDSII file format, the same
mapping logic applies when reading OASIS and CGX files, when a
layer/datatype are given.

When reading a GDSII file, {\Xic} will attempt to map specifications
encountered into existing {\Xic} layers.  If that fails, a new {\Xic}
layer will be created.  The GDSII mapping for {\Xic} layers is
generally assigned in the technology file using the {\et StreamIn}
keyword (for reading) and {\et StreamOut} (for writing), or can be
specified with the {\cb Tech Parameter Editor} from the {\cb Edit Tech
Params} button in the {\cb Attributes Menu}.  This is the primary
means by which GDSII specifications are interpreted as {\Xic} layers,
but this requires {\it a-priori} knowledge of the content of the GDSII
file.

This section describes the process {\Xic} uses to map an
unknown specification encountered when reading GDSII input, where
``unknown'' means that no suitable mapping exists in the
{\et StreamIn} lines of the present {\Xic} layers.

{\Xic} will first try to identify an existing {\Xic} layer to map to
the unknown specification.  The first test is to look for an {\it
output} mapping (as produced with a {\et StreamOut} line) that
matches.  If a match is found, an {\it input} mapping will be created. 
The behavior depends on the setting of the {\et NoMapDatatypes}
variable, which reflects the state of the {\cb Map all unmapped GDSII
datatypes to same Xic layer} check box in the {\cb Setup} page of the
{\cb Import Control} panel from the {\cb Convert Menu}.  When this
variable is set (directly with the {\cb !set} command, or by the
button), the datatype will be ignored.  The following pseudo-code
illustrates the logic:

\begin{verbatim}
loop through existing Xic layers {
  if Xic layer has no GDSII input mapping {
    if Xic layer output mapping = GDSII layer {
      if NoMapDatatypes set
        (use this layer)
      else if output mapping datatype = GDSII datatype
        (use this layer)
    }
  }
}
\end{verbatim}

Each layer/datatype specification has an equivalent hex code.  If the
layer and datatype are less than 256, the hex code is of the form
{\it LLDD}, where the {\it L\/}s are hex digits, zero-padded, which
represent the layer number, and the {\it D\/}s similarly represent the
datatype.  If either number is larger than 255, the format is {\it
LLLLDDDD}, which has the same interpretation, e.g., the {\it L\/}s are
a four-digit zero-padded hex integer representing the layer number. 
If the {\et NoMapDatatypes} variable is in effect, the datatype field
(the {\it D\/}s) can instead be filled with `{\vt X}' characters.

The hex values are produced in upper case, but matching is case
insensitive.

If no suitable output mapping is found, {\Xic} will look for layer
names or long names which match the hex encoding.  If a layer is found
with a name or long name matching (case-insensitive) the hex code for
the specification, and that layer has no input mapping, an input
mapping will be created.  The following pseudo-code illustrates the
logic:

\begin{verbatim}
if NoMapDatatypes set {
  if layer and datatype less than 256
    hex_code = hhXX
  else
    hex_code = hhhhXXXX
}
else {
  if layer and datatype less than 256
    hex_code = hhhh
  else
    hex_code = hhhhhhhh
}
loop through existing Xic layers {
  if Xic layer name or long name matches hex_code
    (use this layer)
}
\end{verbatim}

If no existing layer is found that can be mapped to, a new layer will
be created.  If the hex code is four characters, the name of the new
layer is the same as the hex code.  If the hex code is eight
characters, the new name is an internally-generated unique
four-character name, and the long name is assigned the hex code.  The
layer name in this case is in the form ``{\it L???}'' where {\it ???}
is a sequential decimal zero-padded integer, starting with ``{\vt
000}''.  This mapping is also used in the four-character hex code
case, if the hex code conflicts with an existing layer name.

After the GDSII file has been read, newly created layers will appear
in the layer menu (they are added above existing layers).  The user
can modify colors, fill patterns, and other attributes for these
layers, and dump a new technology file with the {\cb Save Tech}
command.


% -----------------------------------------------------------------------------
% xic:exprt 040724
\section{The {\cb Export Cell Data} Button: {\cb Export Control} Panel}
\index{Export Cell Data button}

The {\cb Export Cell Data} button in the {\cb Convert Menu} brings up
the {\cb Export Control} panel.  The top of the panel contains tabbed
pages for {\cb GDSII}, {\cb OASIS}, {\cb CIF}, {\cb CGX}, and {\cb Xic
cell files}.  This selects the current output format, and exposes
controls and settings particular to the format.  The lower part of the
panel has two pages.  The {\cb Setup} page allows setting of various
format-independent parameters and modes which are used globally when
writing layout files.  The {\cb Write File} page provides a button
with which export of cell data to a disk file can be initiated, as
well as settings which apply during the write operation.

Below are descriptions of the controls in the file format pages
selected by the upper tabs.  Clicking the tab exposes the page
containing controls appropriate for the format.  The parameters set
with this panel always apply when writing layout files of the types
indicated.  In particular, the settings apply when the commands in the
{\cb File Menu} are used to save design data, as well as when the {\cb
Write File} button in this panel is used.

\subsection{GDSII Settings}

\begin{description}
\index{GDSII version number setting}
\item{\cb GDSII version number, polygon/wire vertex limit}\\
This option menu effectively sets the {\et GdsOutLevel} variable. 
This determines the release number given in the GDSII file, and also
sets limits on the number of vertices allowed in polygon and wire
objects included in the file.  If an object in the database has too
many vertices, it will be written to the file as multiple objects,
which cover the same area.  The default is GDSII format release 7,
which allows up to 8000 polygon or path vertices.  It may be necessary
to use one of the format release 3 choices if the file is to be read
by older software.

\index{Skip layers button}
\item{\cb Skip layers without Xic to GDSII layer mapping}\\
When this button is active, layers without a GDSII output mapping will
be ignored when producing GDSII or OASIS output, though a warning will
appear in the log file.  Otherwise, this is an error which terminates
the operation.

This mode can also be enabled by setting the boolean variable {\et
NoGdsMapOk} with the {\cb !set} command.

GDSII files can be gzip compressed.  Such files are recognized
automatically on input, and can be coerced as output by giving a
``{\vt .gz}'' suffix to the file name.

\item{\cb Accept but truncate too-long strings}\\
The GDSII and CGX formats use a 16-bit integer to store record size,
limiting the size of records to 64KB.  This prevents storage of stings
longer than this.  By default, an attempt to write such a string to a
GDSII or CGX file will generate a fatal error, aborting the operation. 
If this check box is set, overrunning strings will be truncated to
maximum possible length, and the operation will continue without
error.  Warnings will appear in the log file, however.

The check box tracks the state of the {\cb GdsTruncateLongStrings}
variable.

\item{\cb Unit Scale}\\
This entry area contains a value that will multiply the default values
of the ``machine unit'' and ``user unit'' parameters
which are used in the GDSII file, and all coordinates in the file will
be divided by this value.  The default values for these parameters
are
\begin{quote}
\begin{tabular}{ll}
machine unit: & 1e-6/{\it resolution}\\
user unit: & 1.0/{\it resolution}\\
\end{tabular}
\end{quote}
where {\it resolution} is the internal resolution, which defaults to
1000 per-micron, but can be changed with the {\et DatabaseResolution}
variable.  It is not likely that the user will need to set this, and
unless the user understands the implications it is recommended that
the default value (1.0) be used.  This entry area is an interface to
the {\et GdsMunit} variable.

\end{description}

\subsection{OASIS Settings}

\begin{description}
\item{\cb Advanced}\\
This button brings up the {\cb Advanced OASIS Export Parameters}
panel, which allows modification of the more obscure features employed
when writing OASIS output (see \ref{oasadv}).

\item{\cb Skip layers without Xic to GDSII layer mapping}\\
This is equivalent to the corresponding button on the GDSII page.

\item{\cb Use compression}\\
When active, created OASIS files will use compression.  The contents
of each CELL record and name table will be placed in a CBLOCK record,
which should reduce file size.  When not active, no compression will
be used.

This mode can also be enabled by setting the boolean variable {\et
OasWriteCompressed} with the {\cb !set} command.

\item{\cb Use string tables}\\
When active, all strings including cell names, properties, and labels
are saved in indirection tables.  Throughout the file, strings will be
referenced by number.  This should reduce file size.  When not active,
each string will be saved locally for each reference.

This mode can also be enabled by setting the boolean variable {\et
OasWriteNameTab} with the {\cb !set} command.

\item{\cb Find repetitions}\\
When active, an attempt is made to identify identical objects that are
placed in multiple locations, and use REPETITION records in OASIS
output instead of writing multiple object records.  This should reduce
file size, but can be compute-intensive.  When not active, no attempt
is made to use REPETITION records, except for cell arrays.

See the description of the {\et OasWriteRep} variable (in
\ref{OasWriteRep}), which controls the use of REPETITION records in
OASIS output.  The {\cb Advanced OASIS Export Parameters} panel
contains an interface for effectively setting the {\et OasWriteRep}
variable string.  The {\cb Find repetitions} button will set this
variable to the current string, or unset the variable.  With the
default parameters, the string is empty.

\item{\cb Write crc checksum}\\
When active, a cyclic-redundancy (CRC) checksum is added to OASIS
output files (OASIS validation method 1).  When not active, no
checksum is added.

See the description of the {\et OasWriteChecksum} variable (in
\ref{OasWriteChecksum}), which controls the validation method in OASIS
output.  This variable can be set explicitly to use byte-sum checksum
validation (OASIS validation method 2).  The check box sets/unsets
this variable as a boolean.
\end{description}

\subsection{CIF Settings}
\label{cifsettings}

\begin{description}
\item{\cb Extension Flags}\\
This drop-down menu provides access to a number of checkable buttons
which correspond to flags which enable various CIF format extensions. 
There are two banks of flags, the bank displayed is initially
determined by the state of the {\cb Strip For Export} button in the
{\cb Export Control} panel, or equivalently the state of the {\et
StripForExport} variable.  The top entry of the menu indicates this
state.  Clicking this entry will switch the menu to display and
control the other bank of flags.  The default values for the flags in
the {\cb Strip For Export} inactive case are all set, so all
extensions are turned on.  The other bank has all flags unset, so by
default no extensions will be used when {\et Strip For Export} is set. 
However, the status of any of the flags can be toggled with this menu.

The flag states track the value of the {\et CifOutExtensions}
variable.

The format extensions enabled by these flags are described in
\ref{cifext}, CIF Format Extensions.
\end{description}

The lower section of the CIF page contains three option menus which
control aspects of the syntax used when writing CIF files.  The three
selectable variations are the syntax used for the cell name extension,
the interpretation of the ``{\vt L} {\it layer\/}{\vt ;}'' syntax
element, and the syntax used for the label extension.  {\Xic} can
handle almost transparently any of these syntax variations, however
third-party applications may require a specific variation.

The selections shown in the menus tracks the value encoded in the {\et
CifOutStyle} variable.  When this variable is unset, the defaults (the
first choice in each menu) are used.

\begin{description}
\item{\cb Last Seen}\\
When a CIF file is read into memory, the style of the CIF file is
saved internally.  Pressing the {\cb Last Seen} button will update the
three style menus to these saved values, by setting or clearing the
{\et CifOutStyle} variable.

\item{\cb CIF Cell Name Extensions}\\
Cell names were not part of the original CIF syntax specification. 
Various extensions have been used to supply cell names in a CIF file. 
Each of these extensions consists of command following the ``{\vt DS
...;}'' command, in the following forms:

\begin{tabular}{lll}
\kb cname\_index & \kb Historic Name & \kb Format\\
0 & IGS          & {\vt 9} {\it cell\_name};\\
1 & Stanford/NCA & ({\it cell\_name});\\
2 & Icarus       & ({\vt 9} {\it cell\_name});\\
3 & Sif          & ({\vt Name:} {\it cell\_name});\\
4 & none         & no extension used\\
\end{tabular}

In {\Xic}, any of the first four forms (indices 0--3) will be
recognized equivalently when reading CIF input.

\item{\cb CIF Layer Specification}\\
Layers are specified in CIF in a command with syntax
\begin{quote}
{\vt L} {\it token};
\end{quote}

The the {\it token} can be interpreted in two ways; as the name of a
layer, or as an index into a layer table.  For the second
interpretation, the token must of course be an integer.

\begin{tabular}{lll}
\kb layer\_index & \kb Historic Name & \kb Format\\
0 & none &  {\vt L} {\it layer\_name};\\
1 & NCA  &  {\vt L} {\it layer\_index};\\
\end{tabular}

Of these, the first entry is most common.  {\Xic} can handle both of
these interpretations (see \ref{cvimport}).

If the indexing is selected for layers, the index will be 1--based, and
correspond to the layers, left to right, in the layer table, i.e., the
leftmost (lowest) layer in the layer table is designated index 1.

\item{\cb CIF Label Extensions}\\
Text labels were not part of the original CIF syntax specification, so
that various extensions are used to pass label information.

\begin{tabular}{lll}
\kb label\_index & \kb Historic Name & \kb Format\\
0 & Xic & {\vt 94} {\vt <<}{\it label\/}{\vt >>} {\it x y orient\_code width height};\\
1 & KIC & {\vt 94} {\it label x y};\\
2 & NCA & {\vt 92} {\it label x y layer\_index};\\
3 & Mextra & {\vt 94} {\it label x y layer\_name};\\
4 & none  & no labels used\\
\end{tabular}

Unlike other extensions, the first extension listed above is unique to
{\Xic}.  If other formats are used, label size and orientation
information will be lost.  When reading CIF input, any of these forms
will be accepted.
\end{description}

\subsection{CGX Settings}

This page contains an {\cb Accept but truncate too-long strings} check
box, with purpose and functionality that is identical to the check box
in the {\cb GDSII} page.

CGX files can be gzip compressed.  Such files are recognized
automatically on input, and can be coerced as output by giving a
``{\vt .gz}'' suffix to the file name.

\subsection{The Setup Page}

The {\cb Setup} page contains a number of check boxes which control
various modes when writing output, as described below.

\begin{description}
\item{\cb Don't convert invisible layers}\\
\index{Don't convert invisible layers button}
\index{conversion, file format!layer suppression}
There are separate check boxes that apply to physical and electrical
modes.  When active, only layers that are currently visible, as
selected with button 2 in the layer table, will be written when
writing output using this panel.  This is the method by which certain
layers can be eliminated from generated output.  When this button
button is not active, all {\Xic} layers will be written.

This feature can also be enabled by setting the variable {\et
SkipInvisible} with the {\cb !set} command.

\item{\cb Strip For Export}\\
\index{StripForExport button}
\index{exporting designs!Strip For Export}
\index{compatibility!Strip For Export}
When the {\cb Strip For Export} button is active, converted output
will contain physical data only, and will contain no {\Xic}
extensions.  Further, the {\cb Strip For Export} check box implicitly
enables the same functionality as {\cb Include library cell masters} (see
below), so that the file will not contain unresolved library cell
references.  Additionally, parameterized cell and standard via
sub-masters will be included in output, as if the corresponding check
boxes were also checked.  The {\cb Strip For Export} box should be
checked when creating a file for use in generating photomasks.  Note
that the electrical information can never be recovered from a stripped
file.

This mode can also be enabled by setting the boolean variable {\et
StripForExport} with the {\cb !set} command.  The variable tracks the
state of the check box.

\item{\cb Include library cell masters}\\
If the input file references library cells (which have the LIBRARY
flag set) whose masters are not found in the file, then these masters
are not written to output unless this box is checked.  With the box
not checked, the output file will require the referenced library be
preesent and open when the file is read into {\Xic} (the same
requirement as the input file).  With the box checked, the masters are
written to the output file, which will therefor not need the library.

This tracks the state of the {\et KeepLibMasters} variable.

\item{\cb Include parameterized cell sub-masters}\\
When this check box is checked, output saved to disk files will
include sub-master cells.  Ordinarily, sub-master cells are not
included, as they will be re-created when the file is read.  However,
when exporting to a system that does not support the pcells in use,
the sub-masters must be written if the file is to have any value. 
With the sub-masters present, the cells/instances will look like
normal cell placements.

This applies when writing all output, {\bf except} when using the {\cb
Save} and {\cb Save As} buttons in the {\cb File Menu}, and the
equivalent text accelerators and including the prompts when exiting
the program.  It is also ignored when using the {\vt Save} script
function.

%\ifoa
{\Xic} native pcells are only supported in {\Xic}.  OpenAccess-based
pcells might be supported by other systems, that is certainly the
intent of the Ciranova PyCells.  Even if another system supports the
OpenAccess PyCells, it may not have the logic to rebuild the pcells
coming from a GDSII or other file source.  In that case one will
probably have to ship the OpenAccess library files.
%\fi

The {\et StripForExport} variable and the equivalent check box will
have the same effect when set.

The {\et PCellKeepSubMasters} variable tracks the state of this check
box.

\item{\cb Include standard via cell sub-masters}\\
When checked, standard via cell sub-masters are included in the output
file.  This will be required when sending output to another system, as
this implementation is specific to {\Xic}.
%\ifoa
An exception may be systems that share an OpenAccess database with
{\Xic}.  If the cells are written to the OpenAccess database, the
standard vias should translate properly, and be recognized by other
tools (e.g., Virtuoso) that share the database.
%\fi

This applies when writing all output, {\bf except} when using the {\cb
Save} and {\cb Save As} buttons in the {\cb File Menu}, and the
equivalent text accelerators and including the prompts when exiting
the program.  It is also ignored when using the {\vt Save} script
function.

The {\et StripForExport} variable and the equivalent check box will
have the same effect when set.

The {\et ViaKeepSubMasters} variable tracks the state of this check
box.

\item{\cb Consider ALL cells in current symbol table for output}\\
When checked, all cells in the current symbol table, not just the
hierarchy of the current cell, will be output as if they were part of
the hierarchy.  The usual filtering of library and sub-master cells is
retained.  The resulting file may have multiple top-level cells.
This mirrors the state of the {\vt OutAllCells} boolean varible.

\item{\cb Don't flatten standard vias, keep as instance at top level}\\
This mode may apply when flattening a physical cell hierarchy.  When
set, instances of standard vias are retained as such, rather than
being written as geometry.  This check box tracks the state of the
{\et NoFlattenStdVias} variable.

\item{\cb Don't flatten pcells, keep as instance at top level}\\
This mode may apply when flattening a physical cell hierarchy.  When
set, instances of parameterized cells (pcells) are retained as such,
rather than being written as geometry.  This check box tracks the
state of the {\et NoFlattenPCells} variable.

\item{\cb Ignore labels in subcells when flattening}\\
When flattening a cell hierarchy, if this check box is checked labels
found in subcells are ignored, meaning not reparented to the top
level.  Pre-existing labels at the top level are not affected.  This
is intended to prevent net name labels from subcells conflicting with
net name labels defined at higher hierarchy levels.  The check box
state tracks the {\et NoFlattenLabels} variable.

\item{\cb Keep bad output (for debugging)}\\
When generating an archive file and an error occurs, the archive file
will normally be deleted.  However, if this box is checked.  the
output file will be given a ``{\vt .BAD}'' extension and retained. 
This file should be considered corrupt, but may be useful for
diagnostics.  This tracks the {\et KeepBadArchive} variable.
\end{description}

\subsection{The Write File Page, Exporting Design Data}

The {\cb Write File} page is used to initiate writing of a design data
file to disk.  A number of options are available when writing a file
with this panel.  Unlike the settings described above, these settings
apply only to files created with this panel.

The currently selected tab at the top of the panel specifies the
output format to use.  Details of the format selections are described
below.

\begin{description}
\item{\cb GDSII}\\
This choice will create a GDSII (Stream) file of the current editing
cell and its descendents.  Upon pressing {\cb Write File}, the name of
the file for the GDSII output is requested from the user.  The user
can add a ``{\vt .gz}'' extension, or remove the extension if already
present, to control whether or not {\vt gzip} compression is used. 
The GDSII layer numbers and datatypes are as given in the technology
file.

\index{GDSII cell names}
{\Xic} will ensure that cell names included in the GDSII file
conform to the standard (upper and lower case, digits, `\_', `\$', `?'
only, up to 32 long in GDSII Release 3).

\index{NoGdsMapOk variable}
All layers that are to be written to the GDSII file should have a
GDSII output mapping specified.  This can be added to the technology
file with a text editor, or interactively with the {\cb Edit Tech
Params} button in the {\cb Attributes Menu}.  By default, a layer
needed for output that does not have a mapping will terminate the
operation.  However, if the {\cb Skip layers without Xic to GDSII
layer mapping} check box in the {\cb GDSII} page of the {\cb Export
Control} panel is checked, or equivalently the variable {\et
NoGdsMapOk} is set (with the {\cb !set} command), then such layers
will be ignored (producing no output).

\item{\cb OASIS}\\
This choice will create an OASIS file of the current editing cell and
its descendents.  Upon pressing {\cb Write File}, he name of the file
for the OASIS output is requested from the user.  The layer numbers
and datatypes are as given in the technology file.  These are the same
as for GDSII.

All layers that are to be written to the OASIS file should have a
GDSII output mapping specified.  This can be added to the technology
file with a text editor, or interactively with the {\cb Edit Tech
Params} button in the {\cb Attributes Menu}.  By default, a layer
needed for output that does not have a mapping will terminate the
operation.  However, if the {\cb Skip layers without Xic to GDSII
layer mapping} check box in the {\cb OASIS} page of the {\cb Export
Control} panel is checked, or equivalently the variable {\et
NoGdsMapOk} is set (with the {\cb !set} command), then such layers
will be ignored (producing no output).

\item{\cb CIF}\\
With this choice, the current editing cell and its descendents will be
written to a CIF file.  Upon pressing {\cb Write File}, the user is
prompted for the name of the file for CIF output.

The extension syntax used for cell name specification and labels, and
whether the layer directives use indexing or names, are settable with
the {\et CifOutStyle} variable and/or the {\cb CIF} page menus in the
{\cb Export Control} panel.

\item{\cb CGX}\\
With this choice, the current editing cell and its descendents will be
written to a CGX file.  Upon pressing {\cb Write File}, the user is
prompted for the name of the file for CGX output.  The user can add a
``{\vt .gz}'' extension, or remove the extension if already present,
to control whether or not {\vt gzip} compression is used.

\item{\cb Xic Cell Files}\\
This choice will unconditionally write to native-format files the
hierarchy of the current editing cell.  It can be used to transform a
hierarchy input from a supported archive format file into {\Xic}
native format.

When {\cb Write File} is pressed, the user is given the option of
setting the directory which will receive the created files.  If no
directory is given, the files will be created in the current
directory.  While the prompt is in effect, a pop-up containing a tree
listing of the directory hierarchy rooted in the current directory
appears.  The user can select a directory in the listing, or type the
directory path on the prompt line.  If a directory path is given and
the final directory does not exist, it will be created, if possible. 
Pressing {\kb Esc} will abort the operation.

After the cell writing is complete, a library file will be written in
the current directory, given the name of the top-level cell suffixed
with ``{\vt .lib}''.  This file will have references to each of the
new files created, with the top-level cell name listed first, and the
others listed in alphabetical order.  This library may be placed in
the search path to gain access to the new files through the library
mechanism, in which case the directory containing the files need not
be in the search path.
\end{description}

The following controls are found in the {\cb Write File} page.

\begin{description}
\item{\cb Cell Name Mapping}\\
This group of controls manages the cell name aliasing feature.  This
does not apply to native cell file output.

\item{\cb Windowing and Flattening}\\
A subset of the windowing operations is available.  From this panel,
windowing is only available when flattening.

\item{\cb Conversion Scale Factor}\\
The {\cb Conversion Scale Factor} provides an entry area where a scale
factor to be applied during the write operation can be entered. 
Values of 0.001 through 1000.0 are acceptable.  This will apply to
output initiated from this panel only.

\item{Write File}\\
The write is actually initiated with the {\cb Write File} button.  The
name of the output file will be prompted for on the prompt line.

Cell files can also be written to disk using the {\cb Save} and {\cb
Save As} commands in the {\cb File Menu}.  However, if scaling or
other options available in this panel are required, the file must be
generated from this panel.
\end{description}


% -----------------------------------------------------------------------------
% xic:oasadv 022816
\section{The {\cb Advanced OASIS Export Parameters} Panel: Set\newline
  OASIS Parameters}
\label{oasadv}
\index{Cell Table Listing panel}
The {\cb Advanced OASIS Export Parameters} panel is provided from the
{\cb Advanced} button in the {\cb OASIS} setup page of various panels,
including the {\cb Export Control} panel, the {\cb Format Conversion}
panel and the {\cb Layout File Merge Tool}, all from the {\cb Convert
Menu}.  It allows modification of the more arcane parameters used when
generating OASIS output.

\begin{description}
\item{\cb Don't write trapezoid records}\\
This check box sets and unsets the {\et OasWriteNoTrapezoids}
variable.  When set, no attempt is made to save three and four-sided
polygons in more compact trapezoid records.  Setting this variable
will likely increase file size but reduce writing time.

\item{\cb Convert Wire to Box records when possible}\\
This check box sets and unsets the {\et OasWriteWireToBox} variable. 
When set, single-segment Manhattan wires will be saved in more compact
rectangle records.  This may reduce file size, at the expense of
slightly longer writing time and loss of object type integrity.

\item{\cb Convert rounded-end Wire records to Poly records}\\
This check box sets and unsets the {\et OasWriteRndWireToPoly}
variable.  When set, rounded-end wires, which don't have native OASIS
support and are normally converted to extended-end (Manhattan
extension) wires, are instead converted to polygons.  The polygons
require more memory than the wires, but preserve exactly the geometric
coverage of the original layout, as rendered in {\Xic}.

\item{\cb Skip GCD check}\\
This check box sets and unsets the {\et OasWriteNoGCDcheck} variable. 
When set, the OASIS writer will not attempt to divide out a common
factor in vertex lists, which is done to reduce file size but can have
significant computational overhead.

\item{\cb Use alternate modal sort algorithm}\\
This check box sets and unsets the {\et OasWriteUseFastSort} variable. 
When set, an older, less effective sorting algorithm is used to
sequence objects in output to make use of modality.  Use of this
algorithm may reduce writing time but will potentially increase file
size.

\item{\cb Property masking}\\
This menu controls the {\et OasWritePrptyMask} variable, which can be
used to avoid writing certain, or all properties.  This can reduce
file size if properties are not needed.  The description of this
variable explains this feature in detail.
\end{description}

The remaining controls provide an interface for setting the text
string for the {\et OasWriteRep} variable, which is used to control
the repetition finder.  Use of the repetition finder is
enabled/disabled by the {\cb Find repetitions} check box in the {\cb
OASIS} page of the {\cb Export Control} panel.  The present panel sets
the parameters to use when the repetition finder is enabled.

The repetition finder is a system that will identify identical
objects, and attempt to identify periodic sequences of these objects
in one and two dimensions.  This can have a huge effect on file size,
at the expense of computational overhead.  The controls on this panel
can be used to fine-tune the algorithm for a particular data set,
producing, e.g., the smallest file, or reducing writing time.

The description of the {\et OasWroteRep} variable provides detailed
information about the parameters found in the property string, which
has the form:
\begin{quote}
    {\et OasWriteRep}: [{\it word\/}] [{\vt d}] [{\vt r}]
     [{\vt m}={\it N\/}] [{\vt a}={\it N\/}] [{\vt x}={\it N\/}]
     [{\vt t}={\it N\/}]
\end{quote}

The {\cb Restore Defaults} button will reset all controls to the
default values.  The {\cb Objects} check boxes control which object
types are processed for repetitions, as for the {\it word} in the
string.

The {\cb Run minimum} is the value passed for the {\vt m} option. 
Pressing the {\cb None} button on this line will instead give the {\vt
r} option, and gray out the run and array controls.  The {\cb Array
minimum} provides the value for the {\vt a} option.  The {\cb None}
button on this line will emit ``{\vt a=0}'' and disable the entry
area.  The {\cb Max different objects} line corresponds to the {\vt x}
option.  The {\cb Max similar objects} line corresponds to the {\vt t}
option.  If the {\cb None} button in this line is pressed, ``{\vt
t=0}'' will be emitted and the entry area is grayed.  Note that these
do not emit if the text area contains the default value.

To actually enable repetitions, the {\et OasWriteReps} variable must
be set.  This can be set by hand with the {\cb !set} command or
equivalent, in which case the controls above will take the values
found in the string.  Setting the {\cb Find repetitions} check box in
the {\cb OASIS} page of the {\cb Export Control} panel will also set
the variable, to a string created from the state of the controls. 
When the variable is set, the listing of set variables brought up with
the {\cb !set} command without arguments can ge used to monitor the
property string as the various controls are changed.


% -----------------------------------------------------------------------------
% xic:imprt 020918
\section{The {\cb Import Cell Data} Button: {\cb Import Control} Panel}
\index{Import Cell Data button}
\label{cvimport}

The {\cb Import Cell Data} button in the {\cb Convert Menu} brings
up the {\cb Import Control} panel.  The panel has two pages, the first
is used to set various parameters that apply globally when reading
design data into the {\Xic} internal database.  The second page
provides the means to initiate reading data from disk files into
{\Xic}.

\subsection{The {\cb Setup} Page}

This page contains a number of entries which control various defaults
and features that apply when reading data files.  These settings
always apply when reading, in particular during use of the commands in
the {\cb File Menu}, as well as through use of the {\cb Read File}
page of this panel.

\begin{description}
\item{\cb PCell evaluation:  Don't eval native}\\
Setting this check box will prevent evaluation of native pcells when
an instance is found while reading file input.  If an archive file
contains the sub-masters, it is more efficient to use them rather than
recreate them through evaluation.  Note that if sub-masters are not
provided, the super-masters for the pcells must be available.
 
This check box tracks the state of the {\et NoEvalNativePCells}
variable.
 
%\ifoa
\item{\cb PCell evaluation:  Eval OpenAccess}\\
Setting this check box will cause {\Xic} to attempt to evaluate
OpenAccess pcells when instances are encountered when reading file
input.  By default, this is not done, as evaluation is likely to fail,
and the exporter has probably included the sub-master cells in the
archive.

This check box tracks the state of the {\et EvalOaPCells} variable. 
%\fi

\item{\cb Don't create new layers when reading, abort instead}\\
By default, when reading an input file, layers are created if
necessary to match layers found in the file.  The new layers are
appended to the layer table.  If the source is GDSII or another format
such as OASIS that provides layer and datatype numbers, the new layer
name will be an encoding of these numbers (see \ref{gdslayer}).

If this box is checked, new layers will not be created, and
encountering a layer in input that is not mappable into an existing
{\Xic} layer will be treated as a fatal error.

The boolean {\et NoCreateLayer} variable tracks the state of the check
box.

\item{\cb Default when new cells conflict}\\
This menu determines the default behavior when a cell from a file
being read conflicts with the name of a cell already in memory.  There
are five choices:  {\cb Overwrite All}, {\cb Overwrite Phys}, {\cb
Overwrite Elec}, {\cb Overwrite None}, and {\cb Auto Rename}.  If {\cb
AutoRename} is selected, when a name clash with a cell in memory is
detected, the cell name of the cell being read is automatically
changed to avoid the clash.  A suffix ``{\vt \$}{\it N}'' is added to
the cell name, where {\it N} is a small integer, and a warning message
is added to the log file.  The {\cb Merge Control} pop-up will never
appear in this mode.  For the other four choices, in graphical mode,
when a conflict is detected, the {\cb Merge Control} pop-up will
appear, if enabled.  The initial state of the pop-up will be
determined by this menu, but the actions can be modified by the user
on a per-cell basis.  If the pop-up does not appear either because it
has been suppressed or the program is running in non-graphical (server
or batch) mode, the default action will be performed.

The default cell name conflict behavior can also be set with three
boolean variables:  {\et AutoRename}, {\et NoOverwritePhys} and {\et
NoOverwriteElec}.  If {\et AutoRename} is set (with the {\cb !set}
command or otherwise), the other two variables are ignored, and the
auto-rename mode is enabled.  If none of these variables is set, then
the default action is {\cb Overwrite All}.

When a cell is encountered while reading an archive file or native
cell into memory with the same name as a cell already in memory, and
we are overwriting cells in memory, the new cell will overwrite the
existing cell in memory in most cases.  The exception is for existing
cells that were read through the library mechanism.  These cells have
the IMMUTABLE (read-only) and LIBRARY flags set.
 
The IMMUTABLE flag has no bearing on whether or not a cell can be
overwritten in memory.  The overwritten cell will no longer be
IMMUTABLE.  In releases prior to 3.0.11, IMMUTABLE cells would not be
overwritten.

If the existing cell has the LIBRARY flag set, it will be overwritten,
unless the {\et NoOverwriteLibCells} variable is set.  A warning
message will be included in the log file in this case, but the read
will be successful, with the result being as if overwriting was not
enabled.  If overwritten, the cell will no longer have the LIBRARY
flag set.  In releases prior to 3.0.11, LIBRARY cells would always be
overwritten, unless IMMUTABLE was also set, which is the default for
library cells.

\item{\cb Don't prompt for overwrite instructions}\\
In graphical mode, when a cell name clash with a cell already in
memory is detected while reading a file, the {\cb Merge Control}
pop-up may appear.  This can be used to change whether or not to
overwrite the cell in memory on a per-cell and per-mode basis.  When
this button is active, the {\cb Merge Control} pop-up will not appear,
and the overwriting will use the default setting.

This state can also be enabled by setting the boolean variable {\et
NoAskOverwrite} with the {\cb !set} command.

\item{\cb Clip and merge overlapping boxes}\\
When this button is on, boxes on the same layer are merged together,
if possible, as files are being read into the database.  Overlapping
boxes are clipped and/or merged.  This applies to box objects only,
and not polygons (even rectangular ones) or wires, and applies only
for physical mode data.  Electrical mode boxes are never merged.  This
tracks the setting of the boolean variable {\et MergeInput}, which can
(equivalently) be set with the {\cb !set} command.

This mode applies when reading input from a layout file, and is
separate and unrelated to the object merging as controlled from the
{\cb Editing Setup} panel from the {\cb Edit Menu}.  These settings
have no effect when reading layout data.

However, on layers where the {\vt NoMerge} technology file keyword is
set, box (or any object) merging is inhibited, in all cases.

\item{\cb Skip testing for badly formed polygons}\\
When set, the reentrancy test for polygons is skipped while an input
file is being read into the database.  The default behavior is to
check each polygon for potentially troublesome geometry specification
while the polygon is being created.

This mode can also be enabled by setting the boolean variable {\et
NoPolyCheck} with the {\cb !set} command.

\item{\cb Duplicate item handling}\\
When reading data from a layout file, identical objects and subcells
placed on top of one another are sometimes found.  Although these
generally cause no harm, this is almost always a layout error.  This
menu provides three choices of how to handle the situation.  The
default action is to print a warning in the log file, but import the
duplicate objects into the database.  The {\cb Remove Duplicates}
choice will also issue a warning, but will not add the duplicates to
the database.  The third choice suppresses checking for duplicates
entirely.

This menu tracks the status of the {\et DupCheckMode} variable.

\item{\cb Skip testing for empty cells}\\
When set, there is no checking for empty cells as an input file is
being read into the database, and the pop-up that normally appears
when a file is opened for editing or viewing if there are empty cells
in the hierarchy is suppressed.  An ``empty cell'' actually means that
both physical and electrical cells of this name either don't exist in
the hierarchy, or contain nothing.  It is possible to check for empty
cells at any time with the {\cb !empties} command.

This mode can also be enabled by setting the boolean variable {\et
NoCheckEmpties} with the {\cb !set} command.

\item{\cb Map all unmapped GDSII datatypes to same Xic layer}\\
This setting affects only the creation of new layers when a GDSII or
OASIS file is read into the database.  The default behavior is to
create a separate new {\Xic} layer for each GDSII layer/datatype
encountered that is not mapped in the technology file.  With the
variable set, all datatypes on the new GDSII layer are mapped to the
same (new) {\Xic} layer.

This mode can also be enabled by setting the boolean variable {\et
NoMapDatatypes} with the {\cb !set} command.

\item{\cb How to resolve CIF layers}\\
This is an option menu which specifies how {\Xic} interprets layer
directives in CIF files.

The layer directive has the syntax
\begin{quote}
{\vt L} {\it token}{\vt ;}
\end{quote}

If the {\it token} is an integer, it might indicate the name of a
layer with the name being the same integer string, or it might be an
index into the layer table.  The choices in the menu enforce these two
behaviors.

The default resolution method ({\cb Try Both}) works as follows:  The
parser reads ``{\vt L} {\it token}{\vt ;}''.  If {\it token} matches
an existing layer name (as string comparison), that layer is accepted. 
If there is no matching layer, and the {\it token} is an integer in
the range of 1 through a maximum number, and there is no leading 0,
the token is tested as an index.  if a layer exists with that 1-based
index, that layer is chosen.  If the layer still has not been
resolved, a new layer is created in the layer table, with the given
(numerical) name.

The option menu gives two additional choices.  The {\cb By Name}
choice will skip the index test.  If the string match fails with all
existing layers, a new layer will be created.  If the {\cb By Index}
choice is selected, the layer tokens are assumed to be integers.  The
string match test is skipped.  If the index test fails, an error is
reported and the operation aborts.  New layers are never created in
this mode.  The layer tokens must be positive integers with no leading
zeros that have a corresponding layer table entry.

The {\et CifLayerMode} variable corresponds to this set of options,
where its value of 0--2 corresponds to the three choices.

\item{\cb Don't flatten standard vias, keep as instance at top level}\\
This mode may apply when flattening a physical cell hierarchy.  When
set, instances of standard vias are retained as such, rather than
being written as geometry.  This check box tracks the state of the
{\et NoFlattenStdVias} variable.

\item{\cb Don't flatten pcells, keep as instance at top level}\\
This mode may apply when flattening a physical cell hierarchy.  When
set, instances of parameterized cells (pcells) are retained as such,
rather than being written as geometry.  This check box tracks the
state of the {\et NoFlattenPCells} variable.

\item{\cb Ignore labels in subcells when flattening}\\
When flattening a cell hierarchy, if this check box is checked labels
found in subcells are ignored, meaning not placed in the current cell. 
Labels defined in the current cell are not affected.  This is intended
to prevent net name labels from subcells conflicting with net name
labels defined at higher hierarchy levels.  The check box state tracks
the {\et NoFlattenLabels} variable.

\item{\cb Skip reading text labels from physical archives}\\
When set, text labels will not be read from a layout file when reading
physical-mode data.  It is not generally advisable to use this, as
text labels, though not physical objects, should be assumed to be
present for a purpose.  However, this check box gives the user the
flexibility to strip these out.

In {\Xic}, text labels are included when the bounding box of a cell is
computed.  If a text label actually determines the boundary of a cell,
the bounding box of the cell may report differently from other tools. 
The effective size of a text label is not well defined, and other
tools will probably make different assumptions about font size, etc.,
or may not include text labels in bounding box computations.

The state of this check box tracks the status of the {\et
NoReadLabels} variable.
\end{description}

\subsection{The {\cb Read File} Page}

This page provides a button to initiate reading a design data file
into {\Xic}, and various controls which set modes which will apply
while reading.

\begin{description}
\item{\cb Merge Into Current mode}\\
This menu provides the option of merging the contents of another cell
into the current cell, possibly recursively.  Only the content
associated with the present display mode is affected, for example in
Electrical mode, only the electrical cells will be affected, the
physical cells are untouched.  Part of the motivation for this mode is
to facilitate separate development of electrical and physical designs,
allowing them to be merged at a later time.

If {\cb No Merge Into Current} is the current selection, then merging
is turned off.  Reading a cell of the same name as the current cell
can either overwrite the current cell or the new cell can be ignored,
depending on how name clashes are currently handled (as set in the
{\cb Setup} page of this panel).

If one of {\cb Merge Cell Into Current} or {\cb Merge Into Current
Recursively} is selected, and the {\cb Read File} button is pressed,
the following operations will be performed.  The user will be prompted
for a file name.  The user can respond with the name of a file, or the
name of a cell in memory.

If the user passes a cell name found in memory, the contents of that
cell will be duplicated and added to the current cell.  This completes
the command.  Note that there is no difference between the {\cb Merge
Cell Into Current} and {\cb Merge Into Current Recursively} modes in
this case.

If the file name is found on disk, the file will be opened in a
temporary symbol table.  If a cell is found in the temporary symbol
table that has the same name as the current cell, the contents of that
cell will be merged into the current cell.  Otherwise, the user will
be prompted for a cell name.  If the user enters a valid cell name,
the contents of that cell will be duplicated into the current cell. 
If the menu is set to {\cb Merge Cell Into Current}, the command is
done.  The temporary symbol table will be cleared.

If a recursive merge is selected, the hierarchy of the current cell is
traversed.  For each cell in the hierarchy, if a cell with the same
name exists in the temporary symbol table, the contents of that cell
will be duplicated into its counterpart under the current cell.  Care
is taken to handle the details of this recursive merge cleanly.

There is no undo capability for this command, so be sure to save a
copy of the current cell hierarchy before merging, in case of trouble.

\item{\cb Cell Name Mapping}\\
This group of controls manages the cell name aliasing feature.  The
{\cb Auto-Rename} button found here has the same functionality as the
{\cb Auto Rename} selection in the cell name resolution option menu. 
This applies only when reading archive input files, and not native
cell files.  The prefix/suffix modifications are applied only in input
initiated from this panel or script functions.

\item{\cb Layer Modification}\\
The layer change module allows layer filtering and/or mapping to be
applied during the read operation.  This applies when reading physical
data only.

\item{\cb Windowing and Flattening}\\
Windowing is available only when flattening.  When flattening, all
information read from a file is mapped intto the top-level cell in
memory.  Users should realize that flat representation can require
lots of memory.

\item{\cb Conversion Scale Factor}\\
The {\cb Conversion Scale Factor} provides an entry area where a scale
factor to be applied during reading can be entered.  Values of 0.001
through 1000.0 are acceptable.  This will apply to input initiated
from this panel only.

\item{\cb Read File}\\
The {\cb Read File} button will prompt the user for a file to read
into {\Xic}, in the manner of the {\cb Open} command.  However for
archive files scaling, layer filtering, etc.  may be applied to the
cells read from the file through use of this panel and not via the
{\cb Open} command.
\end{description}


% -----------------------------------------------------------------------------
% windowing 022916
\section{Windowing Control Module}
The windowing module is available in the {\cb Format Conversion} panel
and elsewhere, though not all features are available in some contexts. 
The module controls whether windowing and/or flattening is done when
layout data are being processed.

\subsubsection{Windowing}
\index{windowing}

The {\cb Use Window} button controls whether or not a rectangular area
is to be used.  If this button is set, only the objects that intersect
this area will appear in the output.  For subcells, only the objects
that appear within the window for some instance will be converted in
the corresponding cell.  The rectangular area can be set with the {\cb
Left}, {\cb Bottom}, {\cb Right}, and {\cb Top} entry areas.  These
are coordinates, in microns, in the coordinate system of the top-level
cell, {\it after} scaling is applied.  Only geometry that overlaps the
window area will be included in the file.  However, when viewing the
new file, geometry in subcells that also exist outside of the window
area will be visible, unless the hierarchy is flattened.

If the {\cb Clip to Window} button is active in addition to the {\cb
Use Window} button, objects will be clipped to the given window. 
Without clipping, the entire object is retained.  With clipping, the
objects will be clipped to the window given.  Again, unless the
hierarchy is also flattened, geometry in subcells that also exist
outside of the window will be displayed when viewing the new file.

When clipping, wires that require clipping are converted to polygons.

There are eight registers available for saving bounding-box
parameters.  With the {\cb S} (store) button, the current values in
the four text entry areas that define the rectangle can be saved in
one of the registers.  With the {\cb R} (recall) button, the saved
parameters can be retrieved into the text entry areas.  These
registers are shared with other pop-ups that used windowing.  The 0
register is used by the {\cb Cut and Export} command to save the
rectangle defined with the mouse, the other registers are not directly
used by any command.  The {\cb Cut and Export} command can be used as
a short-cut for entering rectangle data through user of register 0. 
Press {\cb Cut and Export} (in the {\cb Convert Menu}), drag in a
drawing window to define a rectangle, then press {\kb Esc} to abort
the command.  Then, recall register 0.

\subsubsection{Flattening}
\index{flattening}

If the {\cb Flatten Hierarchy} button is active, the output file will
be a flat representation, i.e., all geometry will appear in the
top-level cell, which will have no subcells.

\subsubsection{Empty Cell Filtering}
\index{empty cell filtering}
\label{ecfilt}

Occasionally it is important or desirable to remove empty cells from
output, particularly when layer filtering is employed.  Layer
filtering can produce large numbers of empty cells.  A large number of
empty cells will increase file size and may produce inefficiency in
downstream processing operations.  Thus, provision for removing empty
cells is available from the {\cb Empty Cell Filter} check box group.

Empty cell filtering is recursive, in that it eliminates empty cells,
and cells that contain only instances of empty cells.  There are two
empty cell filtering operations available.

\begin{enumerate}
\item{
The {\cb pre-filter} uses in-memory per-layer/per-cell
statistics gathered during Cell Hierarchy Digest (CHD) creation to
identify cells that should be excluded due to layer filtering.  This
has relatively low overhead.  The CHD in use must have been created
with {\cb per-cell and per-layer counts} specified, or this filtering
is skipped.  If a CHD is implicitly created in processing, i.e., the
user is not using a named CHD from the {\cb Cell Hierarchy Digests}
panel, then these counts will be saved automatically.

This filtering operation is performed entirely in memory and is
typically very fast.  However, it identifies only cells that are
made empty due to layer filtering. }

\item{
The {\cb post-filter} identifies empty cells by reading the source
layout file.  This can be rather time consuming, but applies whether
or not layer filtering is being used, and will identify all empty
cells. }
\end{enumerate}

The two check boxes separately enable each of these empty cell
filtering operations.  If one doesn't care about empty cells, neither
box should be checked.  If one is using layer filtering and just wants
a quick pass to remove cells made empty due to layer filtering, {\cb
pre-filter} should be checked.  If one wants to remove all empty
cells, both {\cb pre-filter} and {\cb post-filter} should be checked. 
This will generally provide the fastest operation.  If not using layer
filtering, this will be equivalent to checking {\cb post-filter} only. 
When using layer filtering, enabling both filters can be much faster
that using post-filtering only.


% -----------------------------------------------------------------------------
% xic:convt 022418
\section{The {\cb Format Conversion} Button: {\cb Format Conversion} Panel}
\index{Format Conversion button}
\index{Format Conversion}

The {\cb Format Conversion} button in the {\cb Convert Menu} brings up
the {\cb Format Conversion} panel, which is a front end to a number of
direct conversion functions which translate an input file into output
of another (or the same) format.  These are direct conversions, i.e.,
the data are converted directly and do not enter the main {\Xic}
database.  This means that there are relaxed memory limitations, so
almost arbitrarily large files can be translated.  It is also possible
to perform scaling, data windowing or clipping, and hierarchy
flattening while translating.

Conversions can also be performed by reading in a hierarchy and using
the explicit output conversion in the {\cb Export Control} panel.

\subsection{File Format Selection}

A drop-down menu at the top of the panel selects one of four
types of input:
\begin{description}
\item{\cb Layout File}\\
The source file is a normal layout file in one of the supported
archive formats.  The various input file formats are recognized
automatically.

\item{\cb Cell Hierarchy Digest Name}\\
Input will be read through a Cell Hierarchy Digest, as listed in the
{\cb Cell Hierarchy Digests} panel.

\item{\cb Cell Hierarchy Digest File}\\
Input will be read through a Cell Hierarchy Digest found in a file on
disk, as was generated from the {\cb Save} button in the {\cb Cell
Hierarchy Digests} panel.

\item{\cb Native Cell Directory File}\\
Input will consist of native cell files found in a given directory. 
All cells found in the directory that do not have a ``{\vt .bak}''
file extension or duplicate a device library name, regardless of any
hierarchical relationship or lack thereof, will be translated and
concatenated into an archive file.
\end{description}

When translating CIF files, or from native cell files using {\cb
Native Cell Directory}, four-character CIF-style layer names found in
the input must be mapped to layer and datatype numbers when output is
in GDSII or OASIS format.  If the layer exists in the layer table and
the GDSII {\vt StreamOut} parameter has been set, that mapping will be
used.  The {\vt StreamOut} parameter is normally set in the technology
file, but can also be set from the {\cb Tech Parameter Editor} from
the {\cb Edit Tech Params} button in the {\cb Attributes Menu}.  When
not mapped via an existing layer in the layer table, if the CIF layer
name is a four-digit hex number, it will be interpreted as ``LLDD'' to
obtain the GDSII layer and datatype numbers.  If not in this form, a
new layer number and datatype will be internally generated, using the
{\et UnknownGdsLayerBase} and {\et UnknownGdsDatatype} variables.

When using {\cb Native Cell Directory}, the directory can contain an
alias file (see \ref{aliasfile}) that can be used to map native cell
names to new names in the output.  This file must be named ``{\vt
aliases.alias}'', and is never generated by {\Xic}.  It must be
prepared by hand or some other means if needed.  Each line contains
the native cell name followed by the name to use in output, separated
by white space.  The {\cb Read Alias} check box in the {\cb Format
Conversion} panel, or (equivalently) the {\cb InUseAlias} variable
must be set in order for the alias file to have effect.

The output format is selected through the tabs arrayed below the {\cb
Input Source} buttons.  Each tab, when selected, displays a page that
may contain format-specific settings.  These pages are very similar to
corresponding pages in the {\cb Export Control} panel, and the
settings in the two panels track.  The {\cb Format Conversion} panel
provides some additional choices and options, however.  The
differences are described below.

\begin{description}
\item{\cb GDSII}\\
The output format is GDSII.  When the {\cb Input Source} is set to
{\cb Layout File}, this page contains an {\cb Input File Type} menu. 
This menu contains two choices:  {\cb archive} and {\cb gds-text}. 
The latter choice enables back-conversion to GDSII of the ASCII
representation previously generated from a GDSII file using the {\cb
ASCII Text} output format tab.  The {\cb archive} menu choice should
be selected when reading normal layout data.

The header of a GDSII file optionally contains information about
fonts, reference libraries, and other things.  This information is
saved in a file named ``{\vt gds\_header\_props}'' in the same
directory as the output files, when converting to native files only. 
The file is subsequently ignored by {\Xic}, as this information is not
used by {\Xic}.

\item{\cb OASIS}\\
The output format is OASIS.

\item{\cb CIF}\\
The output format is CIF.

\item{\cb CGX}\\
The output format is CGX.

When translating to CGX format, the multi-box capability of BOX
records in CGX is not used.  However, this feature is used when CGX
files are written from memory.  Thus, reading a hierarchy into {\Xic}
and writing out a CGX file will probably result in a smaller CGX file
than using the direct conversion.

\item{\cb XIC Cell Files}\\
The output will be written to a family of native-format cell files.

When the selected output format is {\cb Xic Cell Files}, the input
will be converted to a number of native cell files, one for each
cell defined in the input.  The same result can be obtained by reading
the input file into the database with the {\cb Open} command, and then
using the {\cb Export Control} panel to generate the {\Xic} files.

\item{\cb ASCII Text}\\
The output will be converted to an ASCII text representation of the
input file format, for GDSII, OASIS, and CGX input.  This may be
useful for debugging problematic layout files.  The ASCII text format
produced for GDSII can be back-converted to GDSII through use of the
{\cb gds-text} selection in the {\cb Input File Type} menu of the {\cb
GDSII} page.  The ASCII representation of OASIS files can be
back-converted to OASIS with tools available from Anuvad.  The two
check boxes that appear on this page apply when translating OASIS:

\begin{description}
\item{\cb OASIS text: print offsets}\\
This sets/unsets the state of the {\et OasPrintOffset} variable, and
when active the first token of each printed record contains the offset
in the file or containing CBLOCK record.  When not active, offsets are
not printed.

\item{\cb OASIS text: no line wrap}\\
This sets/unsets the state of the {\et OasPrintNoWrap} variable,
suppressing line breaking when active.  In this case, each record will
use a single (possibly very long) line.  When not set, lines are
broken and indented.
\end{description}
\end{description}

Note that the {\cb Input Source} choice will affect the availability
of output format tabs, in particular if other than {\cb Layout File}
is selected, the available tabs are {\cb GDSII}, {\cb OASIS}, {\cb
CIF}, {\cb CGX}.

Below the output format selection tabs, there are two tabs which alter
the lower half of the panel.  The {\cb Setup} page provides some
format-independent settings.  The {\cb Convert File} page provides the
button to actually start the process.

\subsection{The Setup Page}

This page contains a number of check boxes which apply during format
conversion.  These options are described below.

\begin{description}
\item{\cb Strip For Export}\\
When the {\cb Strip For Export} button is active, converted output
will contain physical data only, and all masters, and will contain no
{\Xic} extensions.  The {\cb Strip For Export} box should be checked
when creating an export file for use in generating photomasks.  Note
that the electrical information can never be recovered from a stripped
file.  The check box tracks the state of the {\et StripForExport}
variable.

This mode can also be enabled by setting the boolean variable {\et
StripForExport} with the {\cb !set} command.  The variable tracks the
state of the check box.

\item{\cb Include library cell masters}\\
If the input file references library cells (which have the LIBRARY
flag set) whose masters are not found in the file, then these masters
are not written to output unless this box is checked.  With the box
not checked, the output file will require the referenced library be
preesent and open when the file is read into {\Xic} (the same
requirement as the input file).  With the box checked, the masters are
written to the output file, which will therefor not need the library.

This tracks the state of the {\et KeepLibMasters} variable.

\item{\cb Include parameterized cell sub-masters}\\
When this check box is checked, output saved to disk files will
include sub-master cells.  Ordinarily, sub-master cells are not
included, as they will be re-created when the file is read.  However,
when exporting to a system that does not support the pcells in use,
the sub-masters must be written if the file is to have any value. 
With the sub-masters present, the cells/instances will look like
normal cell placements.

This applies when writing all output, {\bf except} when using the {\cb
Save} and {\cb Save As} buttons in the {\cb File Menu}, and the
equivalent text accelerators and including the prompts when exiting
the program.  It is also ignored when using the {\vt Save} script
function.

%\ifoa
{\Xic} native pcells are only supported in {\Xic}.  OpenAccess-based
pcells might be supported by other systems, that is certainly the
intent of the Ciranova PyCells.  Even if another system supports the
OpenAccess PyCells, it may not have the logic to rebuild the pcells
coming from a GDSII or other file source.  In that case one will
probably have to ship the OpenAccess library files.
%\fi

The {\et StripForExport} variable and the equivalent check box will
have the same effect when set.

The {\et PCellKeepSubMasters} variable tracks the state of this check
box.

\item{\cb Include standard via cell sub-masters}\\
When checked, standard via cell sub-masters are included in the output
file.  This will be required when sending output to another system, as
this implementation is specific to {\Xic}.
%\ifoa
An exception may be systems that share an OpenAccess database with
{\Xic}.  If the cells are written to the OpenAccess database, the
standard vias should translate properly, and be recognized by other
tools (e.g., Virtuoso) that share the database.
%\fi

This applies when writing all output, {\bf except} when using the {\cb
Save} and {\cb Save As} buttons in the {\cb File Menu}, and the
equivalent text accelerators and including the prompts when exiting
the program.  It is also ignored when using the {\vt Save} script
function.

The {\et StripForExport} variable and the equivalent check box will
have the same effect when set.

The {\et ViaKeepSubMasters} variable tracks the state of this check
box.

\item{\cb Don't flatten standard vias, keep as instance at top level}\\
This mode may apply when flattening a physical cell hierarchy.  When
set, instances of standard vias are retained as such, rather than
being written as geometry.  This check box tracks the state of the
{\et NoFlattenStdVias} variable.

\item{\cb Don't flatten pcells, keep as instance at top level}\\
This mode may apply when flattening a physical cell hierarchy.  When
set, instances of parameterized cells (pcells) are retained as such,
rather than being written as geometry.  This check box tracks the
state of the {\et NoFlattenPCells} variable.

\item{\cb Ignore labels in subcells when flattening}\\
When flattening a cell hierarchy, if this check box is checked labels
found in subcells are ignored, meaning not reparented to the top
level.  Pre-existing labels at the top level are not affected.  This
is intended to prevent net name labels from subcells conflicting with
net name labels defined at higher hierarchy levels.  The check box
state tracks the {\et NoFlattenLabels} variable.

\item{\cb Skip reading text labels from physical archives}\\
When set, text labels will not be read from a layout file when reading
physical-mode data.  It is not generally advisable to use this, as
text labels, though not physical objects, should be assumed to be
present for a purpose.  However, this check box gives the user the
flexibility to strip these out.  This check box tracks the status of
the {\et NoReadLabels} variable.

In {\Xic}, text labels are included when the bounding box of a cell is
computed.  If a text label actually determines the boundary of a cell,
the bounding box of the cell may report differently from other tools. 
The effective size of a text label is not well defined, and other
tools will probably make different assumptions about font size, etc.,
or may not include text labels in bounding box computations.

\item{\cb Keep bad output (for debugging)}\\
When generating an archive file and an error occurs.  the archive file
will normally be deleted.  However, if this box is checked, the output
file will be given a ``{\vt .BAD}'' extension and retained.  This file
should be considered corrupt, but may be useful for diagnostics.  This
tracks the state of the {\et KeepBadArchive} variable.
\end{description}

\subsection{The Convert File Page}

\begin{description}
\item{\cb Layer Modification}\\
The layer change module allows layer filtering and/or mapping to be
applied during the conversion operation.

\item{\cb Cell Name Mapping}\\
The {\cb Cell Name Mapping} group of controls manages the cell
name aliasing feature.

\item{\cb Windowing and Flattening}\\
The windowing and flattening group can be used to set up area
filtering or hierarchy flattening.  These may not all be available for
every input/output format permutation.  For example, the windowing
operations are not available when the input format is {\cb Native Cell
Directory}.

If windowing, flattening, or empty cell filtering is set, only
physical data are converted, i.e., there will be no electrical data in
the resulting file.

When windowing is in use and not flattening, an area filtering
operation is applied to subcells.  For each subcell, a bounding box is
obtained that contains all of the intersection areas of instances of
the subcell that overlap the window area, in the space of the subcell
master.  If there is no such overlap area, the subcell will not appear
in output.  Otherwise, only objects within the subcell that overlap
this bounding box will appear in output.  If clipping is enabled, the
overlapping objects will be clipped to the bounding box boundary.

\begin{figure}
\caption{\label{writeregion} Illustration of windowing applied over
subcell instances.}
\vspace{1.5ex}
\begin{center}
\epsfbox{images/write_region.eps}
\end{center}
\end{figure}

In figure \ref{writeregion}, the two instances of A together ``cover''
all the objects shown in A.  All of these objects will therefor appear
in A in output as shown, whether or not clipping is enabled.  They
appear outside of the window boundary, illustrating that the window
boundary is not absolute, unless flattening and clipping are employed.

In the single instance of B, the object shown straddles the window
area and will therefor be included in output.  If clipping is enabled,
the object within B will be clipped to the window boundary.  The
single instance of C overlaps the window area, so will be included in
output.  However, since none of its objects appear within the area,
the C subcell will be empty in output.  Empty cells will be removed
from output if the empty cell filtering option is set.  This will add
some computational overhead, and in most cases empty cells are
``harmless''.

\item{\cb Conversion Scale Factor}\\
For input file types that support scaling, the conversion scale factor
entry area will be active.  A scale factor of .001 -- 1000.0 can be
entered in this area, and will be applied during the translation. 
When scaling, only the physical (not electrical) data are scaled.

\item{\cb Convert}\\
The translation is initiated with the {\cb Convert} button.  The user
will be prompted for the name of the input file (or directory for {\cb
Native Cell Directory}, and then the name of the output file, or
directory for native files.

When the input source is a CHD or saved CHD file, when the user is
prompted for the CHD name or file name, the user can supply an
optional second argument.  This is the name of a cell in the CHD
(including any aliasing applied when the CHD was created) that will be
used as the root cell in output.  If no cell name is provided, the
top-cell configured in the CHD will be used.  If no cell is
configured, all cells referenced in the CHD will be converted.

If the input file contains multiple top-level cells, and no windowing,
flattening, or empty cell filtering is employed, files are simply
streamed through the converter and all cells are translated, using the
specified parameters.  If windowing or similar is employed, a
temporary Cell Hierarchy Digest (CHD) is transiently produced in
memory, which is used to perform the conversion.  In this case, only
the ``default'' top level cell hierarchy will be converted.  This is
the first cell in the file that is not used as a subcell by another
cell defined in the file.  Of course, if the input format choice is a
CHD, and the CHD is configured with a top-level cell, that cell will
be used.
\end{description}


% -----------------------------------------------------------------------------
% asciitext 061308
\subsection{Generating ASCII Output from Layout Data}
\index{ASCII text, from layout data}
The conversion of GDSII to ``gds-text'' is a diagnostic tool for
converting the data in a (binary) GDSII file into a text form.  Each
record of the stream file is parsed and output generated in sequence. 
The text file can grow quite large, though a range specification can
be given to limit the number of records printed.  The text file is
mainly used as a diagnostic for misbehaving GDSII files.  It can be
reconverted into a GDSII file, thus, the text representation is in
effect another valid file format for layout data.  This facility
allows corrupted or otherwise problematic GDSII files to be repaired.

OASIS files converted to ASCII text use the same ASCII record format
as {\vt anuvad-0.8} from {\cb SoftJin} ({\vt
http://www.softjin.com/html/anuvad.htm}), except for the separator
lines that indicate the start of physical and electrical records.  The
{\vt anuvad} tool set is free, and contains libraries and programs to
convert between GDSII and OASIS formats, and to/from ASCII text
representations of those formats.  The boolean variable {\et
OasPrintNoWrap} will suppress line wrapping when set, i.e., each
record will occupy one possibly very long text line.  The boolean
variable {\et OasPrintOffset} will add file offsets to the output when
set.  These variables track the settings of the check boxes on the
{\cb ASCII text} output format tab page in the {\cb Format Conversion}
panel.

When converting to text format, the user will be prompted for an
optional range specification string.  If no string is given, the
entire archive file will be written as text.  The range specification
string is expected to be in the following format.

\begin{quote}
    [{\it start\_offs\/}[{\vt -}{\it end\_offs\/}]] [{\vt -r}
      {\it rec\_count\/}] [{\vt -c} {\it cell\_count\/}]
\end{quote}

    The square brackets indicate optional terms.  The meanings are:

\begin{description}
\item{\it start\_offs}\\
An integer, in decimal or ``{\vt 0x}'' hex format (a hex digit
preceded by ``{\vt 0x}'').  The printing will begin at the first
record with offset greater than or equal to this value.

\item{\it end\_offs}\\
An integer in decimal or ``{\vt 0x}'' hex format.  If this value is
greater than {\it start\_offs}, the last record printed is at most the
one containing this offset.  If given, this should appear after a `{\vt -}'
character following the {\it start\_offs}, with no space.

\item{\it rec\_count}\\
A positive integer, at most this many records will be printed.

\item{\it cell\_count}\\
A non-negative integer, at most the records for this many cell
definitions will be printed.  If given as 0, the records from the {\it
start\_offs} to the next cell definition will be printed.
\end{description}

Records are printed from the beginning of the file, or the {\it
start\_offs} if given.  Printing continues to the end of the file, or
to the first of {\it end\_offs}, {\it rec\_count}, or {\it
cell\_count} if any of these have been given.

Back-conversion of the ASCII output into binary form is unlikely
to succeed unless the whole file is written as ASCII.


% -----------------------------------------------------------------------------
% xic:assem 022916
\section{The {\cb Assemble} Button: {\cb Layout File Merge Tool} Panel}
\index{Assemble button}
The {\cb Layout File Merge Tool}, brought up with the {\cb Assemble}
button in the {\cb Convert Menu}, will extract cell hierarchies from
one or more layout files, optionally perform some processing, then add
the hierarchies to a single output file.  It is essentially a
graphical front-end for the {\cb !assemble} command.  The tool is
intended to be highly flexible.  Potential applications include
building up reticles for mask generation or combining design output
from different development groups into a single file.

Similar operations can be performed by use of reference cells.

The supported layout file formats for input and output are GDSII, CGX,
OASIS, and CIF.  The file format is specified when writing, and is
determined automatically when reading.  Any combination of these
formats can be used for input and output.

The data read from the input files can be processed in various ways
before writing to output.  Some of these operations are sketched
below.

\begin{itemize}
\item{The layers can be filtered, to exclude certain layers, accept
only certain layers, or to map certain layers to another layer.  For
GDSII and OASIS, the ``layer'' is actually a layer number/datatype
number combination.  Specification of a layer includes wildcarding of
the layer or datatype number.}

\item{The names of cells can be modified to add or replace a prefix
and/or suffix.}

\item{The data can be transformed by scaling, rotation, translation,
and mirroring before placement in the output.}

\item{The data can be filtered to objects that overlay a rectangular
window, and may be clipped to the window.}

\item{The hierarchy can be flattened before placement.}

\item{Empty cells can be filtered out of the output.}
\end{itemize}

Any combination of these processing operations can be specified.

The processed hierarchies from the specified input layout files are
generally placed in a new top-level cell created in the output file. 
The user can choose the name of this cell, and if no name is given, no
new top-level cell will be created, and the data from each input will
simply be concatenated in the output.

During the merge, the tool remembers tha names of all cells seen, and
will automatically change the names of cells that would clash in the
combined file.  Notification of the change will be written to the log
file, which is produced during a run.  The logfile is named ``{\vt
assemble.log}'' and is produced in the current directory.

\subsection{Overview}

Along the top of the {\cb Merge Tool} are tabs which make visible
separate pages for output and input.  There will always be an output
tab, and at least one source tab.  At startup, there is a single
source tab, labeled ``Source 1''.  Each layout file from which files
are to be extracted will have a source tab, and it is also possible to
use the same archive file in different source pages if necessary.  A
new source page can be created with the {\cb New Source} button in the
{\cb Options} menu, and an existing source page can be deleted with
the {\cb Remove Source} button in the same menu.

Each source page must be filled in with the appropriate entries before
the merge run.  We will return to a description of the fields in the
source pages.

The left-most tab is labeled {\cb Output}, and when selected will show
a page for configuring the overall job output.  The {\cb Top-Level
Cell Name} field may contain the name of a cell that will be created
in the output file as a container for the cell hierarchies read from
the sources.  This will be the top-level cell in the output file.  The
name is arbitrary, but should conform to the standards of the output
file format.  If it should clash with another cell being written from
a source, that file name will be modified to avoid the clash.

It is also possible to run a merge without entering a {\cb Top-Level
Cell Name}.  In this case, the hierarchies extracted from the source
archives are simply concatenated in the output file.  The output file
may then have multiple top-level cells.  Any transformation
information except scaling will be ignored, since transformations
apply to the placement of the hierarchy in the container top-level
cell.

The {\cb Path to New Layout File} field is required; it specifies the
output file.  The format of the output file produced is determined by
the format tab selected at the top of the output page.

The {\cb Create layout File} button initiates to merge operation.  It
should be pressed when all relevant fields in the {\cb Merge Tool}
have been filled in.  Depending upon the number and size of the files
and hardware characteristics, the operation can take seconds to hours. 
When started, a progress monitor pop-up appears.  This displays the
number of bytes read and written, error and warning messages emitted,
and a "working" indication.  An abort button is also provided which
can be used to terminate the operation.

The {\cb Dismiss} button will exit the {\cb Merge Tool} program. 
Unless the {\cb Save} button in the {\cb File} menu has been used, all
entered information will be lost.  The {\cb Save} button can be used
to save the current state of the {\cb Merge Tool} to a file, which can
be read later (with the {\cb Recall} button) to configure the {\cb
Merge Tool} to the same state as was saved.  The file format is that
used as input to the {\cb !assemble} command, and is described there. 
Note that files prepared by hand for use with the {\cb !assemble}
command can be loaded into the {\cb Merge Tool} with the {\cb Recall}
button.

\subsection{The Source Page}

Each input file has at least one corresponding source page.  Only one
page is visible, and it occupies the main part of the {\cb Merge Tool}
display.  The page displayed can be selected by clicking on the {\cb
Source} tabs just below the menu bar.  The entries in the page
identify the cells to extract and the processing to be performed.

The required {\cb Path to Source} field contains the path to the
associated layout file, and the file must be in one of the supported
formats.  This entry can also be the access name of a Cell Hierarchy
Digest (CHD) in memory, or a path to a saved CHD file on disk.  In
either case, the CHD will then be used to access the content of the
associated file.

\subsection{Layer Filtering Module}

The group of entries below the file path controls layer filtering and
aliasing.  These are optional and can be ignored if no layer
manipulations are needed.

The module contains the following controls:

\begin{description}
\item{{\cb Layer List} text area}\\
The {\cb Layer List} can be set to a space-separated list of layer
names.  Each layer name is expected to match an effective layer name
in the file being read.  For file types such as GDSII that designate
layers with layer/datatype integers, either the hex encoding or
decimal form can be used, with wildcarding accepted.  The {\cb Layer
List} is ignored unless one of the following two check boxes is
selected.

\item{{\cb Layers Only} check box}\\
If this box is checked, only the layers listed in the {\cb Layer
List} will be read from the source.

\item{{\cb Skip Layers} check box}\\
This box can be checked if the {\cb Layers Only} box is unchecked. 
When checked, layers listed in the {\cb Layer List} will be ignored in
the source.  All layers except those listed will be read.

\item{{\cb Layer Aliases} text area}\\
This provides a means for converting layers found in input from the
source to a different layer when written to output.  The entered text
contains zero of more space-separated text tokens in the form
\begin{quote}
{\it oldname\/}={\it newname}
\end{quote}
The {\it oldname} is a layer name consistent with the source format. 
For GDSII and OASIS, either hex or decimal encoding is accepted.  The
{\it newname} is the destination layer consistent with the output
format.  Again, gor GDSII and OASIS either the hex or decimal forms
may be used.  There should be no space between the names (or in the
names) and the equal sign `=' separator.
\end{description}

\subsection{Scaling}

There are three different scaling entries which may apply.  If there
are no cells listed in the {\cb Top-Level Cells} entry area, then none
of the ``per cell'' settings (to be described) apply, and the value in
the {\cb Conversion Scale Factor} entry area will be used to scale all
coordinates read from the source.  The {\cb Conversion Scale Factor}
will be ignored if any cells are listed in the {\cb Top-Level Cells}
area, and scaling values will be obtained from the ``per cell''
entries.

The ``per cell'' entries allow scaling of the cell definitions written
to output, and magnification of any instantiations created in a
top-level cell in output.

\begin{description}
\item{{\cb Conversion Scale Factor} numeric entry area}\\
This provides a scale factor for cell data read from the source when
no {\cb Top-Level Cells} have been given.  This value is ignored
otherwise.  This can range from .001 through 1000.0, and is applied to
all coordinates of cells being read from the present source.
\end{description}

\subsection{Cell Name Modification}

This group allows systematic changes to the cell names read from the
source layout file.  If the source is a CHD, then the cell name
modifications described here are performed after any cell
modifications configured into the CHD.

\begin{description}
\item{{\cb Prefix} and {\cb Suffix} text entries}\\
Text entered into these text areas will be added as a prefix or suffix
to cell names encountered when reading the source file.  The entries
are string tokens, containing any alphanumeric characters plus `\$',
`?', `\_'.  String tokens given in this form will be
prepended/appended to each cell name read from the source.

A limited text substitution mechanism is available.  The string tokens
can also have the form /{\it str\/}/{\it sub\/}/ which indicates a
substitution.  This causes the {\it str} if it appears as a
prefix/suffix of a cell name to be replaced by {\it sub}.  The {\it
sub} can be empty (i.e., the form is /{\it str\/}//) which can be used
to undo the previous addition of a prefix or suffix.  Forms like
//{\it sub\/}/ are equivalent to just giving {\it sub} as a string.

\item{{\cb To Lower} and {\cb To Upper} check boxes}\\
If set, {\cb To Lower} will convert upper case cell names to lower
case, and {\cb To Upper} will convert lower case cell names to upper. 
Mixed case cell names are not affected.  Case conversion is performed
before any applied prefix/suffix.
\end{description}

\subsection{Top-Level Cells List}

Each source may have one or more top-level cells specified.  If no
top-level cells are specified the default operation will be as
follows.  If the source is a layout file, the entire file will be
streamed into the output.  If the source is a CHD, the cell hierarchy
of the CHD's default cell will be streamed into the output.  If not
explicitly configured, this will be the first top-level cell in the
file referenced by the CHD.

The top-level cell names are names of cells in the source.  If the
source is a CHD with cell name modification, the names must include
the modification.  These cells, and possibly their hierarchies, will
be used in output.  Note that the cells listed are not necessarily
top-level in the source, any cell in the source file can be listed.

Cells are added to the list by use of the {\cb New Toplevel} button in
the {\cb Options} menu.  Note that the user must generally know the
names of the cells in the source to be extracted.  If an empty cell
name is given at the prompt, the text ``{\vt <default>}'' will
appear in the listing, which will correspond to the default cell of a
CHD source or the first top-level cell found in a source file.  Thus,
it is possible to access the ``top'' cell in a source without knowing
its name.  Giving a cell makes available the ``per cell'' operations
in the {\cb Basic} and {\cb Advanced} pages to the right of the
listing.

One can use the {\cb Contents} list in the {\cb Cell Hierarchy
Digests} listing to list the cell names, if the source has a
corresponding CHD.  Cell names can be dragged directly from the
listing panel and dropped in the {\cb Top-Level Cells} list, bypassing
the need to use the {\cb New Toplevel} menu button.

Clicking on a cell name in the list will select it, enabling
additional ``per-cell'' entries which apply to this cell and its
hierarchy.  The selected cell name can be deleted from the list with
the {\cb Remove Toplevel} button in the {\cb Options} menu.

\subsection{Basic Transformations}

If a cell name is selected in the {\cb Top-Level Cells} listing, the
entries in the {\cb Basic} tab page become enabled.  One may have to
click on the ``Basic'' tab to display the entries.  These control the
transformation of the selected cell when instantiated in the top-level
cell in the output file.  If there is no top-level cell name given,
these entries will be ignored.

\begin{description}
\item{{\cb Placement Name} entry}\\
The {\cb Placement Name} field can be filled in with a new name.  The
selected cell will be saved under this name, rather than its real
name, in output.  Any name modifications in force will be applied to
this name.

\item{{\cb Basic} transformation entries}\\
This tab page contains entries that control the transformation of the
selected cell when instantiated.  The {\cb Placement X,Y} entries set
the translation coordinates in microns.  The origin of the selected
cell will be mapped to this location in the output top-level cell. 
Additionally, the cell instance can be rotated, mirrored, or
magnified.  The {\cb Rotation Angle} menu provides rotation angle
choices:  multiples of 45 degrees.  The {\cb Mirror-Y} button will
invert the Y-coordinates before rotation.  The {\cb Magnification}
entry can change the scaling of the instantiation.
\end{description}

\subsection{Advanced Operations}

When a cell name is selected in the {\cb Top-Level Cells} listing, the
entries in the {\cb Advanced} tab page become enabled.  These
operations apply to the cell data read from the source file for the
selected cell, allowing windowing, flattening, and other operations. 
These are similar to the windowing operations provided in the {\cb
Format Conversion} panel.

\begin{description}
\item{{\cb Use Window} check box}\\
Windowing operations are enabled by setting the {\cb Use Window} check
box.  A window is a rectangular area in the selected cell, which is
specified (in microns) with the four numerical entry boxes.

With windowing enabled, only objects and subcells that have nonzero
overlap with the window will be written to output.  In subcells, only
objects that overlap the window in the context of some instance will
be included.  Thus, only the objects in the file needed to represent
the window area of the selected cell to all depths below the selected
cell will be read from the source.

\item{{\cb Clip} check box}\\
If in addition the {\cb Clip} check box is set, the objects will be
clipped to the window.  This includes objects in subcells.  Note that
this does not guarantee that geometry will not appear outside of the
window, since instance geometry may appear anywhere.

\item{{\cb Flatten} check box}\\
The {\cb Flatten} button will flatten the hierarchy under the selected
cell.  Flattening can be applied with or without windowing.  Along
with windowing and clipping, no geometry will extend outside of the
window area.

\item{\cb Empty Cell Filter}\\
The {\cb pre-filt} and {\cb post-filt} check boxes enable the two
stages of empty cell filtering, as described for the {\cb Format
Conversion} panel in \ref{ecfilt}.

\item{{\cb Scale Factor} entry}\\
The coordinates in the cell and its hierarchy will be scaled by this
factor in output.  This is done logically before any windowing
operations.

\item{{\cb No Hierarchy} check box}\\
If checked, only the cell, and not its subcell hierarchy, will be
included in output.  This can lead to unresolved references in the
output file.
\end{description}

\subsection{Merge Tool Menus}

The {\cb Merge Tool} provides three drop-down menus in the menu bar at
the top of the interactive display:  {\cb File}, {\cb Options}, and
{\cb Help}.  The {\cb File} menu contains entries related to
input/output, and {\cb Options} contains entries for modification of
program operation.  The {\cb Help} menu provides access to
documentation.  This section describes the entries of each menu in
detail.

Some of the menu entries have keyboard accelerators, which are listed
in the menu.  Pressing the accelerator key combination has the same
effect as pressing the menu button, without the need to display the
menu.

\subsection{The File Menu}

The file menu contains command buttons that deal generally with
input/output.

\begin{description}
\item{\cb File Select}\\
The {\cb File Select} button brings up a {\cb File Selection} panel. 
This enables the file hierarchy on the user's computer to be searched
for files.  Selecting a file by double clicking a name of pressing the
green octagon ``Go'' button will enter the full file path into the
{\cb Path to Source} entry of the current {\cb Source} page.

\item{\cb Save}\\
The {\cb Save} button will save the current {\cb Merge Tool}
configuration in a file.  The file format is as described for the {\cb
!assemble} command in \ref{assemble}.  This includes all of the
filled-in entries of all pages currently recorded in the tool.  This
file can be subsequently read to reset the {\cb Merge Tool} to the
saved status.  The generated file is in a simple ASCII format that can
be generated by third-party scripts, etc., by the advanced user.

Pressing the {\cb Save} button will pop-up a small dialog asking for a
name for the file.  This name can be anything, but it is recommended
that a standard extension such as ``{\vt .sav}'' be used to make these
files easily recognized.  Pressing the {\cb Save State} button on the
dialog will generate and save the state file.

\item{\cb Recall}\\
The {\cb Recall} button will read a file previously saved with the
{\cb Save} button, and reconfigure the {\cb Merge Tool} to the state
saved in the file.

Pressing the {\cb Recall} button will pop up a small dialog asking for
the name of the file.  This can be entered directly, or the {\cb File
Selection} panel (from the {\cb File Select} button) can be used to
locate the file.  Once located, the name of the file can be dragged
from the {\cb File Selection} panel and dropped in the dialog.

Pressing the {\cb Recall State} button in the dialog will reconfigure
the {\cb Merge Tool} to the state found in the file.  All entries in
the tool should be as saved.
\end{description}

\subsection{The Options Menu}

The {\cb Options} menu contains buttons that enable making certain
entries into the {\cb Merge Tool} forms, and otherwise induce changes
in configuration.

\begin{description}
\item{\cb Reset}\\
Pressing this button will reset the configuration of the {\cb Merge
Tool} to the startup (empty) configuration.  All existing entries will
be lost.

\item{\cb New Source}\\
Each input file from which cells are to be extracted, termed a
``Source'', has a separate page in the {\cb Merge Tool} display.  At
startup, there is one empty source page, which is specified as
``Source 1'' in the tab at the top of the display.  The {\cb New
Source} button will create a new empty source page, with a new tab
with a unique name.  The new page will become the visible page.  Other
source pages can be selected by clicking on the tabs.  Each source
page must be filled in with the appropriate entries before a merge can
be performed.

\item{\cb Remove Source}\\
Pressing this button will irretrievably delete the currently visible
source page, if it is not the initial ``Source 1'' page.  The page and
its tab and contents will disappear.

\item{\cb New Toplevel}\\
This will add the name of a top level cell to the {\cb Top-Level
Cells} list of the current page.  These are cells that represent the
top level of hierarchies to be extracted from the archive file named
in the {\cb Path to Source} entry on the same page.  The names in the
list must match an actual cell name found in the file.  These are
``top-level'' in the extraction sense and need not be top-level in the
overall cell hierarchy of the file.  The list can contain the same
name multiple times if multiple instances of the cell are needed in
output.

Note that the user must have knowledge of the names of the cells used
in the file.  The names specified must be the actual names found in
the file, and do not reflect name changes that might be applied during
processing.

\item{\cb Remove Toplevel}\\
This will remove the highlighted entry in the {\cb Top-Level Cells}
list, if an entry is highlighted.  An entry is highlighted by clicking
on it with the mouse.  When an entry is removed, it will not appear in
the output.
\end{description}

\subsection{The Help Menu}

The {\cb Help} menu provides access to {\cb Merge Tool} on-line
documentation.

\begin{description}
\item{\cb Help}\\
This brings up the help system.
\end{description}


% -----------------------------------------------------------------------------
% xic:diff 120110
\section{The {\cb Compare Layouts} Button: Find Differences}
\index{Compare Layouts button}
The {\cb Compare Layouts} button in the {\cb Convert Menu} brings up
the {\cb Compare Layouts} panel.  This is a graphical front-end for
the {\cb !compare} command, used to compare the contents of cells and
hierarchies.

There are three different comparison modes, which can be selected with
the notebook tabs at the top of the panel.  The {\cb Per-Cell Objects}
mode will compare objects directly:  box-to-box, poly-to-poly, etc.  A
difference will be recorded if an object does not have an identical
counterpart in the other cell.  In this mode only, there is provision
for comparing the properties of the cells, objects and instances.  In
other modes, properties are ignored.

The {\cb Per-Cell Geometry} mode will first convert the geometry to
trapezoids, then compare the coverage of the trapezoid lists.  Only
differences in the actual dark-area will be reported.  Both of these
modes apply only to the geometry within a cell.  The third mode, {\cb
Flat Geometry}, will compare the geometry after (logically) flattening
the hierarchy.  More detail will be provided below.

The lower half of the panel provides input areas for parameters that
are used in any mode.  The top two groups provide the sources to be
compared.  The {\cb Source} entries can contain the name of a layout
file in any of the supported formats, or the name of a Cell Hierarchy
Digest (CHD) in memory.  If left blank, the source is taken as the
main database.  Both {\cb Source} entries may be blank in {\cb
Per-Cell Objects} mode, in order to compare cells in memory (in the
current symbol table).  The second {\cb Source} entry can be left
empty in any but the {\cb Flat Geometry} mode, in which case the cells
to compare must exist in memory, in the current symbol table.  The top
(left pointing) {\cb Source} is the ``reference'' when the list of
cells to compare is generated, so there is an asymmetry that should be
kept in mind, which will be further discussed below.

If a file name is given as a source, a temporary CHD is created for
use during the comparison, and is destroyed when the operation
completes.  Thus, when doing repeated comparisons, it is more
efficient to create a CHD first, and reference this CHD for
comparisons.

The actual list of cells to compare is generated from entries in the
{\cb Cells} and {\cb Equiv} entry areas by logic to be described. 
These entry areas, if not blank, should contain space-separated cell
names.

In many cases, there is only one list of cells to compare, and each
cell is sought in both sources.  If a cell is found in one source and
not the other, this will appear in the log file, but is not considered
to be an error.  The cells list in this case is always given in the
{\cb Cells} entry.

If an {\cb Equiv} list is given, there must be exactly the same number
of entries given in the {\cb Cells} list.  The cells in the two lists
will be compared term-by-term, in order.  This is how one can compare
cells with differing names.  In all other cases, the {\cb Equiv} list
should be left blank.  It is an error if {\cb Equiv} entries are given
with {\cb Cells} blank, or if the list lengths differ.  However, the
{\cb Equiv} list is ignored if in a per-cell comparison mode and {\cb
Recurse Into Hierarchy} is checked.

The interpretation of a blank {\cb Cells} list depends on the
comparison mode.  If in flat comparison mode, or in a per-cell mode
and the {\cb Recurse Into Hierarchy} button is set, then the assumed
cell list contains only the default cell from the top (left pointing)
source.  If this was a CHD name, the default cell is the one
configured into the CHD, or the first top-level cell found in the
source file.  In the other cases, a blank {\cb Cells} list is
interpreted as all cells found in the top (left pointing) source.

In the special case that neither a left or right source is specified,
then the {\cb Cells} and {\cb Equiv} lists can not be empty, and the
names are cells in memory to compare.

In the per-cell modes with {\cb Recurse Into Hierarchy} set, each
entry in the {\cb Cells} list is hierarchically expanded to a full
list of the cells under the given cell, and these names are merged
into a new list that contains no duplicates.  If no {\cb Cells} list
was given, per the discussion above, the cell list is effectively the
hierarchy of the default cell from the first source.

Below the source groups is a provision for layer-filtering.  This is
active when one of {\cb Layers Only} or {\cb Skip Layers} is pressed. 
The list contains space-separated layer names.  With {\cb Layers Only}
active, only objects on the listed layers will be compared.  With the
{\cb Skip Layers} button pressed (which deactivates {\cb Layers Only}
and vice-versa), only layers {\bf not} listed will be considered.  If
neither button pressed, or if the layer list is empty, all layers will
be considered.

During comparison, differences are recorded in an output file.  By
default, geometric differences are saved in a CIF-like format,
providing lists of objects that appear in one cell but not the other. 
If the {\cb Differ Only} check box is active, the geometric
information is not written to the file, only the information that the
cells differ.

The maximum number of differences that are recorded can be set with
the {\cb Maximum Differences} input area.  If 0, then there is no
limit.  Otherwise, when the limit is reached, the comparison will
terminate.  It is usually advisable to set a limit, as an error in the
source specification can potentially produce enormous output.

Pressing the {\cb Go} button initiates comparison.  When the job
finishes, the user is given the option of viewing the log file.  The
log file is always named {\vt diff.log} and is created in the current
directory.  An existing file of the same name is moved to a new name
with a {\vt .bak} extension added.  The {\cb !diffcells} command can
be used to create cells from the log file for visualizing the
differences.

The {\cb Dismiss} button retires the panel.  All entries are
persistent, meaning that the panel will contain the same entered
content the next time it appears.

\subsection{Comparison Mode Pages}

The comparison mode can be selected by clicking on the tabs at the top
of the panel.  Both of the per-cell modes contain {\cb Recurse Into
Hierarchy} and {\cb Expand Array} buttons.  The {\cb Recurse Into
Hierarchy} check box indicates that the cell to compare is to be taken
as the top of a hierarchy, and this and all descendent cells should be
compared.  If not set, only the named cell is compared.

The {\cb Expand Arrays} button applies when cell instances are being
checked.  When set, instance arrays are logically converted to
individual placements before comparison.  This avoids flagging
differences that are due only to whether instances are arrayed or not,
or whether that arraying is the same.  This is useful when comparing
OASIS files to GDSII files, for example, where the OASIS repetition
finder may have been used.

Electrical cells can be compared using the {\cb Per-Cell Objects} mode
only.  The mode to compare is selected on the page, which may be
different from the current mode of the program.

When using {\cb Per-Cell Objects}, one may select which type of
objects to compare.  Objects types that are not active are ignored. 
By default, text labels are ignored and all other objects are
compared.  A difference is indicated if a tested object does not have
an identical counterpart in the other cell.

Comparison of labels can lead to false differences when comparing
cells read from different file formats, since label bounding boxes are
not well defined across file format conversion.

The {\cb Per-Cell Objects} page contains a {\cb Box to Wire/Poly
Check} check box.  With this mode selected, a two-vertex wire or
four-vertex polygon that is rendered as a Manhattan rectangle will
match a rectangle object with the same dimensions.  Thus, files that
have had these features converted to boxes to save space can be
directly compared, without a lot of spurious entries in output.

The {\cb Ignore Duplicates} check box in the {\cb Per-Cell Objects}
page sets a mode where if duplicate objects are present in one or both
of the files, unmatched duplicates will not be reported if one of the
duplicates has a match.  Thus files with duplicates removed can be
compared with the original file, and the duplicates will not appear in
output as differences.

In {\cb Per-Cell Geometry} mode, all boxes, polygons, and wires are
included.  Text labels are ignored.  A button provides a choice
whether or not to check subcells, which are tested as in the per-cell
object mode.

When using {\cb Per-Cell Geometry} mode, the geometry is compared
within areas of a grid whose size is given by the {\et PartitionSize}
variable.  Experimenting with this size can lead to improved speed,
depending on the layout density.  The default partition size is 100
microns.  For best performance, this can be increased for low density,
or reduced for high density, where ``density'' refers to the number of
trapezoids per area.

The {\cb Flat Geometry} mode is somewhat orthogonal to the other
modes.  The algorithm uses two levels of gridding to partition the
layout into pieces, and directly compares the geometry in each fine
grid cell.  This is very similar to the algorithm described for the
{\vt ChdIterateOverRegion} script function.

The fine grid size is entered in microns, the coarse grid size is
entered as an integer multiple of the fine grid size.  The flat
geometry to render a coarse grid cell is held in memory, but
subdivided into the fine grid cells for the comparison.  Using a large
coarse grid with a dense layout may trigger memory availability
issues, yet using a large coarse grid usually improves speed.  The
user should experiment with the parameter values to see what works
best with their layouts.  The fine grid can be in the range of 1.0 to
100.0 microns, and the multiplier can be in the range 1 -- 100.

If the {\cb Use Window} button is active, a rectangle entered into the
entries (in microns) can be used to limit the comparison area.  If not
active, an area covering the entire bounding box of both cells being
compared is used.  The {\cb S} and {\cb R} buttons provide access to
eight general purpose storage registers for rectangles, as provided in
other panels that use rectangle data.

\subsection{Property List Comparison}

The {\cb Per-Cell Objects} mode allows properties to be compared,
unlike the other modes.  There are three classes of properties: 
structure (cell) properties, cell instance properties, and object
properties.

Whether or not to check properties can be set independently for each
type of object.  Properties of a given object type will only be
compared when enabled by checking the boxes in the {\cb Properties}
group, plus the {\cb Structure Properties} check box.  When not
checked, the properties of the corresponding object, cell instance, or
the structure, will be ignored.

Property lists of objects and instances are only compared between
otherwise identical objects or instances.  Cell structure property
lists will be compared whether or not other differences are found,
when enabled.

There are three filters that can be applied, to reduce the number of
properties compared.  These correspond to cell properties, instance
properties, and object properties.  Further, different filtering is
applied when comparing electrical and physical mode data.  The {\cb
Property Filtering} option menu and {\cb Setup} button control the
filtering applied.

The {\cb Default} choice of the menu applies default filtering.  With
this choice, there is no filtering (all properties considered) when
comparing physical mode data.  In electrical mode, the following
defaults are applied:

\begin{description}
\item{Cell properties}\\
Compare only PARAM, VIRTUAL, NEWMUT, SYMBLC, and NODMAP properties.
\item{Instance properties}\\
Compare only MODEL, VALUE, PARAM, and NOPHYS properties.
\item{Object properties}\\
Ignore all electrical properties of objects.
\end{description}

This filtering limits the comparison to properties over which the user
has control, and whose differences are likely to indicate an actual design
difference.

The {\cb None} choice of the menu effectively turns filtering off, for
both electrical and physical modes.  This is comprehensive, but for
electrical mode a lot of the internal properties, for example NODE
properties, will be flagged as differing but may not represent a true
difference in the design as the strings may include arbitrary internal
assignments for some parameters.

The third possible menu choice, {\cb Custom} allows the user to
completely specify the filtering behavior.  This is described in the
next section.  The filtering is specified from the pop-up produced by
pressing the {\cb Setup} button.

Properties are compared by number and string.  In the output file,
property comparison result lines are all in comment form (with `{\vt
\#}' as the first character) so that they will be ignored if the file
is subsequently processed with the {\cb !diffcells} command.  Property
comparison results consist of a string indicating the cell, instance,
or object containing the properties.  If an instance or object, this
is common to both input sources.  Following this are listings of
properties found in one source and not the other.  Properties that are
identical in the two sources are not listed.

% xic:prpfilt  080410
\subsection{Custom Property Filtering}
\label{prpfilt}

The {\cb Custom Property Filter Setup} panel is presented in response
to pressing the {\cb Setup} button in the {\cb Per-Cell Objects} page
of the {\cb Compare Layouts} panel.  The {\cb Compare Layouts} panel
is obtained from the {\cb Compare Layouts} button in the {\cb Convert
Menu}.

This panel allows the user to set up the custom property filter
strings for the cell, cell instances, and objects, for both electrical
and physical mode comparisons.  These filtering definitions are
applied when layout comparison is being performed from the {\cb
Compare Layouts} panel in {\cb Per-Cell Objects} mode, with the {\cb
Property Filtering} menu set to {\cb Custom} and property checking
enabled.  The filtering also applies when using the {\cb !compare}
command, when neither of the {\vt -f} or {\vt -g} options is given,
and the {\vt -u} option is given and property checking is enabled.

The six entry areas correspond to six variables, which can
(equivalently) be set directly.  These variables are
\begin{quote} \et
PhysPrpFltCell\\
PhysPrpFltInst\\
PhysPrpFltObj\\
ElecPrpFltCell\\
ElecPrpFltInst\\
ElecPrpFltObj
\end{quote}

If the entry area is empty, the corresponding variable is unset, and
the default filtering will be applied.  Otherwise, the string
determines the filtering applied.

The strings consist of space and/or comma-separated lists of numbers
or equivalent names.  The names are simply mnemonics to the electrical
properties, and are:
\begin{quote}
\begin{tabular}{ll}
\bf name    & \bf value\\
\vt model   & 1\\
\vt value   & 2\\
\vt param   & 3\\
\vt other   & 4\\
\vt nophys  & 5\\
\vt virtual & 6\\
\vt bnode   & 9\\
\vt node    & 10\\
\vt name    & 11\\
\vt labloc  & 12\\
\vt mut     & 13\\
\vt newmut  & 14\\
\vt branch  & 15\\
\vt labrf   & 16\\
\vt mutlrf  & 17\\
\vt symblc  & 18\\
\vt nodmap  & 19\\
\end{tabular}
\end{quote}

Use of numbers and equivalent names is arbitrary and they can be
mixed.  Names will be recognized if at least the leading two
characters are given, with enough additional characters so as to
uniquely prefix one of the names in the list above.  Names that are
not recognized are silently ignored.

Specifying a list as described indicates that only the listed
properties will be considered.  However, it is possible to invert this
logic.

If the first character in the string is `{\vt s}', and the second
character is not `{\vt y}' (to avoid a clash with ``{\vt symblc}''),
then the properties in the list that follows will be skipped, i.e.,
only properties not in the list will be considered.  If the leading
`{\vt s}' is recognized as the ``skip'' indicator, all alphabetic
characters up to the first delimiter or number will be stripped before
parsing the list.

The recognition of names and the skip indicator are case-insensitive.

For example, the following specifications are all equivalent:
\begin{quote}
{\vt s1,2,3}\\
{\vt skip1,2,3}\\
{\vt skip,1,2,3}\\
{\vt skip 1 2 3}\\
{\vt skip,model,value,param}
\end{quote}

An empty entry area will trigger default filtering and is {\bf not} an
empty filter (blocking all).  To provide an empty list, which blocks
all properties from comparison, simply insert a character that is not
recognized as a property number or `{\vt s}'.  Just about anything
will do, one choice would be `{\vt -}'.  This will have the intended
effect of setting up a filter with no elements, which will not match
any values.

There is one more subtlety that may be encountered.  In graphical
mode, it is not possible to set the variables as booleans, i.e., to
nothing.  The graphical system will immediately unset the variable if
this is attempted.  However, in non-graphics mode, this won't happen, and
the variables will take the null assignment.  In this case, the
corresponding filter will block all, rather than reverting to the
default filter.


% -----------------------------------------------------------------------------
% xic:cut 022916
\section{The {\cb Cut and Export} Button: Export Cell Region}
\index{Cut and Export button}
The {\cb Cut and Export} button in the {\cb Convert Menu} enables the
user to define a rectangular area in a displayed layout, and export
the flattened geometry in the area to a file.  This can be useful for
grabbing features of interest from the layout for documentation
purposes or otherwise.

The user clicks twice or drags in a drawing window, to define a
rectangle.  The rectangle is automatically stored in register 0, of
the eight rectangle registers that are available in pop-ups that use
rectangle entry.  Thus, pop-ups such as the {\cb Format Conversion}
panel, can load this rectangle by pressing the {\cb R} button to the
left of the window entry area, and selecting {\cb Reg 0}.

After the rectangle is defined, the {\cb Export Control} pop-up
appears, preconfigured with the rectangle, and set for flattening,
windowing, and clipping.  The user may choose an output format and
make any other desired changes, then press {\cb Write File}.  This
will cause prompting for the name of the output file, which will be
created if the user provides a valid name and no errors occur.


% -----------------------------------------------------------------------------
% xic:txted 061308
\section{The {\cb Text Editor} Button: Edit Cell Text}
\index{Text Editor button}

The {\cb Text Editor} command brings up a text editor loaded with the
text of the file for the current editing cell.  This is only available
for the ASCII text files:  native and CIF.  The text editor is
described in \ref{textedit}.

