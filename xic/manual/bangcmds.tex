% -----------------------------------------------------------------------------
% Xic Manual
% (C) Copyright 2009, Whiteley Research Inc., Sunnyvale CA
% $Id: bangcmds.tex,v 1.148 2017/03/22 07:29:56 stevew Exp $
% -----------------------------------------------------------------------------

% -----------------------------------------------------------------------------
% keybang 102712
\chapter{Keyboard `{\cb !}' Commands}
\label{bangcmds}

The command line interface through the prompt area provides an
interface to operating system commands, as well as to a number of
internal commands which are often rather specialized and are not
associated with a menu button.  Each of these commands starts with an
exclamation point ``{\cb !}'', and may be entered when no other
command is active, or inside of many commands.  These key presses are
not recorded in the ``keys'' area below the side menu.  If the command
entered matches one of the internal commands listed below, that
command is executed.  Otherwise, an operating system shell and
associated window is produced to execute the command, with the
exclamation mark stripped.

\index{"! command}
\index{shell escape}
{\bf Special Form:  !}\\
Entering a single exclamation point with no other text will produce an
interactive terminal window into which the user can issue operating
system commands.  If any text follows the exclamation point, and that
text does not match an internal command, the exclamation point will be
stripped, the remaining text sent to the operating system for
execution, and the result will be displayed in a pop-up window.

Giving the bare exclamation point is equivalent to giving the {\cb
!shell} command without arguments (see \ref{shellcmd}).  Giving
something like {\vt !xyz} is equivalent to giving {\vt !shell xyz},
provided that {\vt !xyz} is not one of the built-in commands.  The use
of {\vt !shell} removes the ambiguity.

\index{scripts, from prompt line}
{\bf Special Form:  !!}\\
If a line starts with ``{\cb !!}'', the rest of the line is taken as a
script, and executed by the script parser.  This is how to map script
interface functions into a macro.  For example, below is a macro to reset
the current transform:
\begin{quote}
{\vt !!SetTransform(0,0,1)} {\kb Ctrl-Return}
\end{quote}

{\bf Special Form:  !?}\\
Entering ``{\cb !?}'' will bring up help about the `{\cb !}' commands.

{\bf Special Form:  !?{\it name}}\\
This special form will bring up help about the help database keyword
{\it name}.

{\bf Special Form:  !??}\\
This special form will print a listing of the `!' commands 
actually available in the program, from internal tables.

{\bf Special Form:  !\#}\\
The last six commands given are saved, and can be recalled with the
form ``{\cb !\#}[{\it n\/}]'', that is, an exclamation point and a
pound sign followed by an optional integer.  The {\it n} is an
optional integer 0--5, and if not given (the square brackets indicate
``optional'' and are not literal) a value of 0 is taken.  The {\it
n\/}'th previous command will be printed in the prompt area, where it
can be edited and re-executed.  If no matching command is found, there
is no action.
       
When a command from the history list is in the prompt area, the {\kb
Up Arrow} and {\kb Down Arrow} keys can be used to cycle through the
other commands in the history list, each of which will be entered into
the prompt line in response to the key press.

Each `{\cb !}' command given, including those from `{\cb !\#}', will
be pushed onto the history list in the 0 position if it is not
identical to the previous command given.

\newpage

The following table summarizes the internal commands available.  These
commands are described in detail in the following sections.

% 102214
\begin{longtable}[l]{|l|l|} \hline
\multicolumn{2}{|c|}{\kb Compression}\\ \hline
\cb !gzip & Apply compression to file\\ \hline
\cb !gunzip & Uncompress a file\\ \hline
\cb !md5 & Print file digest\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Create Output}\\ \hline
\cb !sa & Save modified cells\\ \hline
\cb !sqdump & Save selections as native cell\\ \hline
\cb !assemble & Process or merge archive files\\ \hline
\cb !splwrite & Split a layout into multiple pieces\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Current Directory}\\ \hline
\cb !cd & Change working directory\\ \hline
\cb !pwd & Print working directory\\ \hline

% 102614
\multicolumn{2}{|c|}{\kb Diagnostics}\\ \hline
\cb !time & Print elapsed run time in seconds in console\\ \hline
\cb !timedbg & Print timing info in console\\ \hline
\cb !xdepth & Print transform stack depth in console\\ \hline
\cb !bincnt & Database diagnostic\\ \hline
\cb !netxp & Net expression checking\\ \hline
\cb !pcdump & Parameterized cell database dump\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Design Rule Checking}\\ \hline
\cb !showz & Show DRC partitioning\\ \hline
\cb !errs & Rebuild DRC error highlighting from file\\ \hline
\cb !errlayer & Create error polygons on some layer\\ \hline

% 021713
\multicolumn{2}{|c|}{\kb Electrical}\\ \hline
\cb !calc & Calculate parameter expression value\\ \hline
\cb !check & Check electrical input for consistency\\ \hline
\cb !regen & Regenerate damaged file\\ \hline
\cb !devkeys & Print device key table\\ \hline

% 090714
\multicolumn{2}{|c|}{\kb Extraction}\\ \hline
\cb !antenna & Test for MOS antenna effect\\ \hline
\cb !netext & Batch physical net extraction\\ \hline
\cb !addcells & Add missing cells\\ \hline
\cb !find & Find devices\\ \hline
\cb !ptrms & Physical terminal manipulations\\ \hline
\cb !ushow & Show unassociated elements\\ \hline
\cb !fc & Control capacitance extraction interface\\ \hline
\cb !fh & Control inductance/resistance extraction interface\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Graphics}\\ \hline
\cb !setcolor & Set attribute color\\ \hline
\cb !display & Display graphics in a foreign X window\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Grid}\\ \hline
\cb !sg & Save the current grid\\ \hline
\cb !rg & Restore saved grid\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Help}\\ \hline
\cb !help & Call the help system\\ \hline
\cb !helpfont & Set help base font family\\ \hline
\cb !helpfixed & Set help fixed font family\\ \hline
\cb !helpreset & Clear help topic cache\\ \hline

% 011114
\multicolumn{2}{|c|}{\kb Keyboard}\\ \hline
\cb !kmap & Read keyboard mapping file\\ \hline

% 012016
\multicolumn{2}{|c|}{\kb Layers}\\ \hline
\cb !ltab & Manipulate layer table\\ \hline
\cb !ltsort & Alphanumerically sort layer table\\ \hline
\cb !exlayers & List layers by applied keywords in console\\ \hline

% 092717
\multicolumn{2}{|c|}{\kb Layout Editing}\\ \hline
\cb !array & Manipulate instance arrays\\ \hline
\cb !layer & Create layers/objects using expression\\ \hline
\cb !mo & Move objects\\ \hline
\cb !co & Copy objects\\ \hline
\cb !spin & Rotate objects\\ \hline
\cb !rename & Rename subcells\\ \hline
\cb !svq & Save selections in register\\ \hline
\cb !rcq & Recall selections from register\\ \hline
\cb !box2poly & Convert boxes to polygons\\ \hline
\cb !path2poly & Convert wire paths to polygons\\ \hline
\cb !poly2path & Convert polygon boundaries to wires\\ \hline
\cb !bloat & Expand/contract object\\ \hline
\cb !join & Join objects into polygon\\ \hline
\cb !jw & Join similar wires with common endpoints\\ \hline
\cb !split & Split polygon into trapezoids\\ \hline
\cb !manh & Convert to Manhattan polygons\\ \hline
\cb !polyfix & Fix polygon errors\\ \hline
\cb !polyrev & Reverse polygon winding\\ \hline
\cb !noacute & Eliminate acute angles\\ \hline
\cb !togrid & Move selected object vertices to grid\\ \hline
\cb !tospot & Condition object for spot size\\ \hline
\cb !origin & Set origin of current cell\\ \hline
\cb !import & Import structures into the current cell\\ \hline

% 012016
\multicolumn{2}{|c|}{\kb Layout Information}\\ \hline
\cb !fileinfo & Print info about archive file in console\\ \hline
\cb !summary & Print summary info of current hierarchy\\ \hline
\cb !compare & Compare geometry in files\\ \hline
\cb !diffcells & Create cells from {\cb !compare} output\\ \hline
\cb !empties & Check for empty cells\\ \hline
\cb !area & Measure object area\\ \hline
\cb !perim & Measure object perimeter\\ \hline
\cb !bb & Print bounding box of current cell\\ \hline
\cb !checkgrid & Check object for off-grid vertices\\ \hline
\cb !checkover & Report cells that overlap\\ \hline
\cb !check45 & Select polygons and/or wires with angle non-45 degree multiple\\ \hline
\cb !dups & Select coincident identical objects\\ \hline
\cb !wirecheck & Check wire characteristics\\ \hline
\cb !polycheck & Check polygon characteristics\\ \hline
\cb !polymanh & Select Manhattan polygons\\ \hline
\cb !poly45 & Select polygons with angle not a 45 degree multiple\\ \hline
\cb !polynum & Show polygon vertex indices\\ \hline
\cb !setflag & Set cell flags\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Libraries and Databases}\\ \hline
\cb !mklib & Create or append to a library file\\ \hline
\cb !lsdb & List ``special'' databases in memory\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Marks}\\ \hline
\cb !mark & Create user marks in layout\\ \hline

% 071815
\multicolumn{2}{|c|}{\kb Memory Management}\\ \hline
\cb !clearall & Clear all memory\\ \hline
\cb !vmem & Windows only, print virtual memory statistics\\ \hline
\cb !mmstats & print memory manager statistics\\ \hline
\cb !mmclear & Clear caches\\ \hline

%\ifoa
% 062313
\multicolumn{2}{|c|}{\kb OpenAccess Interface}\\ \hline
\cb !oaversion & Print OpenAccess release number\\ \hline
\cb !oadebug & Enable log files\\ \hline
\cb !oanewlib & Create new OpenAccess Library\\ \hline
\cb !oabrand & Permit save from {\Xic} in OA library\\ \hline
\cb !oatech & Query OpenAccess technology database\\ \hline
\cb !oasave & Save cell to OpenAccess library\\ \hline
\cb !oaload & Read cell from OpenAccess library\\ \hline
\cb !oadelete & Delete OpenAccess object\\ \hline
%\fi

% 081318
\multicolumn{2}{|c|}{\kb Parameterized Cells}\\ \hline
\cb !rmpcprops & Remove pcell properties from pcell sub-masters\\ \hline
\cb !preload & Pre-load sub-masters to resolve as cell data are read\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Rulers}\\ \hline
\cb !dr & Delete rulers\\ \hline

% 100315
\multicolumn{2}{|c|}{\kb Scripts}\\ \hline
\cb !script & Add a script to the {\cb User Menu}\\ \hline
\cb !rehash & Re-read script libraries and rebuild {\cb User Menu}\\ \hline
\cb !exec & Execute a script\\ \hline
\cb !lisp & Execute a Lisp script\\ \hline
\cb !py & Execute a Python script\\ \hline
\cb !tcl & Execute a Tcl script (no Tk)\\ \hline
\cb !tk & Execute a Tcl/Tk script\\ \hline
\cb !listfuncs & Pop-up list of saved functions\\ \hline
\cb !rmfunc & Delete a saved function\\ \hline
\cb !mkscript & Create script that generates current cell hierarchy\\ \hline
\cb !ldshared & Load a script interface plug-in\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Selections}\\ \hline
\cb !select & Select objects\\ \hline
\cb !desel & Deselect objects\\ \hline
\cb !zs & Zoom to selected objects\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Shell}\\ \hline
\cb !shell & Open terminal window\\ \hline
\cb !ssh & Open terminal window to remote system\\ \hline

% 021615
\multicolumn{2}{|c|}{\kb Technology File}\\ \hline
\cb !attrvars & List the variables that are recognized as tech file keywords\\
  \hline
\cb !dumpcds & Create Cadence Virtuoso$^{TM}$ technology and DRF files\\ \hline

% 102817
\multicolumn{2}{|c|}{\kb Update Release}\\ \hline
\cb !update & Download/install new release\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb Variables}\\ \hline
\cb !set & Set/examine variables\\ \hline
\cb !unset & Unset variables\\ \hline
\cb !setdump & Dump variables\\ \hline

% 102712
\multicolumn{2}{|c|}{\kb {\WRspice} Interface}\\ \hline
\cb !spcmd & Execute {\WRspice} command\\ \hline
\end{longtable}


\section{Compression}

% -----------------------------------------------------------------------------
% !gzip 053108
\subsection{The {\cb !gzip} Command: Compress Files}
\index{"!gzip command}
\index{file compression}
\begin{quote}
Syntax: {\vt !gzip} {\it infile} [{\it outfile\/}]
\end{quote}
The will compress the file given as {\it infile} using the {\vt gzip}
method.  If {\it outfile} is not given, output is written to a file
with the same name as {\it infile} but with a ``{\vt .gz}'' extension. 
Otherwise, the file name given for {\it outfile} must have a ``{\vt
.gz}'' extension.  Under Unix/Linux this uses 64-bit file offsets so
can be applied to files larger than 2Gb, unlike some versions of the
GNU {\vt gzip} utility.  Unlike the GNU {\vt gzip} program, this will
not delete {\it infile\/}.

% -----------------------------------------------------------------------------
% !gunzip 053108
\subsection{The {\cb !gunzip} Command: Uncompress Files}
\index{"!gunzip command}
\begin{quote}
Syntax: {\vt !gunzip} {\it infile} [{\it outfile\/}]
\end{quote}
This will uncompress the file given as {\it infile}, which was
previously compressed with {\vt gzip}, and has a ``{\vt .gz}''
extension.  If no {\it outfile} is given, output is written to a file
with the same name as the {\it infile} but with the ``{\vt .gz}''
suffix stripped.  Under Unix/Linux this uses 64-bit file offsets so
can be applied to files larger than 2Gb, unlike some versions of the
GNU {\vt gunzip} utility.  Unlike the GNU {\vt gunzip} program, this
will not delete {\it infile\/}.

% -----------------------------------------------------------------------------
% !md5 102214
\subsection{The {\cb !md5} Command: Print File Digest}
\index{"!md5 command}
\begin{quote}
Syntax: {\vt !md5} {\it filepath}
\end{quote}
This command will compute and print on the prompt line the MD5 digest
of a file.  The digest is a sequence of 32 hex digits that is very
unlikely to duplicate that of another file.  It can be used to
determine if a file is incorrect or has been tampered with.

The same digest can be obtained from the following command, which is
available on most Unix/Linux/macOS systems:
\begin{quote}
{\vt openssl dgst -md5} {\it filepath}
\end{quote}

\section{Create Output}

% -----------------------------------------------------------------------------
% !sa 102712
\subsection{The {\cb !sa} Command: Save Modified Cells}
\index{"!sa command}
\begin{quote}
Syntax: {\vt !sa}
\end{quote}
Invoking this command is the same as invoking the {\cb Save} command
in the {\cb File Menu}.  If there are modified cells, the {\cb
Modified Cells} pop-up will appear, from which the cells can be saved
to disk.

% -----------------------------------------------------------------------------
% !sqdump 053108
\subsection{The {\cb !sqdump} Command: Save Selections as
 Native Cell}
\index{"!sqdump command}
\begin{quote}
Syntax: {\vt !sqdump} {\it cellpath}
\end{quote}
This will save the current selections to a native file named in {\it
cellpath}.  Unlike the {\cb Create Cell} command in the {\cb Edit
Menu}, no cell is created in memory.

% -----------------------------------------------------------------------------
% !assemble 022916
\subsection{The {\cb !assemble} Command: Merge Archives}
\label{assemble}
\index{"!assemble command}
\begin{quote}
Syntax: {\vt !assemble} {\it specfile} | {\it argument\_list}
\end{quote}
The {\cb !assemble} command automates reading of cells from archives,
subsequent processing, and writing to a new archive file.  It provides
the capabilities of the {\cb Format Conversion} panel in the {\cb
Convert Menu}, such as format translation, windowing, and flattening. 
Additionally, multiple input files and cells can be processed and
merged into a larger archive, on-the-fly or by using a Cell Hierarchy
Digest (CHD) so as to avoid memory limitations.  Cell definitions for
the read and possibly modified cells are streamed into the output
file, and the output file can contain a new top-level cell in which
the cells read are instantiated.  The input and output can be any of
the supported archive formats, in any combination.

The operation can be controlled by a specification script file, the
path to which is given as the argument.  The script uses a language
that is unique to this command, which will be described.  This
supplies the output file name and the description of the top-level
cell (if any), the files to be used as input, the cells to extract
from these files, and the operations to perform.  It is a simple text
file, prepared by the user, containing a number of keywords with
values.  The specification script can also be obtained from the {\cb
Assemble} command in the {\cb Convert Menu}, which is a graphical
front-end to the {\cb !assemble} command.

Alternatively, the argument list can consist of a series of option
tokens and values.  These are logically almost equivalent to the
language of the specification file.  This gives the user the option to
enter job descriptions entirely from the command line.  These
command-line options start with a `{\vt -}' character.  If the first
argument given starts with `{\vt -}', a list of option arguments is
assumed, otherwise the argument is taken as a file name.  If the
specification file name starts with `{\vt -}', one should prepend the
name with ``{\vt ./}'' to avoid a parse error.

Only physical data are read, electrical data will be stripped in
output.  A log file is produced when the {\cb !assemble} command is
run.  If not explicitly set with a {\vt LogFile}/{\vt -log}
specification, this is named ``{\vt assemble.log}'' and is written in
the current directory.  The log file contains warning and error
messages emitted by the readers during file processing, and should be
consulted if a problem occurs.

\subsubsection{File and Option Argument Format}

The {\cb !assemble} command parses and executes a specification file
or option list in the format described below.  The file text contains
keyword directives and values which specify the operations to be
performed.  Each active line begins with a keyword, and all keywords
are case-insensitive.  Blank lines and lines that begin with non-alpha
characters are taken as comments and are ignored.  Unrecognized tokens
will generate an error and no processing will be done.  There is an
almost one-to-one correspondence between file keywords and equivalent
command-line options.  For options that require a string, the string
can be double-quoted ({\vt "..."}), and these {\bf must} be quoted if
they contain white-space.

The command input can either come from a file, or from the
command-line arguments, but not both.

Overall, the input logically contains three levels of directives:

\begin{quote}
Header Block\\
Source Block\\
\hspace*{3em}{\vt [}Placement Block{\vt ]}\\
\hspace*{3em}{\vt [...]}\\
{\vt [...]}
\end{quote}

The Header Block contains a mandatory output file specification line,
and optional additional lines.  The Source Block contains a reference
to a source file, and may contain zero or more Placement Blocks, which
identify a particular cell from that file.  The specification must
contain at least one Source Block.

Indentation can be used in the specification file to highlight the
scoping.  The same logic applies in an argument list, but may be less
visible since all options appear in one line.

\subsubsection{Header Block}

The Header Blocks contains global directives.  This must be followed
by at least one Source Block, which specifies an input source.

\begin{description}
\item{\vt OutFile} {\it out\_file\_name}\\
(option: {\vt -o} {\it out\_file\_name})\\
This line or option is mandatory, and provides the name of the file to
be used for output.  This must appear before any Source Blocks.  The
output file name {\bf must} have a recognized extension that
corresponds to the format to be used.  These are:

\begin{tabular}{ll}
CGX   & \vt .cgx\\
CIF   & \vt .cif\\
GDSII & \vt .gds, .str, .strm, .stream\\
OASIS & \vt .oas\\
\end{tabular}

Only these extensions are recognized, however CGX and GDSII allow an
additional {\vt .gz} which will imply compression.

Basic defaults for the various output formats are as specified in the
{\cb Export Control} panel from the {\cb Convert Menu}, or from
the corresponding variables.

\item{\vt LogFile} {\it logfile}\\
(option: {\vt -log} {\it logfile})\\
This specifies the name of a log file which is produced during the
run.  This will record messages, warnings, and errors that are
emitted.  If not given, a log will be written using a default file
name, which is ``{\vt assemble.log}'' in the current directory, for
the {\cb !assemble} command.

\item{\vt TopCell} {\it cellname}\\
(option: {\vt -t} {\it cellname})\\
This optional line or option specifies that a new top-level cell is to
be created in output.  At most one {\vt TopCell} can be given.  This
must appear before any Source Block.

If a {\vt TopCell} is given, a corresponding cell definition will be
created in the output file, and all cells specified in Placement
Blocks (the ``placements'') will be instantiated in the new cell. 
Whether or not a {\vt TopCell} is given, the placements will be
streamed to the output file, meaning that the cell definitions needed
to describe the cell and possibly its hierarchy will be added to the
output file.  With a {\vt TopCell} given, the placements will be
instantiated in the new top cell in output.  Otherwise, there is no
placement, and redundant Placement Blocks will be ignored.  The output
file can end up with multiple top-level cells, which may be desirable
when creating a library.
\end{description}

The Header can also contain any of the Source Block or Placement Block
directives below.  These will be used as defaults in all blocks that
follow, but can be overridden from within the blocks, or set,
modified, or reset between Source Blocks.

\subsubsection{Source Blocks}

The Source Blocks specify an input file or CHD, and provide directives
that are active when the source is read.  The Source Block may contain
Placement Blocks, which identify individual cells or cell hierarchies
to be read.

The same file might be used in more than one Source Block, if the
directives, such as cell name modification, are different in the two
blocks.

The Source Blocks start with the following keyword:

\begin{description}
\item{\vt Source} {\it filename}\\
(option: {\vt -i} {\it filename})\\
This line or option represents the start of a Source Block for the
given input file.  The file must be in one of the supported archive
formats, and the format is recognized automatically, so there is no
name suffix requirement as with the output file name.

The absence of any Placement Blocks defined in the Source Block
implies that all cells found in the file will be read.

The {\it filename} can also be the access name of a CHD which already
exists in memory.  In this case, the CHD is used for access, and cell
names given in Placement Blocks must include any cell name mapping
which is used in the CHD.

Further, the {\it filename} can be that of a CHD saved to disk, such a
with the {\cb Save} button in the {\cb Cell Hierarchy Digests} panel. 
In this case, the CHD will be read into memory, and used as the
source.

In any case where a Source Block contains a Placement Block, a
temporary CHD will be created anyway if one is not given, so
explicitly naming the CHD may save time/space in some cases.

In cases where a CHD is named, but no Placement Blocks are given, the
hierarchy of the CHD's default cell will be streamed.  The default
cell is the first top-level cell found in the file, or can be
configured into the CHD.
\end{description}

The Source Blocks can be terminated with:

\begin{description}
\item{\vt EndSource}\\
(option: {\vt -i-})\\
This optional keyword or option terminates the present Source Block. 
Lines or text tokens that follow, up to another {\vt Source} keyword
or {\vt -i} option, are taken in the context of the Header Block. 
Thus, directives can be set, modified, or reset between Source Blocks,
and will remain in force (in the Header Block context) until reset or
modified between subsequent Source Blocks.  This keyword is optional,
as it is implicit if another {\vt Source} line or {\vt -i} option is
given.  It is required only if one wishes to change the directives in
the Header context for subsequent Source Blocks. 
\end{description}

Within the Source Block, one may find Placement Blocks, Source Block
directives, and Placement Block directives.

\subsubsection{Source Block Directives}

The Source Block directives can be given in the context of the Header
Block, in which case they serve as defaults for the Source Blocks that
follow.  They can also be given in a Source Block, in which case they
apply in that Source Block only, and override a similar directive
active from a definition in the Header Block context.  The term
``Header Block context'' means that the definition appears before any
Source Block, or after an {\vt EndSource} line ({\vt -i-} option) but
before the next {\vt Source} line ({\vt -i} option.

The Source Block directives can not appear inside of Placement Blocks,
where they would have no meaning.  Thus, in a Source Block, Source
Block directives can appear before the Placement Blocks, or between
{\vt EndPlace} lines ({\vt -c-} option) and the next {\vt Place} ({\vt
-c} option) or {\vt PlaceTop} line ({\vt -ctop} option).  The
directives that apply are those logically in force at the end of the
Source Block.  The Source Block directives apply to the Source Block,
and will have the same effect for all contained Placement Blocks,
regardless of ordering.

The following lines define Source Block directives:

\begin{description}
\item{\vt LayerList} {\it list\_of\_layer\_names}\\
(option: {\vt -l} {\it list\_of\_layer\_names})\\
This saves a list of space-separated layer names or hex-encoded
pseudo-names to be used with the layer filtering directives {\vt
OnlyLayers} ({\vt -n} option) and {\vt SkipLayers} ({\vt -k} option). 
This directive in itself does not alter output.  This list is implied
when a {\it list\_of\_layer\_names} is provided with these keywords. 
In the command line, the list of layer names must be quoted if it
contains more than one entry, but this is not required in a file.

\item{\vt OnlyLayers} [{\it list\_of\_layer\_names\/}]\\
(option: {\vt -n})\\
When active, only the listed layers will be used in output, geometry
on other layers will be skipped.  Arguments following this keyword
will be used to set or reset the {\vt LayerList}, and have the same
interpretation as for that keyword.  If no arguments follow, the {\vt
LayerList} currently in scope will be used.  The {\vt -n} command line
token {\it does not} accept a list of layer names, unlike the
corresponding keyword.  This must be separately specified with a {\vt
-l} option.

\item{\vt NoOnlyLayers}\\
(option: {\vt -n-})\\
Turn off restriction to layers in the {\vt LayerList}, if the {\vt
OnlyLayers} directive ({\vt -n} option) is in force.  The
corresponding {\vt LayerList} remains defined.

\item{\vt SkipLayers} [{\it list\_of\_layer\_names\/}]\\
(option: {\vt -k})\\
When active, listed layers will not appear in output, geometry on
layers not listed will appear in output.  Arguments following this
keyword will be used to set or reset the {\vt LayerList}, and have the
same interpretation as for that keyword.  If no arguments follow, the
{\vt LayerList} currently in scope will be used.  The {\vt -k} command
line token {\it does not} accept a list of layer names, unlike the
corresponding keyword.  This must be separately specified with a {\vt
-l} option.

\item{\vt NoSkipLayers}\\
(option: {\vt -k-})\\
Turn off layer skipping, if the {\vt SkipLayers} directive ({\vt -k}
option) is currently in force.  The associated {\vt LayerList} remains
defined.

\item{\vt LayerAliases} {\it name1\/}={\it alias1}
  {\it name2\/}={\it alias2} ...\\
(option: {\vt -a} {\it name1\/}={\it alias1}
  {\it name2\/}={\it alias2} ...)\\
This keyword provides a list a layer aliasing definitions to apply in
output.  The layer names can be hex-encoded pseudo-names when
applicable.  This is similar to the layer aliasing found in the {\cb
Format Conversion} panel and elsewhere.  In the command line, the list
must be quoted if it contains more than one entry, but this is not
required in a file.

\item{\vt ConvertScale} {\it scale\_factor}\\
(option: {\vt -cs} {\it scale\_factor})\\
This directive has effect only in the case where there are no
Placement Blocks, and is ignored otherwise.  This will scale all
coordinates read from the source by the given factor, which can be in
the range 0.001 through 1000.0.  Thus, in output, the corresponding
cell definitions will be scaled by this factor.  This is similar to
the {\vt Scale} Placement Block directive ({\vt -s} option), but
applies when there are no Placement Blocks and Placement Block
directive are ignored.

\item{\vt ToLower}\\
(option: {\vt -tlo})\\
This sets a flag to indicate conversion of upper case cell names to
lower case in output.  Mixed-case cell names are unaffected.

\item{\vt NoToLower}\\
(option: {\vt -tlo-})\\
Turn off lower-casing, if the {\vt ToLower} directive ({\vt -tlo}
option) is currently in force.

\item{\vt ToUpper}\\
(option: {\vt -tup})\\
This sets a flag to indicate conversion of lower case cell names to
upper case.  Mixed-case cell names are unaffected.

\item{\vt NoToUpper}\\
(option: {\vt -tup-})\\
Turn off upper-casing, if the {\vt ToUpper} directive ({\vt -tup}
option) is currently in force.

\item{\vt CellNamePrefix} {\it prefix\_string}\\
(option: {\vt -p} {\it prefix\_string})\\
Cell name change prefix.  This operation occurs after case conversion. 
The {\it prefix\_string} is interpreted in the manner of the {\et
InCellNamePrefix} variable.

\item{\vt CellNameSuffix} {\it suffix\_string}\\
(option: {\vt -u} {\it suffix\_string})\\
Cell name change suffix.  This operation occurs after case conversion. 
The {\it suffix\_string} is interpreted in the manner of the {\et
InCellNameSuffix} variable.
\end{description}

\subsubsection{Placement Blocks}

Placement Blocks can appear only within Source Blocks.  Each Source
Block can have zero or more Placement Blocks.  If no Placement Blocks
are given, all cells in the source file are written to output, and
Placement Block directives that may be in force are ignored.  If the
Source Block specifies a CHD source, absent any Placement Blocks, the
hierarchy of the CHD's default cell will be streamed to output.

A Placement Block is used to indicate a specific cell within the
source file, which will be written to output.  The Placement Block
directives specify actions to take, for example whether to process
just this cell or its hierarchy, whether to use flattening and/or
windowing, and the placement transform if the cell is to be
instantiated in a given {\vt TopCell}.

As cells are written to output, a table is maintained to prevent
writing duplicate cell definitions.  Each cell needed to represent the
cell hierarchies contained in the output file is written once only. 
When different versions of the same cell are needed, such as with
different scaling, the names of the cells are altered to avoid a name
clash.  This is accomplished by appending ``{\vt \$}{\it N\/}'', where
{\it N} is an integer which makes the new name unique, to the cell
names.

A new Placement Block, which can appear only within a Source Block,
will begin with either of the following keywords or options:

\begin{description}
\item{\vt Place} {\it cellname} [{\it placement\_name\/}]\\
(option: {\vt -c} {\it cellname})\\
The {\it cellname}, which must name a cell in the source file, will be
included in the output file.  If a {\vt TopCell} was given, the cell
will also be instantiated in the given top cell.  The {\it
placement\_name}, if given, will replace {\it cellname} in output.  In
either case, any cell name alteration presently in force will be
applied.  If a Placement Block matches a previous block except for the
transformation parameters ({\vt Translate}, {\vt Rotate}, {\vt
Magnify}, {\vt Reflect}), then if a {\vt TopCell} was given, an
instance will be added with the new transform, but the cell
definitions are already in the output and will not be streamed.  Thus,
in this case with no {\vt TopCell}, there would be no addition to
output.

In a command line, the {\it placement\_name} can not follow the {\it
cellname} as in a file.  Rather, there is a special option token
\begin{quote}
{\vt -ca} {\it placement\_name}
\end{quote}
that can appear within the Placement Block which specifies the name
change.

\item{\vt PlaceTop} [{\it placement\_name\/}]\\
(option: {\vt -ctop})\\
The {\vt PlaceTop} line ({\vt -ctop} option) is equivalent to a {\vt
Place} line ({\vt -c} option), except that it will automatically
select the first top-level cell found in the source.  It is equivalent
to the {\vt Place} line ({\vt -c} option) with the name of this cell
as the first (only) argument.  This is convenient when the top-level
cell name is unknown.  Unlike the keyword, the {\vt -ctop} option does
not take a following {\it placement\_name\/}, which must be given by a
{\vt -ca} option within the Placement Block.

\end{description}

A Placement Block can be terminated with:

\begin{description}
\item{\vt PlaceEnd}\\
(option: {\vt -c-})\\
This optional keyword will end the current Placement Block. 
Subsequent lines will be accepted in the scope of the containing
Source Block.  This keyword is optional, as it is implicit if a {\vt
Place} or {\vt PlaceTop} keyword ({\vt -c} or {\vt -ctop} option) is
given.  It is useful if one needs to add, modify, or reset Placement
Block directives in the Source Block scope, which will apply to
subsequent Placement Blocks.
\end{description}

A Placement Block may contain any of the Placement Block directives,
which control how the cell is treated in output.  The transformations
apply only when a {\vt TopCell} was given in the Header Block, and
control the location and orientation of the instantiation.

\subsubsection{Placement Block Directives}

The Placement Block directives can appear in the Header Block context,
the Source Block context, or within a Placement Block.  Thus, they can
appear virtually anywhere in the specification file or command line,
though the location alters the scope.

If given in the Header Block context, meaning that the directive
appears before the first Source Block, or after an {\vt EndSource}
line ({\vt -i-} option) but ahead of the next {\vt Source} line ({\vt
-i} option), then the directive will be active as a default in all
Source Blocks that follow, until the directive is changed or reset in
the Header Block context.

Similarly, if a Placement Block directive is given in a Source Block,
it will override a similar directive set in the Header Block scope,
and will apply to all Placement Blocks that follow within the Source
Block, until changed or reset in the context of the same Source Block. 
Being given in a Source Block, or in the context of a Source Block,
means that the directive appears before the first {\vt Place} or {\vt
PlaceTop} line ({\vt -c} or {\vt -ctop} option), or after an {\vt
EndPlace} line ({\vt -c-} option but before the next {\vt Place} or
{\vt PlaceTop} line or equivalent options.

If the Placement Block directive appears within a Placement Block, it
will override a similar directive set in the Source Block or Header
Block, and will apply to the current Placement Block only.

Placement Block directives are ignored when reading a source that has
no Placement Blocks.

The following directives define the transformation applied to an
instantiation of the cell in the {\vt TopCell}.  These will be ignored
unless a {\vt TopCell} was given.

\begin{description}
\item{\vt Translate} {\it x y}\\
(options: {\vt -x} {\it x} {\vt -y} {\it y})\\
Specify the translation coordinates.  If not given, the default is 0,
0.  Note that the keyword corresponds to two command-line options.

\item{\vt Rotate} {\it angle}\\
(option: {\vt -ang} {\it angle})\\
Specify a rotation angle, which must be a multiple of 45 degrees.  If
not given, the default is no rotation.

\item{\vt Magnify} {\it magn}\\
(option: {\vt -m} {\it magn})\\
Specify an instance magnification.  If not given, the default is 1.0. 
Values from .001 to 1000.0 are accepted.

\item{\vt Reflect}\\
(option: {\vt -my})\\
Apply a mirror-Y transformation (before rotation, if any).

\item{\vt NoReflect}\\
(option: {\vt -my-})\\
Turn off the mirror-Y transformation, if the {\vt Reflect} directive
({\vt -my} option) is currently in force.
\end{description}

The following directives initiate operations on the cell definition,
as it is written to output.  These are performed whether or not a {\vt
TopCell} was defined.

\begin{description}
\item{\vt Scale} {\it scale\_factor}\\
(option: {\vt -s} {\it scale\_factor})\\
The cells read from the source will have all coordinates multiplied by
the scale factor, which can be in the range .001 -- 1000.0.  This is
distinct from the {\vt Magnify} factor, which applies only to the
instance created in the {\vt TopCell}, and will in effect multiply the
scale factor.  When there are no Placement Blocks, and so Placement
Block directives are ignored, the {\vt ConvertScale} Source Block
directive ({\vt -cs} option) can be used to obtain the same effect.

\item{\vt NoHier}\\
(option: {\vt -h})\\
If given, only the specified cell is written to output, and not its
complete hierarchy as is the normal case.  This can produce output
files with unresolved subcell references, which must be satisfied by
some means.

\item{\vt NoNoHier}\\
(option: {\vt -h-})\\
Turn off the no-hierarchy mode, if the {\vt NoHier} directive ({\vt
-h} option) is currently in force.

\item{\vt NoEmpties [{\it N\/}]}\\
(option: {\vt -e}[{\it N\/}])\\
These enable various permutations of the empty cell filtering
operations, as described for the
{\cb Format Conversion} panel in \ref{ecfilt}.  These are:

\begin{description}
\item{``{\vt NoEmpties}'' or ``{\vt NoEmpties 1}''\\
(option: ``{\vt -e}'' or ``{\vt -e1}'')}\\
Turn on both pre- and post-filtering.
\item{``{\vt NoEmpties 2}''\\
(option: ``{\vt -e2}'')}\\
Turn on pre-filtering only. 
\item{``{\vt NoEmpties 3}''\\
(option: ``{\vt -e3}'')}\\
Turn on post-filtering only.
\item{``{\vt NoNoEmpties}'' or ``{\vt NoEmpties 0}''\\
(option: ``{\vt -e-}'' or ``{\vt -e0}'')}\\
Turn off all empty cell filtering.
\end{description}

\item{\vt NoNoEmpties}\\
(option: {\vt -e-})\\
Turn off empty cell filtering, if the {\vt NoEmpties} directive ({\vt
-e} option) is currently in force (above).  These have synonyms ``{\vt
NoEmpties 0}'' and ``{\vt -e0}''.

\item{\vt Flatten}\\
(option: {\vt -f})\\
If given, all geometry under the cell being read will be written as
part of the cell being read, i.e., the cell hierarchy will be
flattened.  The {\vt NoHier} directive ({\vt -h} option) is ignored if
this is active.

\item{\vt NoFlatten}\\
(option: {\vt -f-})\\
Turn off flattening, if the {\vt Flatten} directive ({\vt -f} option)
is currently in force.

\item{\vt Window} {\it left bottom right top}\\
(option: {\vt -w} {\it left\/},{\it bottom\/},{\it right\/},{\it top})\\
If given, only the subcells (if {\vt NoHier} is not active) and
objects needed to describe the given area in the cell being placed
will be written.  The coordinates apply to {\it cellname} after any
scaling is applied, and are given in microns.  The four numbers can be
separated by commas and/or white space.  In the command line, if white
space is present between numbers, the four numbers must be quoted,
but this is not required in a file.

\item{\vt Clip}\\
(option: {\vt -cl})\\
If {\vt Window} was given, this will cause geometry to be clipped to
the window.

\item{\vt NoClip}\\
(option: {\vt -cl-})\\
Turn off clipping, if the {\vt Clip} directive ({\vt -cl} option) is
currently in force.
\end{description}

% -----------------------------------------------------------------------------
% !splwrite 120310
\subsection{The {\cb !splwrite} Command: Split an Archive}
\index{"!splwrite command}
\label{splwrite}
\begin{quote}
Syntax: {\vt !splwrite}
 {\vt -i} {\it filename}
      {\vt -o} {\it basename\/}.{\it ext} [{\vt -c} {\it cellname\/}]
      {\vt -g} {\it gridsize} {\vt |} {\vt -r}
      {\it l\/},{\it b\/},{\it r\/},{\it t\/}[,{\it l\/},{\it b\/},{\it
      r\/},{\it t\/}]...
      [{\vt -b} {\it bloatval\/}]
      [{\vt -w} {\it l\/},{\it b\/},{\it r\/},{\it t\/}]
      [{\vt -f}] [{\vt -m}] [{\vt -cl}] [{\vt -e}[{\it N\/}]] [{\vt -p}]
\end{quote}
This command will write output files corresponding to a list of
rectangular regions, or to the partitions of a square grid logically
covering all or part of a specified cell in a given layout file.  The
output files contain physical data only.  These files can be flat or
hierarchical.

The arguments are as follows:

\begin{description}
\item{\vt -i} {\it filename}\\
This mandatory argument specifies a path to a layout file, the access
name of a Cell Hierarchy Digest (CHD) in memory, or a path to a saved
CHD file.  This source will provide cell data as input.

\item{\vt -o} {\it basename\/}.{\it ext}\\
This mandatory argument provides the base name of the output files
that will be created, and the type of file to write.  There are
generally two components of the argument, separated by a period.  The
{\it basename} component may be absent, but the period must remain. 
If the {\it basename} is absent, the name of the top-level cell being
split will be used.

The {\it ext\/}, which follows the period, must be one of the
following to indicate the file format to be used for output.

\begin{tabular}{ll}
CGX   & \vt .cgx\\
CIF   & \vt .cif\\
GDSII & \vt .gds, .str, .strm, .stream\\
OASIS & \vt .oas\\
\end{tabular}

The GDSII and CGX extensions can be followed by ``{\vt .gz}'', which
will indicate {\vt gzip} compression.

When writing a list of regions, the file names produced will have
the form
\begin{quote}
{\it basename\/}{\it N\/}.{\it ext}
\end{quote}
where {\it N} is a 1--based index of the region in the order given. 
When writing grid cells, the file names produced will have the form
\begin{quote}
{\it basename\/}\_{\it X\/}\_{\it Y\/}.{\it ext}
\end{quote}
where {\it X} and {\it Y} are the 0--based indices of the
corresponding grid cell (the origin is the lower-left corner).

\item{\vt -c} {\it cellname}\\
This optional argument specifies the name of the cell to be used as
the top-level in output.  If not given, this will be the first
top-level cell found in the input file, or, if the input source is a
CHD, the default cell configured into the CHD will be used.
\end{description}

Exactly one of the following two options must be provided.

\begin{description}
\item{\vt -g} {\it gridsize}\\
This argument specifies the length, in microns, of the side of a
square grid cell.  The area to be written will be tiled with a grid of
this size, with the origin at the lower left corner.  Each grid cell
with nonzero overlap area with the area to be written will have a
corresponding output file produced.

\item{\vt -r} {\it l\/},{\it b\/},{\it r\/},{\it t\/}[,{\it l\/},{\it
 b\/},{\it r\/},{\it t\/}]...\\
This provides a list of rectangular regions to write, as a
comma-separated list of coordinates in microns.  Each region is
specified by four coordinates in the order given, with no white space.

The regions can be given with a single {\vt -r} followed by any number
of concatenated regions, as implied above.  However, any number of
{\vt -r} options with region lists can be given, the regions will be
processed in order.  Some users may find it more convenient to specify
the regions individually, each with a separate {\vt -r} option.

\item{\vt -b} {\it bloatval}\\
This optional argument specifies how much, in microns, the grid cells
will be bloated before the write operation.  If positive, the grid
cells will be expanded, and the files will logically overlap.  The
value can also be negative, which will leave logically unwritten area
between output files.

If a region list is specified rather than a grid, the bloating will be
applied to each region.

\item{\vt -w} {\it l\/},{\it b\/},{\it r\/},{\it t\/}\\
This specifies a rectangular area, in the top-level cell being
written, which will be included in the output files.  The four numbers
are given in microns, separated by commas, with no intervening white
space.  If not provided, the entire cell area is understood.

\item{\vt -f}\\
If this flag is given, the output files will be flat.  All geometry
will be contained in the top-level cell of each file.  Be aware that
this can consume a lot of disk space.

If not given, the output files will maintain the hierarchy of the
original file.  In this mode, only the geometry needed to fully render
the area of the top-level cell corresponding to the (possibly bloated)
grid cell area is retained.  Subcells may therefor contain only part
of the original geometry, or may not appear at all if not instantiated
within the area.  Subcells may also become empty, these are not
automatically stripped.

\item{\vt -m}\\
If flattening, this option specifies that a suffix ``\_{\it N\/}'' is
added to the top cell name in each file, with {\it N} an integer, so
as to make the cell names unique in the collection.  This will
facilitate subsequent merging of data from the files by avoiding cell
name clashes.  Without this option, the files would have the same cell
name, the same name as the original top-level cell.  This option is
ignored if not flattening ({\vt -f} not given). 

\item{\vt -cl}\\
This flag will cause geometry to be clipped at the (possibly bloated)
grid cell boundaries.  This applies whether flattening or not.  Note
that when not flattening, clipping does not guarantee that geometry is
confined to the clip area.

\item{\vt -e}[{\it N\/}]\\
This will enable empty cell filtering, as described for the {\cb
Format Conversion} panel in \ref{ecfilt}.  The options are:
\begin{description}
\item{\vt -e} or {\vt -e1}\\
Turn on both pre- and post-filtering.
\item{\vt -e2}\\
Turn on pre-filtering only.
\item{\vt -e3}\\
Turn on post-filtering only.
\item{\vt -e0}\\
Turn off all empty cell filtering (no operation).
\end{description}

\item{\vt -p}\\
This option specifies that an alternative ``parallel'' writing
algorithm is used when creating output.  In this case, the input file
is read once only, and content is dispatched to the appropriate output
files.  The normal operation is sequential, where the input file is
scanned for each output file.  The parallel method is expected to be
faster, though results may vary. 
\end{description}

The command will create a temporary CHD, if necessary.  Each grid
region is written out sequentially, in the manner of windowing from
the {\cb Format Conversion} panel from the {\cb Convert Menu}.


\section{Current Directory}

% -----------------------------------------------------------------------------
% !cd 053108
\subsection{The {\cb !cd} Command: Change Directory}
\index{"!cd command}
\index{directory change}
\begin{quote}
Syntax: {\vt !cd} [{\it directory\/}]
\end{quote}
The {\cb !cd} command changes the current working directory, as known
to {\Xic}, to {\it directory}.  If no {\it directory} is given, the user's
home directory is understood.

% -----------------------------------------------------------------------------
% !pwd 053108
\subsection{The {\cb !pwd} Command: Print Directory}
\index{"!pwd command}
\index{current directory}
\begin{quote}
Syntax: {\vt !pwd}
\end{quote}
This command will print the {\Xic} current working directory on the
prompt line.


\section{Diagnostics}

% -----------------------------------------------------------------------------
% !time 053108
\subsection{The {\cb !time} Command: Show Elapsed Time}
\index{"!time command}
\begin{quote}
Syntax: {\vt !time}
\end{quote}
Print the elapsed program run time, in seconds, in the console window.

% -----------------------------------------------------------------------------
% !timedbg 080910
\subsection{The {\cb !timedbg} Command: Show Internal Run Times}
\index{"!timedbg command}
\begin{quote}
Syntax: {\vt !timedbg} [{\vt y|n} [-{\it level\/}] [{\it logfile\/}]]
\end{quote}
This command enables or disables printing of internal timing information
for display and DRC operations, and others.

If given with no arguments, a message is printed on the prompt line
indicating whether or not timing info is being printed.

If the first argument is ``{\vt y}'' or ``{\vt on}'', timing
information will be printed.  This can be followed by an optional {\it
level} which is an integer (following a hyphen) that sets the maximum
level of sub-timing info to print.  If 0, only the ``top level''
timing results are shown.  If a file name appears, it gives a path to
a file where the information will be written.  Otherwise, or if the
file can't be opened, output goes to the console window.

If the first argument is ``{\vt n}'' or ``{\vt off}'', timing
information will not be printed.  This has no effect unless timing
info printing is enabled.

In the output, indentation is used to indicate the ``level'' of the
measurement.  Times printed for a given level include all of the times
listed above at a greater indentation level after a previous line at
the same level.  A greater indentation level indicates a timing
measurement of a sub-component of the operation.

% -----------------------------------------------------------------------------
% !xdepth 053108
\subsection{The {\cb !xdepth} Command: Show Transform Depth}
\index{"!xdepth command}
\begin{quote}
Syntax: {\vt !xdepth}
\end{quote}
This prints two numbers on the console.  The first number is the
current transform stack depth, which should always be 0.  The second
number is the transform stack maximum depth used since the last {\cb
!xdepth} call or program start.  This is rather useless except for
debugging ``Transform stack full'' errors.

% -----------------------------------------------------------------------------
% !bincnt 053108
\subsection{The {\cb !bincnt} Command: Database Object Allocation}
\index{"!bincnt command}
\begin{quote}
Syntax: {\vt !bincnt} [{\it layername} [{\it level\/}]]
\end{quote}
This is for debugging purposes, and for the curious.

This command prints some database statistics on the console window. 
If no {\it layername} is given, the layer examined will be ``{\vt
\$\$}'', the internal layer that contains subcell instances.  The
message will look something like
\begin{quote} \vt
Cell noname Layer CSP\\
levels 3, nodes 7, frac 0.928571, items 46 (allocated 46)
\end{quote}

This indicates that the tree structure for the data items on layer CSP
has depth 3, 7 nodes other than the data nodes, occupancy fraction
0.93, and 46 data items, which matches the cached allocation number.

If a number follows the layer name, the enclosing bounding box for
each sub-tree at the given level is transiently shown on-screen.


% -----------------------------------------------------------------------------
% !netxp 062313
\subsection{The {\cb !netxp} Command: Check Net Expression}
\index{"!netxp command}
\begin{quote}
Syntax: {\vt !netxp} {\it net expression}
\end{quote}
This will parse the given net expression (as described in \ref{netex})
into an internal representation, then reconvert this to a string which
is printed in the console window.  The expression will be iterated,
and each bit expression will also be printed.  This is a diagnostic
for the net expression parser, but may also be useful to the user who
is learning about net expressions.


% -----------------------------------------------------------------------------
% !pcdump 102614
\subsection{The {\cb !pcdump} Command: Dump Parameterized Cell Data}
\index{"!pcdump command}
\begin{quote}
Syntax: {\vt !pcdump} [{\it filename}]
\end{quote}
This will dump the default parameter list for every parameterized cell
(pcell) evaluated during the session.  The list is in the format of
the {\et pc\_params} property, including constraints.
%\ifoa
This can be
useful for viewing the parameters and constraints of OpenAccess
pcells, as they lack a native super-master and thus the {\et
pc\_params} property.
%\fi

The argument is the name of a file to create for output.  If not
given, output goes to the console window.


\section{Design Rule Checking}

% -----------------------------------------------------------------------------
% !showz 053108
\subsection{The {\cb !showz} Command: Show DRC Test Areas}
\index{"!showz command}
\begin{quote}
Syntax: {\vt !showz} [{\vt y|n}]
\end{quote}
The {\cb !showz} command will turn on/off a transient display of the
test areas used during DRC.  This is for debugging, or for the
curious.  Given without an argument, the current show state is
toggled.

% -----------------------------------------------------------------------------
% !errs 091509
\subsection{The {\cb !errs} Command: Regenerate DRC Error Highlighting}
\index{"!errs command}
\begin{quote}
Syntax: {\vt !errs}
\end{quote}
This command will update the DRC error highlighting from an existing
DRC error log file.  The action is identical with that of the {\cb
Update Highlighting} button in the {\cb DRC Menu}.

As it is redundant, this command may be removed in a future release.

% -----------------------------------------------------------------------------
% !errlayer 091509
\subsection{The {\cb !errlayer} Command: Create Error Polygons}
\index{"!errlayer command}
\begin{quote}
Syntax: {\vt !errlayer} {\it layer\_name} [{\it prpty\_num\/}]
\end{quote}
This command will create polygons on {\it layer\_name} corresponding
to the error regions currently stored in the list of highlighted
design rule errors.  The layer will be created if it does not already
exist, and will be cleared before updating ({\it be careful!\/}).  All
objects are created in the current cell.  The second argument, if
given, is an integer greater than 0 that is taken as a property
number.  Each created object will be given a property with this
number, with the text being the error message for the error.  If the
argument is given but is not an unsigned integer larger than 0, no
properties are stored.

This action is identical with that of the {\cb Create Layer} button in
the {\cb DRC Menu}.  As it is redundant, this command may be removed
in a future release.


\section{Electrical}

% -----------------------------------------------------------------------------
% !calc 030412
\subsection{The {\cb !calc} Command: Calculate Parameter Expression}
\index{"!calc command}
\begin{quote}
Syntax: {\vt !calc} {\it expression}
\end{quote}
This command started out as a debugging aid for the parameter
handling code, but is actually pretty useful.

The {\it expression} is a math expression involving constants,
parameter names, and the usual math operations and functions as
provided for {\WRspice} expressions.  This is separate from the
script expression parser, but rather similar in operation (the two
may merge some day).  The new expression handler accepts the {\it a}
?  {\it b} :  {\it c} construct, which is one difference.
  
Before evaluation, all parameter definitions in the electrical
current cell are tabulated.  This includes the {\et param} properties
of the cell, and any {\vt .param} lines found in labels on the SPTX
layer.  Parameters found can be used by name in the expression.

% -----------------------------------------------------------------------------
% !check 110613
\subsection{The {\cb !check} Command: Database Consistency Check}
\index{"!check command}
\index{consistency check}
\begin{quote}
Syntax: {\vt !check}
\end{quote}
This command will perform a consistency check of the electrical part
of the current cell, and report any problems on the console screen. 
Additionally, all labels which are not associated with a device or
other property will become selected.  This command is for debugging
purposes.  These checks are also performed when a new cell is read
into {\Xic}, with error messages directed to the log file.  If errors
are found, in many cases they are repaired.  Use the {\cb !check}
command a second time to verify if the condition still exists.

Messages may be added to the {\vt read\_{\it xxx}.log} file produced
when input is read if repairs were made.

% -----------------------------------------------------------------------------
% !regen 053108
\subsection{The {\cb !regen} Command: Regenerate Labels}
\index{"!regen command}
\index{consistency check!regeneration}
\begin{quote}
Syntax: {\vt !regen}
\end{quote}
The {\cb regen} command will regenerate all missing property labels
in the schematic.  This is useful if a label was accidently deleted or
otherwise lost due to some error.

% -----------------------------------------------------------------------------
% !devkeys 030415
\subsection{The {\cb !devkeys} Command: Print Device keys}
\index{"!devkeys command}
\index{device keys}
\begin{quote}
Syntax: {\vt !devkeys}
\end{quote}
This will dump the current device key mapping table to the console
window.  The device keys are set in an internal table, which can be
augmented or overridden by setting {\et DeviceKeyV2} properties in the
device library ({\vt device.lib}) file.


\section{Extraction}

% -----------------------------------------------------------------------------
% !antenna 051809
\subsection{The {\cb !antenna} Command: Check MOS Antenna Effect}
\index{"!antenna command}
\begin{quote}
Syntax: {\vt !antenna} [{\it layer\_name} {\it layer\_min\_ratio\/}]...
[{\it min\_ratio\/}]
\end{quote}

In the design of CMOS circuits, design rules and guidelines often
provide a limit on the area of a wire net connected to a MOS gate. 
During processing, the wire net can act as an ``antenna'' which
accumulates charge, potentially damaging the thin MOS gate oxide. 
This command provides checking of antenna nets.

Note that this is part of the extraction system and not DRC.  The DRC
system presently does not maintain a sophisticated enough state to
identify device contacts or follow wire nets.

The {\cb !antenna} command utilizes the values of the technology file
extraction keywords {\et Antenna} (in physical layer blocks) and {\et
AntennaTotal}.  These keywords provide values which are used as
defaults, which can be overridden from the command line.

If given without arguments, the {\cb !antenna} command will generate
an argument list constructed from the defaults (if any).  This is
displayed in the prompt area, where it can be edited by the user.  The
run begins when the user presses the {\kb Enter} key.  If there are no
defaults, or if an argument was given to the command, there is no
prompt and the command runs immediately.

With no parameters given, the command will identify and print an entry
for each wire net in the hierarchy of the current cell which connects
to a MOS gate.  The results go to a file, created in the current
directory, named {\it cellname\/}{\vt .antenna.log}, where {\vt
cellname} is the name of the current cell.  The user is given a chance
to view this file when the operation completes.

The parameters provide a ``filtering'' function, whereby only entries
outside of the filter range are printed in the file.  The filtering
parameter is the ratio of wire net area to total gate area connected
to the net.  These ratios can apply to individual layers contained in
the wire net, or the total wire net area.  Only entries that exceed
given parameters are printed in the log file.
 
For example,
\begin{quote}
\vt !antenna POLY 20 M1 30 50
\end{quote}

This will print wire nets where at least one of the following is
true:
\begin{enumerate}
\item{The ratio of POLY area to gate area exceeds 20.}
\item{The ratio of M1 area to gate area exceeds 30.}
\item{The ratio of total wire net area to gate area exceeds 50.}
\end{enumerate}

Thus, the log file will typically contain only those nets that exceed
the guidelines.

These ``bad'' nets can be displayed in the {\cb Select Path} mode of
the {\cb Path Selection Control} panel.  After the {\cb !antenna}
command has been run, and/or with the log file in the current
directory, pressing the {\cb Load Antenna file} button or the {\kb f}
key will prompt for an antenna net number.  This is the number in the
log file that begins the report for each net.

The file will be accessed, and the corresponding wire net will be
extracted and highlighted.  The wire net is identified via the
reference bounding box provided in the log file, on the same line as
the net number.


% -----------------------------------------------------------------------------
% !netext 021318
\subsection{The {\cb !netext} Command: Batch Physical Net Extraction}
\index{"!netext command}
\index{netlist extraction}
\begin{quote}
Syntax: {\vt !netext} {\it arguments\/}...
\end{quote}
PRELIMINARY -- This is the initial implementation of a new capability. 
Feedback and wish-lists from users is encouraged.

The {\cb !netext} command performs identification and extraction of
physical wire nets from a layout.  There are a number of modes and
features, but the final result is generally an OASIS file containing a
top-level cell with the same name as the original top-level cell,
which contains a subcell for every wire net.  Each subcell contains
all of the conductors that comprise the net, as if the original
hierarchy were flat.  This file can be used as a starting point for
further analysis, such as parasitic extraction using a field solver.

The full operation is performed in three stages.

\subsubsection{Stage 1}

\begin{enumerate}
\item{Create a Cell Hierarchy Digest (CHD) in memory for the input
file, if necessary.}

\item{Divide the area of the top-level cell into a logical grid.}

\item{For each grid area, the CHD is used to read into memory a flat
representation of the grid area, clipped to the grid.}

\item{The wire nets for this area are identified.  This can take
into account device structures and exclusion areas.}

\item{An OASIS file is written to disk, which contains a subcell for
each net found.  Up to four edge-mapping files are also produced,
one each for the edges that are shared with another grid cell.
These files map the parts of the edge which coincide with the edge
of a conducting object.}
\end{enumerate}

At the end of Stage 1, the work area on disk contains a number of
OASIS files, one for each grid cell, and associated edge mapping
files.

Note that the grid areas are processed sequentially.  On a computer
with limited memory, the grid size should be ``small'' so as to not
exhaust available memory, but even a modest computer can process very
large files.  Note also that in theory this stage could easily be
accelerated by use of multiple computers.  Stage 1 is the most
compute-intensive part of the flow.

\subsubsection{Stage 2}

The second stage compares the two edge files for each shared grid
boundary, and generates an equivalence file.  The equivalence file
maps between the nets that abut at grid boundaries.  Once the edge
files have been processed, the edge files are deleted.

\subsubsection{Stage 3}

In the final stage, the individual OASIS files for each grid cell are
combined, using the equivalence file, into a single OASIS file.  There
are two ways that nets that extend across grid boundaries can be
handled.  The ``easy'' way is to simply copy all net cells from all
grid areas into the output.  For the nets that connect to other nets,
choose a ``primary'' subnet (cell).  In this cell, instantiate the
other net cells to which the primary subnet connects.

The alternative is to actually copy the subnet cell geometry into the
primary cell.  This format is easier to work with, but requires more
time and memory to construct.

When the output file is written, the equivalence file and the Stage 1
OASIS files are deleted, and the operation is complete.

If a net has an assigned name in the source file, (e.g., through a
label or from a terminal) A NXNAME property will be given to the
created net files.  This is property number 7149, and the string is
the net name.  This is not presently used by {\Xic}, but the net name
may be useful to the user.  Beware if using a grid:  if flattening,
the top net cell will contain the net name properties from all grid
cells, so there may be duplicate or inconsistent name properties.  If
not flattening, the primary and all subcells should be checked, each
property applies only to the corresponding grid location.  In either
case, conflicting names would need to be dealt with somehow.

\subsubsection{Command Arguments}

\begin{description}
\item{\vt -f} {\it filename}\\
This mandatory argument specifies the input source for batch net
extraction.  the {\it filename} can be a path to a layout file in a
supported format, the access name of a CHD in memory, or a path to a
saved CHD file.

The technology file in use must match the source file, with the
extraction parameters and keywords properly set up.

\item{\vt -c} {\it cellname}\\
This provides the name of the top-level cell for extraction.  If not
given, the top-level cell used will be either the cell configured into
the CHD source, if any, or the lowest-offset top-level cell found in
the source layout file.

\item{\vt -g} {\it gridsize}\\
if the ``{\vt -w}'' (windowing) option is not given, this sets the
grid size, in microns.  Use of a grid minimizes memory consumption for
handling large designs.  For smaller designs gridding may not be
necessary, so this option can be skipped or given as 0.  In this case
the entire bounding box of the top-level cell is understood.  The
OASIS file is produced, but there are no edge files, and no Stage 2 or
Stage 3 steps.

The choice of a grid size is machine and layout dependent.  The
objective is to choose as large a grid as possible, without exceeding
memory limits or causing excessive page-swapping.  In general, some
experimentation may be required to find the ``best'' grid size.  A
starting point of 400 microns may be reasonable.

\item{\vt -v}\\
If given, via objects will be included in the netlist cells and files. 
Via layers are the layers with the {\et Via} keyword given in the
technology file.  The objects on these layers are clipped to the
intersection areas of the two associated conductors.

\item{\vt -v+}\\
This is similar to {\vt -v}, but in addition the ``check layers'' (if
any), clipped to the via object, will also be included in net cells
and files.  The check layers are the layers used in the optional layer
expression supplied on the {\vt Via} line.  This expression must be
``true'' for a via object to actually represent a connection.  With
{\vt -v} given, the included vias are those that pass the check
criteria, but the check layers are not included.  With {\vt -v+}, the
check layers will be included.

If the generated netlist file is read back into {\Xic} and extraction
run, the {\vt -v+} option will allow the nets to be correctly
re-extracted.  If the check layers are missing, this may fail, and
extraction would certainly fail if vias are not included at all.

\item{\vt -vs}\\
When there is no windowing or gridding in use and this option is
given, standard vias will be retained as they are rather than being
converted to equivalent geometry.  The net cells will contain the
standard via placements from the net, from all hierarchy levels, as
subcells.  Presently, this requires that the standard via sub-masters
not be included in the source layout file, i.e., they are created
within {\Xic} as the file is read.

\item{\vt -w} {\it l\/},{\it b\/},{\it r\/},{\it t}\\
If a window is given, a grid size should not be given and will be
ignored.  In this case, there is no grid, and the rectangular area
given, as comma-separated dimensions in microns, is read into memory
and processed as if it were a grid cell.  The OASIS file is produced,
but there are no edge files, and no Stage 2 or Stage 3 steps.  If all
values are 0, the effective area is the bounding box of the top-level
cell, which is the default when no area or grid is given.

\item{\vt -b} {\it basename}\\
This supplies a basename for the generated files.  It can have a path
prefix, which will cause the generated files to be written in the
given directory, which must exist.  If this argument is not given, the
name of the top-level cell is used as the basename.

\item{\vt -nf}\\
By default, in Stage 3 processing, the net cells will be flat.  If
this argument is given, subnets will appear is cell instances in the
``primary'' net cell.

\item{\vt -nc}\\
This will turn off compression in OASIS output files.  This is not a
good idea, unless compression is not supported by the reader.

\item{\vt -ne}\\
This turns off the part of the extraction that recognizes device
structures, leaving only conductor grouping for connectivity
determination.  This may be fine for some applications, and avoids
computation.  In MOS circuits, for example, if the Active layer is
assumed to be a conductor, then all FETs will be shorted, drain to
source.  However, using a {\et Conductor Exclude} directive for Poly
on Active should fix this.

\item{\vt -l}\\
If this is given, when the flat data are read into memory for
processing, any existing layer filtering is kept.  Without this
option, when {\vt -ne} is not given, all layers are read since these
may affect device recognition.  When {\vt -ne} is given, only
{\et Conductor} and {\et Via} layers are read.

\item{\vt -k}\\
If given, all working files are retained.  Without this option, edge
files, etc.  are deleted when no longer needed.

\item{\vt -s1}\\
If given, the operation will stop at the end of Stage 1.

\item{\vt -s2}\\
If given, the operation will stop at the end of Stage 2.
\end{description}

The grid cells are assigned x,y index numbers, according to position,
with the 0,0 cell located in the lower left corner.  The cells are
traversed left to right by row, from bottom to top.  Each net in a
grid is assigned a number, which is the group number from extraction. 
All three numbers are non-negative, and the triplets represent a
unique designation for a subnet.  The net cells in the Stage 1 OASIS
files files are names ``{\it x\_y\_n\/}'', i.e., the three numbers
separated by underscores.

In the final OASIS file, the net cells are renamed {\vt n1}, {\vt n2},
..., replacing the triples with an index number.  If instantiation is
used, the subnet cells that are not primary nets retain the original
names.  The primary subnet from among a group of connected subnets is
the one that is lowest in ``traversal order'', which is the lowest
group number in the first grid cell seen in a sweep left to right in
the rows, ascending in y.

% -----------------------------------------------------------------------------
% !addcells 020615
\subsection{The {\cb !addcells} Command: Add Missing Cells}
\index{"!addcells command}
\begin{quote}
Syntax: {\vt !addcells}
\end{quote}
This command adds ``missing'' instances to the current cell, in
physical or electrical mode.  An instance is ``missing'' if it is
referenced in the opposite mode of the current cell, but does not
appear in the current cell.  Cells are not added if they are empty. 
The new instances are arrayed below existing objects.  For example,
suppose one creates a schematic consisting of several subcells from
some library.  One can then switch to physical mode and use this
command to obtain the physical instances, which can then be moved into
place.  This avoids having to use the {\cb place} command (in the side
menu).

% -----------------------------------------------------------------------------
% !find 070809
\subsection{The {\cb !find} Command: Find Devices}
\index{"!find command}
\begin{quote}
Syntax: {\vt !find} {[{\it devicename\/}[.{\it prefix\/}[.{\it index\/}]]]}
\end{quote}
This command will find and highlight devices in physical layout
windows showing the current cell, and also highlight the corresponding
device symbols in windows showing the schematic of current cell.  It
is basically a command line version of the device listing/highlighting
feature of the {\cb Show/Select Devices} panel from the {\cb Device
Selections} button in the {\cb Extract Menu}.
 
The argument list consists of at most three fields, separated by
periods.  Missing fields are wildcards.  The {\it devicename} is one
of the names from a device block in the technology file.  The {\it
prefix} is from the {\vt Prefix} line of the device block.  The {\it
indices} is a list of space or comma-separated integers, or
hyphen-separated ranges of integers.  The integers are the index
values of the physical devices.  If this field is not given, any index
value will be highlighted, otherwise only the devices with an index
that matches a value or falls in a range will be highlighted.

With no argument, any existing device highlighting will be erased.

If the first component is empty, or the keyword {\vt all}, all devices
known from the technology file are acted on.  Thus, ``{\vt !find
all}'' or ``{\vt !find .}'' will display all known devices.  One can
also give, for example, ``{\vt !find ..1}'' which will show all
devices with index 1.

% -----------------------------------------------------------------------------
% !ptrms 053108
\subsection{The {\cb !ptrms} Command: Default Terminal Locations}
\index{"!ptrms command}
\begin{quote}
Syntax: {\vt !ptrms} {\vt l}{\vt |}{\vt t} [{\vt r}]
\end{quote}
Options can be space separated or grouped.  At least one of {\vt l},
{\vt t} must be given.  If {\vt l} is given, the cell label markers
will be moved to the default locations to the right of the parent
cell.  If {\vt t} is given, all device terminals will be undefined and
moved to the lower left of the parent cell.  These actions can not be
undone.  If {\vt r} is given, the operation is performed recursively
on subcells.  The characters {\vt c}, {\vt d} are equivalent to {\vt
l}, {\vt t}.  This command is used primarily for debugging purposes.

% -----------------------------------------------------------------------------
% !ushow 013013
\subsection{The {\cb !ushow} Command: Show Unassociated Elements}
\index{"!ushow command}
\begin{quote}
Syntax: {\vt !ushow} [{\it types\/}]
\end{quote}
This command will highlight unassociated objects.  These are objects
in physical mode that have no identified electrical counterpart, and
vice-versa.

The {\it types} argument is a word containing characters that indicate
the object types to display:
\begin{quote}
\begin{tabular}{ll}
{\vt g} or {\vt n} & groups/nodes\\
\vt d & devices\\
{\vt s} or {\vt c} & subcells/subcircuits\\
\end{tabular}
\end{quote}

If this argument is omitted, ``{\vt gds}'' is the effective value,
which will show all unassociated groups, devices, and subcircuits.

The command works in physical and electrical modes.  Display windows
will highlight the appropriate unassociated objects for the window's
display mode.

The highlighting is removed on a deselect operation, with the menu
button or otherwise.  Mostly, the objects are simply selected, however
objects such as physical devices use other highlighting methods.


% -----------------------------------------------------------------------------
% !fc 090714
\subsection{The {\cb !fc} Command: Control Capacitance Extraction Interface}
\index{"!fc command}
\begin{quote}
Syntax: {\vt !fc} {\it keyword} [{\it arg\/} ...]
\end{quote}
This command is a prompt-line equivalent to some of the functionality
of the capacitance extraction interface described in \ref{fcinterf}. 
This interface is also controlled from the {\cb Cap Extraction} panel,
which is produced by the {\cb Extract C} button in the {\cb Extract
Menu}.

The first argument is a keyword, which must be present and must be one
of those listed below.  Additional arguments are specific to the
keyword.  The keywords perform an operation that is equivalent to
pressing one of the buttons in the {\cb Cap Extraction} panel.

\begin{description}
\item{\vt dump} [{\it filename\/}]\\
This will dump a unified list file using the name given in the
argument, or the default name if no name is given.  The default name
is the name of the current cell with a ``{\vt .lst}'' suffix.

This is equivalent to pressing the {\cb Dump Unified List File} button
in the {\cb Run} page of the {\cb Cap Extraction} panel.  The format
is compatible with the {\it FasterCap} program from {\et
FastFieldSolvers.com}, and also the Whiteley Research version of {\it
FastCap}, the latter requires use of the {\et FcPanelTarget} variable.

\item{\vt run} [{\vt -i} {\it infile\/}] [{\vt -o} {\it outfile\/}]
 [{\vt -r} {\it resultfile}]\\
If an {\it infile} is specified, that file will be taken as input to
the capacitance extraction program, as if the {\cb Run File} button in
the {\cb Run} page of the {\cb Cap Extraction} panel was pressed and
the {\it infile} specified in the text input area.  Otherwise, the
action is as if the {\cb Run Extraction} button was pressed instead.

The {\it outfile} is the file used for standard output from the
extraction program during the run.  If not given, a temporary file
will be used, and destroyed when the run completes, after copuying the
content to the results file.  If a name is provided, that file name
will be used, and the file will not be destroyed.

If no name is given for the {\it resultfile}, a default name will be
used.  This file will contain input to and output from the extraction
run.
\end{description}

% -----------------------------------------------------------------------------
% !fh 090714
\subsection{The {\cb !fh} Command: Control Inductance/Resistance Extraction
 Interface}
\index{"!fh command}
\begin{quote}
Syntax: {\vt !fh} {\it keyword} [{\it arg\/} ...]
\end{quote}
This command is a prompt-line equivalent to some of the functionality
of the inductance/resistance extraction interface described in
\ref{fhinterf}.  This interface is also controlled from the {\cb LR
Extraction} panel, which is produced by the {\cb Extract LR} button in
the {\cb Extract Menu}.

The first argument is a keyword, which must be present and must be one
of those listed below.  Additional arguments are specific to the
keyword.  The keywords perform an operation that is equivalent to
pressing one of the buttons in the {\cb LR Extraction} panel.

\begin{description}
\item{\vt dump} [{\it filename\/}]\\
This will dump a {\it FastHenry} input file using the name given in the
argument, or the default name if no name is given.  The default name
is the name of the current cell with a ``{\vt .inp}'' suffix.

This is equivalent to pressing the {\cb Dump FastHenry File} button
in the {\cb Run} page of the {\cb LR Extraction} panel.

\item{\vt run} [{\vt -i} {\it infile\/}] [{\vt -o} {\it outfile\/}]
 [{\vt -r} {\it resultfile}]\\
If an {\it infile} is specified, that file will be taken as input to
the inductance/resistance extraction program, as if the {\cb Run File}
button in the {\cb Run} page of the {\cb LR Extraction} panel was
pressed and the {\it infile} specified in the text input area. 
Otherwise, the action is as if the {\cb Run Extraction} button was
pressed instead.

The {\it outfile} is the file used for standard output from the
extraction program during the run.  If not given, a temporary file
will be used, and destroyed when the run completes, after copuying the
content to the results file.  If a name is provided, that file name
will be used, and the file will not be destroyed.

If no name is given for the {\it resultfile}, a default name will be
used.  This file will contain input to and output from the extraction
run.
\end{description}

\section{Graphics}

% -----------------------------------------------------------------------------
% !setcolor 053108
\subsection{The {\cb !setcolor} Command: Set Attribute Colors}
\index{"!setcolor command}
\index{resources}
\index{colors}
\begin{quote}
Syntax: {\vt !setcolor {\it resourcename colorspec}} \\
\end{quote}
This command changes the attribute colors used within {\Xic}.  The
{\it resourcename} is a color keyword or alias from the list of
attribute colors (see \ref{attrcolors}).  The {\it colorspec} is the
name of a color or RGB triple in the same format as used in the
resource file.  Changing the colors will in general not change
appearance until the feature is redrawn.

% -----------------------------------------------------------------------------
% !display 053108
\subsection{The {\cb !display} Command: Export Rendering}
\index{"!display command}
\begin{quote}
Syntax: {\vt !display {\it display\_string} {\it win\_id}}
\end{quote}
This command will render the current cell in a foreign X window.  The
X window id is passed as an integer in the second argument.  The first
argument is the X display string corresponding to the server in which
the window is cached.  The area to display is the same area currently
defined for the main drawing window.  See the corresponding {\vt
Display} script function for more information.


\section{Grid}

% -----------------------------------------------------------------------------
% !sg 043009
\subsection{The {\cb !sg} Command: Save Grid in Register}
\index{"!sg command}
\index{grid}
\begin{quote}
Syntax: {\vt !sg [{\it regnum\/}]} \\
\end{quote}
There is a set of eight registers that can hold grid parameters. 
Thus, grids can be saved and quickly restored.  Whenever the grid is
changed, for example with the {\cb Set Grid} command in the {\cb Main
Window} sub-menu of the {\cb Attributes Menu}, the previous grid is
saved in register 0.

This will save the grid of the drawing window containing the pointer
(or the main drawing window if the pointer is not in a drawing window)
into register {\it regnum}.  The {\it regnum} must be an integer 0--7,
and is taken as 0 if not given.

The grid can be restored from a register with the {\cb !rg} command.

% -----------------------------------------------------------------------------
% !rg 053108
\subsection{The {\cb !rg} Command: Set Grid From Register}
\index{"!rg command}
\index{grid registers}
\begin{quote}
Syntax: {\vt !rg} [{\it regnumber}]
\end{quote}
This will set the grid of the drawing window containing the pointer
(or the main drawing window if the pointer is not in a drawing window)
to the grid stored in {\it regnum}.  The {\it regnum}, if given, is an
integer 0--7.  If not given, 0 is understood.  A register that has not
been saved will return a default grid style (1 micron, no snapping,
dot grid).  In addition, the grid storage register 0 takes the value
of the previous grid.

The grid can be saved to a register with the {\cb !sg} command.


\section{Help}

% -----------------------------------------------------------------------------
% !help 012016
\subsection{The {\cb !help} Command: Help Interface}
\index{"!help command}
\begin{quote}
Syntax: {\vt !help} {\it word}
\end{quote}
\index{help mode!keyword input}
This is a back-door to the help system.  The {\it word\/} is a keyword
expected to be found in the help database, or a path to a text, html,
or image file to view, or a URL string to access on the internet.  If
no {\it word} is given, a default help topic is shown.

The command invocation is aliased to the question mark (`{\vt ?}')
key.

Information on the help database is provided in \ref{helpfiles}.  All
menu commands have a short name which is given in the ``tooltip''
which appears when the pointer is stationary over the command button
for a second or two.  The help database keyword is generally this
name, prefixed with ``{\vt xic:}''.

{\rr
General URLs must have the protocol specifier given.  For example,
``{\vt http://wrcad.com}'' is correct, giving only ``{\vt wrcad.com}''
will not work.
}

The ``help mode'', where pressing menu buttons brings up help topics,
which is active when the help is accessed through the {\cb Help Menu},
is not active when the {\cb !help} command is used.

% -----------------------------------------------------------------------------
% !helpfont 012016
\subsection{The {\cb !helpfont} Command: Set Help Font}
\index{"!helpfont command}
\begin{quote}
Syntax: {\vt !helpfont} {\it fontfamily-size}
\end{quote}
\index{help!font}
This specifies the default proportional font family used in HTML
viewer (help) windows, and applies to Linux/macOS releases only. 
Under Microsoft Windows, this command does nothing.  This is the font
used to render most text in the help windows.

If no argument is given, the font reverts to the internal default.

The {\it fontfamily-size} is given as a face name, followed by white
space, followed by the base pixel size.  The internal default is
``{\vt Sans 9}''.

This command has limited value, as the fonts are most conveniently set
with the {\cb Font Selection} panel available in the {\cb Attributes
Menu} and from the help windows.

% -----------------------------------------------------------------------------
% !helpfixed 012016
\subsection{The {\cb !helpfixed} Command: Set Help Fixed Font}
\index{"!helpfixed command}
\begin{quote}
Syntax: {\vt !helpfixed} {\it fontfamily-size}
\end{quote}
\index{help!fixed font}
This specifies the default fixed font family used in HTML viewer
(help) windows, in Linux/macOS releases only.  Under Microsoft
Windows, this command does nothing.  The fixed font is used to render
typewriter and preformatted text.

If no argument is given, the font reverts to the internal default.

The {\it fontfamily-size} is given as a face name, followed by white
space, followed by the base pixel size.  The internal default is
``{\vt Monospace 9}''.

This command has limited value, as the fonts are most conveniently set
with the {\cb Font Selection} panel available in the {\cb Attributes
Menu} and from the help windows.

% -----------------------------------------------------------------------------
% !helpreset 053108
\subsection{The {\cb !helpreset} Command: Clear Help Cache}
\index{"!helpreset command}
\begin{quote}
Syntax: {\vt !helpreset}
\end{quote}
\index{help!clear cache}
This will clear the internal topic cache used by the help system.  The
cache saves topic references as offsets into the help ({\vt .hlp})
files, so that if the text of a help file is modified, the offsets are
probably no longer valid.  This function is useful when editing the
text of a help file, while viewing the entry in {\it Xic}.  Use this
function when editing is complete, before reloading the topic into the
viewer.  Although the offset to the present topic does not change when
editing, so that simply reloading would look fine, other topics in the
file that come after the present topic would not display correctly if
the offsets change.


\section{Keyboard}

% -----------------------------------------------------------------------------
% !kmap 053108
\subsection{The {\cb !kmap} Command: Read Key Mapping File}
\index{"!kmap command}
\begin{quote}
Syntax: {\vt !kmap} {\it mapfile}
\end{quote}
This will read a key mapping file as produced from the {\cb Key Map}
button in the {\cb Attributes Menu}.  The key mapping feature allows
non-standard keyboards to be used with {\Xic} without loss of
features.

This command allows a mapping to be applied at any time.  Older {\Xic}
releases would automatically read a mapping file if found at startup. 
This is no longer true, map files must be read explicitly, either with
this command, or with the {\vt ReadKeymap} script funtion.  The
operation can be performed from a starcup script if the mapping is
expected to always be applied.

If the {\it mapfile} is not rooted, it will be searched for in the
current directory, the user's home directory, and along the library
search path, in that order.


\section{Layers}

% -----------------------------------------------------------------------------
% !ltab 101212
\subsection{The {\cb !ltab} Command: Modify Layer Table}
\index{"!ltab command}
\begin{description}
\item{Syntax:}\\
 {\vt !ltab} {\vt a}[{\vt dd}]    {\it layername ...}\\
 {\vt !ltab} {\vt i}[{\vt nsert}] {\it layername} [{\it index\/}]\\
 {\vt !ltab} {\vt rem}[{\vt ove}] {\it layername ...}\\
 {\vt !ltab} {\vt ren}[{\vt ame}] {\it oldname newname}\\
\end{description}
This command has multiple forms, corresponding to the keyword given as
the first argument.  Only the initial letters needed to identify the
keyword are required.  The manipulations available from this command
can also be performed graphically with the {\cb Layer Editor} from the
{\cb Attributes Menu}.

If the second word is recognized as ``{\vt add}'', and the remaining
tokens are valid layer names, layers are created (or extracted from
the removed list) and added to the end of the layer table.

If the second word is recognized as ``{\vt insert}'', and the token
that follows is a valid layer name, the layer will be inserted into
the layer table at a position given by the integer {\it index}.  If
the {\it index} is missing, negative, or larger than the number of
layers in the table, the layer is appended to the table.  If the index
is zero, the layer will be inserted at the index of the current layer. 
Otherwise, the layer is inserted into the table at the position given
by the index, with one being the first (topmost) position.

The ``{\vt remove}'' form removes the listed layers from the layer
table.  Removed layers are saved, and can be reinserted if needed.

The ``{\vt rename}'' form renames the layer named {\it oldname}
to {\it newname}.

% -----------------------------------------------------------------------------
% !ltsort 053108
\subsection{The {\cb !ltsort} Command: Alphanumerically
 Sort Layer Table}
\index{"!ltsort command}
\begin{quote}
Syntax: {\vt !ltsort}
\end{quote}
This command will sort the layers in the layer table into alphanumeric
order.  This may be useful when examining the layers from an unknown
archive file when {\Xic} is started without a technology file.  This
operation is not undoable.

% -----------------------------------------------------------------------------
% !exlayers 012016
\subsection{The {\cb !exlayers} Command: List layers by Applied Keywords}
\index{"!exlayers command}
\begin{quote}
Syntax: {\vt !exlayers}
\end{quote}
This command will list in the console window layers in the current
technology that have the following keywords set:
{\vt Conductor}, {\vt Routing}, {\vt GroundPlane}, {\vt Contact},
{\vt Via}, {\vt Dielectric}, {\vt Planarize}, {\vt DarkField}.


\section{Layout Editing}

% -----------------------------------------------------------------------------
% !array 012309
\subsection{The {\cb !array} Command: Manipulate Instance Arrays}
\index{"!array command}
\begin{quote}
Syntax: \parbox[t]{5in}{
    {\vt !array -u}\\
    {\vt !array -d} [{\it nx1\/}[--{\it nx2\/}] , [{\it ny1\/}[--{\it ny2\/}]]\\
    {\vt !array -r} [{\vt nx} [$+$]= {\it val\/}]
      [{\vt ny} [$+$]= {\it val\/}]
      [{\vt dx} [$+$]= {\it val\/}] [{\vt dy} [$+$]= {\it val\/}]
}
\end{quote}

This command manipulates instance arrays.  There are three forms:
        
\begin{description}
\item{\vt !array -u}\\
This will ``unarray'' all selected arrays.  The arrays are converted
to individual instance placements, in the same location and
orientation as the original array elements.

\item{{\vt !array -d} [{\it nx1\/}[--{\it nx2\/}] ,
 [{\it ny1\/}[--{\it ny2\/}]]}\\
This form will delete a rectangular region of array elements.  The
undeleted elements will be configured into a new collection of arrays
or single instance placements.

The command operates on a selected instance array, the most recently
selected if there is more than one.

If no arguments follow the option character, the user is asked to
click on or drag over the array, to define two points.  The two points
are transformed back into the coordinate system of the instance
master, and define a rectangular region in the array indices in that
space.  The elements corresponding to this rectangle are deleted, and
new arrays or separate instances are created to replace the undeleted
elements.

Otherwise, the range of x and y indices to delete is given on the
command line.  These indices are non-negative 0-based, and the x and y
ranges are separated by a comma.  A range can be a single number, or
two numbers separated by `--'.  If a single number, the range is taken
as that number only.

In the untransformed array, the 0,0 location is the lower-left
corner.

{\bf Example}:\\
Suppose that a 3x3 array is selected.\\
Erase the middle element: {\vt !array -d 1,1}\\
Erase the rightmost column: {\vt !array -d 2,0-2}

\item{{\vt !array -r} [{\vt nx} [$+$]= {\it val\/}]
      [{\vt ny} [$+$]= {\it val\/}]
      [{\vt dx} [$+$]= {\it val\/}] [{\vt dy} [$+$]= {\it val\/}]}\\
This will reconfigure the array parameters of the first selected
instance.  It can convert instances into arrays and vice-versa.

All of the parameter groups are optional, but at least one group
should be given or the operation does nothing.  Each is in the form
{\it keyword} [$+$]= {\it value\/}.  It a `$+$' appears ahead of the
`=', the {\it value} will be added to the existing value, otherwise
the {\it value} is assigned.  White space around `=' or `$+$=' is
optional.  The {\vt nx} and {\vt ny} are the number of columns and rows
in the untransformed array.  These integer values must be one or
larger.  The {\vt dx} and {\vt dy} are the array cell spacing in the
untransformed x and y directions, given in microns.

{\bf Examples}:\\
Add a column to the selected array:  {\vt !array -r nx+=1}\\
Add 1.5um additional space between elements: {\vt !array -r dx+=1.5 dy+=1.5}
\end{description}


% -----------------------------------------------------------------------------
% !layer 101515
\subsection{The {\cb !layer} Command: Generate Layers}
\label{layercmd}
\index{"!layer command}
\begin{quote}
Syntax: {\vt !layer [join|split|splitv] [-j | -s[h] | -sv]
 [-d {\it depth\/} | -da] [-r] [-c]
 [-m] [-f] {\it layer\_name} [=] [{\it expression\/}]}
\end{quote}
This command produces new geometry on a new or existing layer, by
applying a layer expression which takes as input geometry from the
same or other layers, from the current cell or from other cells in
memory.  The {\cb Layer Expression} button in the {\cb Edit Menu}
provides a panel which duplicates the functionality of this command.

This new geometry can appear as an assemblage of trapezoids if either
of the {\vt split} or {\vt splitv} keywords is given, or alternatively
as a minimal number of complex polygons if the {\vt join} keyword is
given instead.  If {\vt splitv} is given, a vertical orientation is
favored for the decomposition, whereas similarly {\vt split} will
produce a decomposition favoring a horizontal orientation.  The
default is the joined form if none of these optional keywords is
given, except when simply copying from another layer in which case the
default is to copy objects without change.  The keyword ``{\vt
splith}'' is a synonym for ``{\vt split}''.  The options {\vt -j},
{\vt -s} or {\vt -sh}, and {\vt -sv} are equivalent to giving the {\vt
join}, {\vt split}, and {\vt splitv} keywords.

The {\cb !layer} command, when using boolean operations, uses gridding
to improve efficiency for large data sets.  Internally, a square grid
with origin at the lower-left corner of the cell bounding box is
logically defined.  The calculations are performed for each grid
square that overlaps the cell area, and the results are combined. 
This can be more efficient that calculating the whole cell in one
shot.
 
The default grid size is 100 microns square, which can be changed
with the {\et PartitionSize} variable.  This can be set to an
alternate grid size in microns, as a floating-point number.  The cell
lower left corner is on the grid boundary.  The operations are
performed piecewise in each grid area that intersects the cell.

If this variable is set to ``0'', no grid is used, and operations 
will be performed over the entire cell at once.

The {\et PartitionSize} variable can be set with a control in the {\cb
Evaluate Layer Expression} panel from the {\cb Layer Expression}
button in the {\cb Edit Menu}, or with the {\cb !set} command.

When joining objects, there are several variables which fine-tune the
operation.  See the description of the {\cb !join} command
(\ref{joincmd}) for information.

If {\it layer\_name} does not exist in the layer table, it will be
created.  Otherwise, the {\it layer\_name} is the short or long name
of an existing layer.  If a new layer is created, its name is
generated from the given name in the same way as in the technology
file layer definitions.

The {\it expression}, if given, involves layer names and operators as
in the DRC layer expressions (see \ref{layerexp}).  The result of the
expression is created on {\it layer\_name}.  Thus, this command
provides a means of creating a new layer from geometry on existing
layers.  It operates on the physical part of the current cell.  Labels
are ignored.  The same {\it layer\_name} can exist on both sides of
the expression, in which case the contents of the {\it layer\_name} is
replaced with the result of {\it expression}.  The equal sign between
{\it layer\_name} and {\it expression} is optional.

If no {\it expression} is given, the new layer will be created if
necessary, which will be the only effect if done.  If the {\it
layer\_name} already exists, and one of the {\vt split}, {\vt splitv},
or {\vt join} keywords is given, the operation will be applied to that
layer, much like the {\cb !split} and {\cb !join} commands.

If the {\it expression} consists of a layer name only, the objects on
that layer will be copied to {\it layer\_name}, and split/joined if
the keywords are given.  When simply copying and/or joining/splitting,
no grid partitioning is used.

Copying and splitting/joining are available in electrical mode.  Other
operations require running the {\cb !layer} command in physical mode,
and apply to physical data.

There are several option flags which can be given.  These must appear
before {\it layer\_name} in the command line.  The options can be
given separately as shown in the syntax example above, or grouped,
e.g., ``{\vt -dmf} {\it depth\/}'' is equivalent to ``{\vt -d} {\it
depth} {\vt -m} {\vt -f}''.  Any combination of grouped or single
flags can be used.  If a group contains `{\vt d}', the token that
follows must be the {\it depth}.

\begin{description}
\item{\vt -j}\\
Equivalent to giving the {\vt join} keyword.

\item{\vt -s} or {\vt -sh}\\
Equivalent to giving the {\vt split} keyword.

\item{\vt -sv}\\
Equivalent to giving the {\vt splitv} keyword.

\item{\vt -d} {\it depth}, {\vt -da}\\
The {\it depth} is a non-negative integer indicating the depth into
the cell hierarchy to process.  It can also be a word starting with
the letter `{\vt a}' to indicate all levels.  If 0 (the default) only
objects in the current cell are processed.  If ``{\vt all}'', all
objects in the hierarchy may be used to generate the new objects,
effectively flattening.  The {\vt -da} variation is equivalent to
``{\vt -d all}''.

\item{\vt -r}\\
This applies when the {\it depth} is larger than 0.  When given, the
{\it expression} is evaluated in all cells in the hierarchy to {\it
depth\/}, using only objects in that cell and creating objects in that
cell.  This is very different from the behavior without this flag
given, which is to create all objects in the current cell.

\item{\vt -c}\\
By default, {\it layer\_name} is cleared before the {\it expression}
is evaluated, so that the layer contains only the result of the
operation on command completion.  If this flag is given, the layer
will not be cleared, so that the original objects will be retained on
the layer.

\item{\vt -m}\\
When this flag is set, objects added to {\it layer\_name} will be
merged with existing objects, using the same merging as established
with the {\cb Merge new boxes and polys with existing boxes/polys} and
{\cb Clip and merge new boxes only, not polys} check boxes in the {\cb
Editing Setup} panel from the {\cb Edit Menu}, or the corresponding
variables.  Use of full polygon merging can greatly increase
processing time, simple box clipping/merging has much lower overhead. 
Merging may reduce the object count in the layout.

The merging will defeat the purpose of the split keywords, so the user
should consider whether merging is appropriate.  Merging includes the
initial objects on the {\it layer\_name} if it is not cleared, and the
accumulated objects as evaluation takes place.

\item{\vt -f}\\
This flag indicates ``fast'' mode, where undo list generation and any
merging (other than a join operation) are skipped.  This operation is
not undoable, so this option should be used with care.  It speeds
processing and reduces memory use.

The user will be prompted to confirm before the operation is actually
initiated.
\end{description}

\subsubsection{Examples}

\begin{description}
\item{Clear layer M0:}\\
{\vt !layer M0 0}
\item{Copy M1 to layer NEW:}\\
{\vt !layer NEW M1}
\item{Copy the inverse of layer M1 to layer NEW:}\\
{\vt !layer NEW !M1}
\item{Copy the intersection areas of I1 and I2 to NEW:}\\
{\vt !layer NEW I1\&I2}
\item{Copy the R1 and R2 areas to NEW:}\\
{\vt !layer NEW R1|R2}
\end{description}

\subsubsection{Extended Layer Names}
The layer names in layer expressions in the {\cb !layer} command can
actually be given in an extended form:

\begin{quote}
{\it lname\/}[{\vt .}{\it stname\/}][{\vt .}{\it cellname\/}]
\end{quote}

Most generally, the ``layer'' name consists of three tokens, two of
which are optional (indicated by square brackets above).  The tokens
are separated by a period (`{\vt .}') character.  The individual
tokens can be double-quoted (i.e., using the double-quote (`{\vt "}')
character), which must be used if the tokens contain non-alphanumeric
characters.  The period separators must appear outside the scope of
any quoting.

\begin{description}
\item{\it lname}\\
This is a short or long layer name, as found in the layer table.
\item{\it stname}\\
The name of a symbol table which contains the {\it cellname}.
\item{\it cellname}\\
The name of a cell.
\end{description}

If only one separator appears, the token that follows is taken as the
{\it cellname}, and the current symbol table (see \ref{symtab}) is
assumed.

The {\it cellname} is the name of a cell used as the source for
geometry.  If no {\it cellname} is given, the name of the current cell
is understood.  The odd case of an empty {\it stname} indicates the
``{\vt main}'' symbol table, e.g., {\vt layer..cell} is equivalent to
{\vt layer.main.cell}.

If the {\it cellname} starts with the '{\vt \@}' character, and no
symbol table name is given, then the rest of the {\it cellname} is
taken as the name of a ``special'' database, as created with script
functions like {\vt ChdOpenZdb}.  If found, geometry will be obtained
from the database rather than a cell.  Otherwise, when a {\it
cellname} is given, the geometry is obtained from the given cell, as
if it were overlaid on the current cell.  The {\it cellname} (or any
of the three tokens) can be double quoted, and must be quoted if the
name contains a `{\vt .}' character, for example {\vt
CPG."mycell.xic"}.

If a {\it stname} is given, and the name matches an existing symbol
table name, the cell is obtained from that symbol table.  If the
symbol table name is given, the {\it cellname} field must appear, but
can be empty (a trailing period) which indicates the name of the
current cell.

If the {\it stname} is given, and the cell is not in this table, it
will be opened from disk into the given table (not the current table)
if found as a native cell file in the search path.

The coordinate origin of the source cell is taken as the origin of the
current cell.  The source cell must be in memory, or be in a native
cell in the search path.

Objects read from a ``special'' database are clipped to the boundary
of the cell being added to.  No such clipping is done when objects are
read from another cell.

\subsubsection{Advanced Examples}

Suppose one has two versions of a cell, {\vt cell} and {\vt
cell\_old}, and one needs to know if they differ on layer {\vt M1}. 
Open a dummy cell for editing, then issue
\begin{quote}\vt
!layer ZZ = M1.cell\symbol{94}M1.cell\_old
\end{quote}
Press the {\kb Home} key to view the entire cell space.  Any geometry
shown on the new dummy layer {\vt ZZ} is the exclusive-OR of the
geometry on {\vt M1} of the two cells, i.e., the difference.  If there
is no geometry on {\vt ZZ}, {\vt M1} is the same in {\vt cell} and
{\vt cell\_old}.

As a variation, suppose that the user has done the following:
\begin{quote}\vt
  {\it Set symbol table to} ``{\vt old}''.\\
  open oldstuff/mycell\\
  {\it Return to previous symbol table.}\\
  open newstuff/mycell
\end{quote}
There are two versions of {\vt mycell} in memory.  To compare the
layer {\vt M1} in the two cells, one could then enter
\begin{quote}\vt
  !layer ZZ M1\symbol{94}M1.old.
\end{quote}
Then the {\vt ZZ} layer, which consists of the exclusive-OR of old and
new {\vt M1} in {\vt mycell}, would be added to the current {\vt
mycell}.  Pressing the {\kb Tab} key undoes the addition.

Suppose one wants to import the inverse of the geometry on layer {\vt
VIA} from {\vt cell} into the current cell, also on layer {\vt VIA}:
\begin{quote}\vt
  !layer VIA = !VIA.cell
\end{quote}
The {\vt VIA} layer now consists of the inverse from {\vt cell}.  Any
geometry that existed on {\vt VIA} in the current cell before the
command was given is deleted.  The bounding box of the current cell
may have been expanded to include the bounding box of {\vt cell}.  The
area used to create an inversion is the rectangle bounding all cells
referenced in the expression, plus the current cell.

Suppose one simply wants to copy the geometry from layer {\vt M2} of
{\vt cell} into the current cell:
\begin{quote}\vt
      !layer M2 = M2.cell
\end{quote}
The {\vt M2} layer now consists of the geometry on {\vt M2} from {\vt
cell}.  The bounding box of the current cell may have been expanded,
in which case some of the {\vt M2} features may be off-screen (press
the {\kb Home} key to view the entire cell).  Any objects previously
existing on {\vt M2} in the current cell are deleted before the
operation.


% -----------------------------------------------------------------------------
% !mo 100412
\subsection{The {\cb !mo} Command: Move Objects}
\index{"!mo command}
\begin{quote}
Syntax: {\vt !mo} {\it x} [{\it y} [{\it layer\_name\/}]]
\end{quote}
The {\cb !mo} command will move selected objects to a new location
offset by {\it x}, {\it y} (in microns) from the original object.  If
not given, {\it y} is zero.

The third argument, if given, will allow a layer change during the
move.  It should be the name of a layer that is not the current layer. 
How this is applied depends on the setting of the {\et
LayerChangeMode} variable, or equivalently the settings of the {\cb
Layer Change Mode} pop-up from the {\cb Set Layer Chg Mode} button
in the {\cb Modify Menu}.  For the layer change, the passed {\it
layer\_name} is taken as the ``new current layer'', however the actual
current layer does not change.  Subcells are moved without regard to
{\it layer\_name} or the layer change mode.

There is a companion {\cb !co} (copy) command.

% -----------------------------------------------------------------------------
% !co 100412
\subsection{The {\cb !co} Command: Copy Objects}
\index{"!co command}
\begin{quote}
Syntax: {\vt !co} {\it dx} [{\it dy} [[-l] {\it layer\_name\/}]
 [[-r] {\it rep\_count\/}]]
\end{quote}
The {\cb !co} command will copy selected objects to new locations. 
The {\it dx} and {\it dy} are translation values in microns.  If {\it
dy} is not given, it is taken as 0.  A {\it dy} value must be given if
additional arguments are given.

There are two additional arguments than can appear:  a replication
count, and a layer name.  An integer value that is not identical to a
layer name is taken as a replication count, otherwise a layer name is
assumed.  The optional flags ``{\vt -l}'' and ``{\vt -r}'' can appear
ahead of the token to enforce the interpretation.

The replication count specifies how many copies, spaced by {\it
dx\/},{\it dy\/}, are generated.  For example, if the count is 2, new
objects would be created at offset {\it dx\/}, {\it dy\/}, and 2*{\it
dx\/},2*{\it dy\/}.  If not given, or the value is not in the range
1--100000, only one copy is made.

The {\it layer\_name} argument, if given, will allow a layer change
during the copy.  It should be the name of a layer that is not the
current layer.  How this is applied depends on the setting of the {\et
LayerChangeMode} variable, or equivalently the settings of the {\cb
Layer Change Mode} pop-up from the {\cb Set Layer Chg Mode} button
in the {\cb Modify Menu}.  For the layer change, the passed {\it
layer\_name} is taken as the ``new current layer'', however the actual
current layer does not change.  Subcells are copied without regard to
{\it layer\_name} or the layer change mode.

There is also a companion {\cb !mo} (move) command.

% -----------------------------------------------------------------------------
% !spin 012815
\subsection{The {\cb !spin} Command: Rotate Objects}
\index{"!spin command}
\begin{quote}
Syntax: {\vt !spin} {\it x y angle} [{\it layer\_name\/}]
\end{quote}
This command will rotate all selected objects about {\it x\/},{\it y}
(given in microns) by {\it angle} (given in degrees)
counter-clockwise.  The functionality is similar to the {\cb spin}
command in the side menu.

Subcells and labels will be rotated in increments of 45 degrees in
physical mode, 90 degrees in electrical mode, to the closest angle to
that given.  Other objects can be rotated by any angle.

The {\it layer\_name} argument, if given, will allow a layer change
during the rotation.  It should be the name of a layer that is not the
current layer.  How this is applied depends on the setting of the {\et
LayerChangeMode} variable, or equivalently the settings of the {\cb
Layer Change Mode} pop-up from the {\cb Set Layer Chg Mode} button
in the {\cb Modify Menu}.  For the layer change, the passed {\it
layer\_name} is taken as the ``new current layer'', however the actual
current layer does not change.  Subcells are rotated without regard to
{\it layer\_name} or the layer change mode.

% -----------------------------------------------------------------------------
% !rename 053108
\subsection{The {\cb !rename} Command: Rename Cells}
\index{"!rename command}
\index{renaming cells}
\begin{quote}
Syntax: {\vt !rename} [{\it prefix}] [[-s] {\it suffix}]
\end{quote}
The purpose of the {\cb !rename} command is to allow modification of
all of the cell names in a hierarchy.  In {\Xic}, every cell name in
the symbol table must be unique.  When combining designs from various
sources, it is necessary to take measures to avoid name clashes.  The
{\cb !rename} command allows the manipulation of prefixes/suffixes of
all of the cell names in a hierarchy.  For example, each cell name can
be prepended with a unique prefix, say the author's initials.

The {\it prefix} and {\it suffix} are string tokens.  If two string
tokens are given, the ``{\vt -s}'', which implies suffix, can be
skipped.  The string tokens can contain any alphanumeric characters
plus `\$', `?', `\_'.  String tokens given in this form will be
prepended/appended to the current cell name, and each cell name used
in the hierarchy.  The string tokens can also have the form /{\it
str}/{\it sub}/ which indicates a substitution.  This causes the {\it
str} if it appears as a prefix/suffix of a cell name to be replaced by
{\it sub}.  The {\it sub} can be empty (i.e., the form is /{\it
str}//) which can be used to undo the previous addition of a prefix or
suffix.  Forms like //{\it sub}/ are equivalent to just giving {\it
sub} as a string.

% -----------------------------------------------------------------------------
% !svq 012016
\subsection{The {\cb !svq} Command: Save Selections in Register}
\index{"!svq command}
\begin{quote}
Syntax: {\vt !svq} [{\it regnum\/}]
\end{quote}
This will save the current selections into a ``register'' which can be
recalled later with the {\cb !rcq} command.  There are ten registers
corresponding to given digits 0-9, or if no number is given 0 is
understood.

The registers are actually just dummy cells in memory, which will
appear in listings as ``{\vt \$\$\$\$REG0}'' through ``{\vt
\$\$\$\$REG9}''.  These should not be edited directly or instantiated.

% -----------------------------------------------------------------------------
% !rcq 053108
\subsection{The {\cb !rcq} Command: Recall Selections from Register}
\index{"!rcq command}
\begin{quote}
Syntax: {\vt !rcq} [{\it regnum\/}]
\end{quote}
This will recall the contents of the register whose index 0--9 is
given, attaching the objects to the mouse pointer where they can be
placed by clicking in an active drawing window.  The register must
have been defined previously with the {\cb !svq} command.  If no
number is given, 0 is understood.

% -----------------------------------------------------------------------------
% !box2poly 053108
\subsection{The {\cb !box2poly} Command: Object Type Conversion}
\index{"!box2poly command}
\begin{quote}
Syntax: {\vt !box2poly}
\end{quote}
This command converts selected boxes to polygons in the database.  The
command is not expected to be useful except for debugging purposes. 
The box database entry uses less space than that of a single polygon.

% -----------------------------------------------------------------------------
% !path2poly 053108
\subsection{The {\cb !path2poly} Command: Outline to Polygon
  Conversion}
\index{"!path2poly command}
\begin{quote}
Syntax: {\vt !path2poly}
\end{quote}
This will convert selected wires to polygons representing the wire
path.  The first and last vertex of the wire must be the same.  The
width and end style of the wire are ignored.  The polygon represents
the internal area specified by the path vertices.

% -----------------------------------------------------------------------------
% !poly2path 033009
\subsection{The {\cb !poly2path} Command: Polygon to Outline
  Conversion}
\index{"!poly2path command}
\begin{quote}
Syntax: {\vt !poly2path}
\end{quote}
This will convert each selected polygon to a wire, using the same path
as the polygon boundary, and the same layer as the polygon.  The wire
width will be the default width for wires on the layer.  The end style
of the wire will always be ``flush ends'', the default wire end style
for the layer will be ignored.

% -----------------------------------------------------------------------------
% !bloat 040316
\subsection{The {\cb !bloat} Command: Expand Objects}
\label{bloatcmd}
\index{"!bloat command}
\begin{quote}
Syntax: {\vt !bloat} {\it dimen} [{\it mode\/}]
\end{quote}
The {\it dimen} is a dimension in microns.  The command will operate
on selected objects, and alter the dimensions according to the {\it
dimen} given.  If the {\it dimen} is positive, the parts of edges that
do not contact or overlap with a selected object on the same layer
will be pushed out by {\it dimen}, expanding the objects.  If {\it
dimen} is negative, the reverse occurs:  objects will shrink, but
adjacent objects will remain touching.  Objects may be severed into
two or more pieces if the {\it dimen} is negative, or may disappear
entirely.

Only boxes, wires and polygons are affected.  Wires and and possibly
boxes become polygons after the operation.  An object is deselected if
it is modified.

There are a number of operational details and choices available with
the {\it mode} integer, whose bits represent flags.  This value can be
given as a decimal integer, or as a hexadecimal number following ``{\vt
0x}''.  If the {\it mode} argument is missing, a value of 0 is implied.

\begin{description}
\item{\bf bits 0-1} (0x1, 0x2)\\
The two LSBs specify the basic algorithm mode, as described below.

\item{\bf bit 2} (0x4)\\
When set, the algorithm mode calls the ``old'' bloating algorithms, as
used in releases prior to 2.5.67.  If this bit is set, all of the
other flag bits are ignored.

\item{\bf bit 3} (0x8)\\
When set, the return is the edge template, and no bloating is done. 
The edge template is a collection of polygons that cover the edges of
objects that would be bloated, as a path, whose width is twice the
{\it dimen}.  When bloating, the edge template is either added to the
objects being bloated, or clipped from them, depending on the sign of
{\it dimen}.

\item{\bf bits 4-7} (0x70)\\
These three bits specify the corner ``fill-in'' mode, used when
constructing the edge template.  Consider a vertex and two adjacent
edges.  Imagine the rectangles formed from these edges by constructing
parallel edges plus and minus {\it dimen} perpendicular to the edges,
and using the four endpoints of the parallel segments to define two
rectangles.  The two rectangles will overlap, with a notch at the
original vertex location.  Adding a suitable shape to fill in this
notch, thus creating a smooth transition, is the purpose of the corner
fill-in.

The corner fill-in shape has three points initially defined, the
vertex, and the two projections along the ends of the constructed
rectangles.  The differences between the fill-in modes is where (or
if) we add the fourth point to the fill-in polygon.  The choices are
as follows:

\begin{description}
\item{ bits 4-6: 000 (``clip'' mode)}\\
The angle is bisected, and the point added is a distance given
by the absolute value of {\it dimen} from the vertex, along
the bisector.  This produces a rounding effect at the corner.

\item{bits 4-6: 001 (``flat'' mode)}\\
No fourth point is added, only a triangle formed by the existing three
points is used.

\item{bits 4-6: 010 (``extend'' mode)}\\
The point added is the projected intersection of the outer edges of
the two rectangles.  For acute angles, the distance to the extended
vertex is unconstrained.

\item{bits 4-6: 011 (``extend-1'' mode)}\\
The point added is the projected intersection of the outer edges of
the two rectangles.  For acute angles, if the corner would extend too
far, is is clipped (similar to the "clip" mode).

\item{bits 4-6: 100 (``extend-2'' mode)}\\
This mode is similar to the "extend-1" mode, but provides a different
and more aggressive clipping of acute angles. 

\item{bits 4-6: 101 (unused)}\\
This code is reserved for expansion, produces no corner fill.

\item{bits 4-6: 110 (unused)}\\
This code is reserved for expansion, produces no corner fill.

\item{bits 4-6: 111 (no fill)}\\
This produces no corner fill.                                
\end{description}

Small angles will use the ``flat'' corner fill mode to avoid adding
unnecessary vertices, in all modes.

\item{\bf bit 7} (0x80)\\
When using the ``extend'' corner modes, it is possible in certain
geometries that the extended corner will occur on the opposite side of
an edge rectangle from some other edge, which will produce unexpected
features in the bloating result.  In order to prevent this, a rather
expensive test is performed.  Setting this bit will skip the test,
speeding up the operation somewhat.  In Manhattan geometry, this test
can always be skipped.

\item{\bf bit 8} (0x100)\\
Internally, the grouping operation that is part of the preparation for
the edge template generation is skipped.  This is an internal
artifact, and this flag should not be set.  However, if only a single
object is being bloated, this flag may provide a slight speed
improvement.

\item{\bf bit 9} (0x200)\\
Internally, clipping/merging of the trapezoid list passed to the
bloating function is skipped.  This is an internal artifact and this
flag should not be set.

\item{\bf bit 10} (0x400)\\
When this bit is set, a scaling algorithm is applied during the
bloating, which very slightly (+/- one internal unit) affects output
coordinates.  This is the result of a very specialized customer
request that output exactly match that from another tool, and is not
likely to be generally useful.

The scale fix will provide more accurate bloating when all angles are
multiples of 45 degrees.  It is not needed for Manhattan geometry, and
for angles other than 45 degree multiples, it can actually reduce
accuracy.  For best accuracy in the all-angle case, the {\et
DatabaseResolution} variable can be set to a larger value.

\item{\bf bit 11} (0x800)\\
When this bit is set, the trapezoid collection used to define the edge
template will not be clipped and merged before use.  This is an
internal artifact and this flag should not be set.

\item{\bf bit 12} (0x1000)\\
When this bit is set, the resulting trapezoid collection produced for
the edge template or by the bloating operation will not be joined into
polygons.

\end{description}

The basic algorithm for modes 0-2 works as follows:
\begin{enumerate}
\item{The collection of objects to bloat is converted to a trapezoid
    representation.}
\item{The resulting trapezoid list is grouped into multiple lists of
    spatially disjoint lists, where each list is mutually connected   
    and no trapezoid touches or overlaps a trapezoid from another list.}
\item{For each list, the line segments representing the trapezoid edges
    are tabulated.}
\item{The edge list is clipped against itself to remove mutually
    overlapping regions.  The remaining edges are the ``external''
    edges, where one side is area outside of the trapezoid group.}
\item{Each edge is converted to a rectangle that covers the edge and
    extends $+/-$ the bloat width normal from the edge (note that these
    rectangles are rotated by an arbitrary angle, depending on the
    angle of the line segment).}
\item{The rectangles are converted to trapezoids.  The non-Manhattan
    rotated rectangles are represented by three trapezoids.}
\item{A polygon, implemented as trapezoids, is added at each vertex,
    to fill in the transition between edge segments.  The list of all
    these trapezoids represents a path along the external edges of the
    original trapezoid group.}
\item{If the bloat value is positive, the edge list is or'ed with
    the original trapezoid list.  If the bloat value is negative, the
    edge list is clipped from the original trapezoid group.  If bit 3
    is set, this step is skipped, and the edge list is passed to the
    next step.}
\item{The resulting trapezoid list is merged into polygons,
    representing the operation result.}
\end{enumerate}

\begin{description}
\item{\bf bloat mode 0}\\
    If a trapezoid group is entirely Manhattan, meaning that all edges
    are horizontal or vertical, no corner vertex fill-in takes place.
    Instead, the vertical line segments are extended by the (positive)
    bloat dimension.  Thus, bloated Manhattan objects always remain
    Manhattan.

    Otherwise, the polygon to fill the empty area at a vertex between
    the segment rectangles is computed, according to the corner
    fill-in mode.  This may add vertices to the resulting figures,
    giving rounded corners.

\item{\bf bloat mode 1}\\
    This mode is faster, but is not recommended for non-Manhattan
    geometry.  The vertical segment ends are extended by the bloat
    dimension to cover (assumed) Manhattan corners.  Non-Manhattan
    segments are added as a single trapezoid with a width computed
    from the bloat dimension.  Note that this can cause small
    protrusions and other anomalies to appear after bloating.

\item{\bf bloat mode 2}\\
    This is the same as bloat mode 0, however the corners of Manhattan
    and non-Manhattan objects will be treated the same.  The corners
    of positive-bloated boxes may be rounded, unlike mode 0.

\item{\bf bloat mode 3}\\
    This mode uses the DRC sizing functions to perform the bloating
    operation, with results similar to mode 2.  All of the other flags
    except for bit 3 (edge template) are ignored with this choice.  If
    bit 3 is set, an edge template is created, extending out of the
    original figure if the bloat value is positive, or inward if the
    bloat value is negative.

    This mode works best if a {\cb !join} is performed before the
    bloat.  This algorithm is rather compute intensive and slower than
    the other algorithms.  In this algorithm, parts of edges that
    touch an object on the same layer will not be moved, whether or
    not the adjacent object was selected.  In the other algorithms,
    unselected objects are completely ignored.
\end{description}

Presently, if bit 2 is set, the ``old'' algorithms will be used. 
These give results similar to the new algorithms, but are slower.

\begin{description}
\item{\bf old mode 0}\\
In the description, we assume that the object is being expanded, i.e.,
the {\it dimen} is greater than zero.  For each edge, an extension out
of the object normal to the edge is created.  For each corner where
the edge projections do not overlap, a 4-sided polygon is created. 
Three of the vertices are the figure corner vertex and the ends of the
two adjacent projections.  The fourth vertex is placed along the
bisector of the angle formed by the other three vertices, a distance
{\it dimen} from the object corner vertex.  All of the projections are
joined to the original object to create the expanded object.  Note
that the corners become rounded, i.e., bloated rectangles become
polygons.  Figure \ref{bloatfig} illustrates the algorithm.

\begin{figure}
\caption{\label{bloatfig} The default algorithm used in the {\cb !bloat}
command to enlarge an object.}
\vspace{1.5ex}
\begin{center}
\epsfbox{images/bloat.eps}
\end{center}
\end{figure}

If the {\it dimen} is less than zero, the object will be shrunk.  In
this case, the projections extend into the object, and the new object
is formed by clipping these regions from the object.

\item{\bf old mode 1}\\
This algorithm works with a trapezoid decomposition of the objects to
be modified.  An expansion is very fast, but a shrink requires
polarity inversion of the trapezoid list, so is somewhat slower.  This
algorithm is not really recommended for non-Manhattan geometry, since
in working at the trapezoid level without considering adjacency, small
artifacts are often introduced at non-Manhattan corners.

The algorithm takes the following steps:
\begin{description}
\item{If {\it dimen} $>$ 0 (expanding):}\\
\begin{enumerate}
\item{Decompose all selected objects on a given layer into a
trapezoid list.}
\item{Create a second list containing trapezoids derived from the
edges of trapezoids in the first list, created to enclose each edge
and the surrounding area to $+/-$ {\it dimen} normal to the edge.}
\item{Merge the two lists and join into polygons.}
\end{enumerate}

\item{If {\it dimen} $<$ 0 (shrinking):}\\
\begin{enumerate}
\item{Decompose all selected objects on a given layer into a
trapezoid list.}
\item{Invert the list in a rectangle that encloses all trapezoids
bloated by {\it dimen}.}
\item{Create an edge trapezoid list from the inverted list.}
\item{Clip out the regions of the original list that overlap
trapezoids in the edge list.}
\item{Merge the resulting list into polygons.}
\end{enumerate}
\end{description}

\item{\bf old mode 2}\\
In this algorithm, for {\it dimen} larger than 0, the objects are
first joined into maximal polygons, i.e., no two of these polygons
abut or overlap.  The vertex list of each polygon is used to construct
a ``wire'' of width $2*dimen$, which is then converted to a polygon
representation.  The wire polygon covers the edge of the original
polygon, extending by {\it dimen} inside and outside of the figure. 
Each polygon becomes the union of the original polygon and its
``wire'' polygon.  If {\it dimen} is less than zero, the geometry is
inverted first as in the previous algorithm.  Thus, the edge ``wires''
around the clear areas are found.  These are clipped from the dark
areas, yielding the final figures.  Without the inversion, polygons
with holes would not be processed correctly.

Note that bloating modes 1 and 2 will not round the corners, i.e.,
Manhattan corners remain Manhattan.
\end{description}

% -----------------------------------------------------------------------------
% !join 070616
\subsection{The {\cb !join} Command: Join Touching Objects}
\index{"!join command}
\label{joincmd}
\begin{quote}
Syntax: {\vt !join} [{\vt -l} {\vt |} {\vt -a}]
\end{quote}

This command will merge boxes, polygons, and optionally wires into
complex polygons.  Use of merged geometry can reduce memory use and
the size of the layout data file.

The {\cb Join}, {\cb Join Lyr}, and {\cb Join All} buttons in the {\cb
Join or Split Objects} panel from the {\cb Join/Split} button in the
{\cb Edit Menu} provide an equivalent to the {\cb !join} command.

There are three basic operating modes.  The {\cb !join} command
without arguments will join only selected objects.  With the ``layer''
argument, all objects on the current layer may be joined, With the
``all'' argument, objects on any layer may be joined.' In these two
cases, objects will be joined whether selected or not.  For the
arguments, the traditional ``{\vt -}'' is actually optional, and only
the first letter is considered, case insensitive, So, ``{\vt !join
-a}'', ``{\vt !join All}'', and ``{\vt !join apple}'' are all
equivalent.

\index{NoMerge keyword}
If a layer has the {\vt NoMerge} keyword applied, in general joining
(merging) is forbidden on the layer.  However, this is overridden by
the {\cb !join} command without arguments.  In this mode, the user
must select the objects to join, and it is assumed that the user
really wants them joined.  In the other modes, objects on layers with
this keyword set will {\bf not} be joined.  The user must first remove
the keyword with the {\cb Tech Parameter Editor} from the {\cb
Attributes Menu}, or otherwise.

In any case, the layer must be visible.  With the ``all'' option, the
layer must also be selectable.

The {\cb !join} command, the {\cb Join}, {\cb Join Lyr}, and {\cb Join
All} buttons, the {\vt Join}, {\vt JoinObjects} and {\vt GroupObjects}
script functions, and other commands such as {\cb !layer} which
perform a join operation, are sensitive to four variables which
fine-tune the behavior and performance.  The default values emphasize
speed but limit the complexity of resulting polygons.  The user may
need to set one or more of these variables in order for the operation
to meet requirements.  These variables can be set from the {\cb Join
or Split Objects} panel, using the analogous controls.

In addition, the {\cb JoinSplitWires} variable, which also has a
corresponding check box in the {\cb Join or Split Objects} panel,
determines whether wires are included in join operations.  By default,
wires do not participate in the join, however if the variable (or
equivalently, the check box) is set, wires will behave the same as
polygons.

To join a set of objects, the first step internally is to decompose
each object onto a collection of trapezoids.  As the objects are
decomposed, the trapezoids are added to a list, which will be sent on
to the function which performs the join.  The variable {\et
JoinMaxPolyQueue} sets the limit on the number of trapezoids that can
accumulate before the list is processed.  All or none of the
trapezoids from a given object are added to the list, i.e., objects
are not broken up at this point.  If the addition of the trapezoids
would cause the list to exceed the limit, then the list is sent on for
processing, and a new list started.  If {\et JoinMaxPolyQueue} is set
to 0, there is no limit, and only a single list will be processed. 
When this variable is not set, the effective default value is 0 (no
limit).

When a list is sent on for processing, the first operation is to break
up the list into groups.  Each group contains one or more trapezoids,
such that the trapezoids in each group are ``connected'', i.e., the
aggregate forms a single figure.  The variable {\et JoinMaxPolyGroup}
specifies a limit on the number of trapezoids in any single group.  If
this limit is reached, no additional trapezoids are added, instead
they are placed in a new group or possibly some other existing group. 
If this variable is set to 0, then no limit is applied, and in this
case all groups are guaranteed to be disjoint.  When this variable is
not set, the effective default value is 0 (no limit).

For each group, one or more polygons are created, which exactly cover
the area of the trapezoids.  The variable {\et JoinMaxPolyVerts}
specifies a limit on the number of vertices which can appear in any
single polygon.  Thus, if the limit is reached, more than one polygon
will be generated.  If this variable is set to 0, then no limit is
applied, and a single polygon will be created for each group.  When
this variable is not set, the effective default value is 600.

When the effective value of {\et JoinMaxPolyVerts} is nonzero, the
{\et JoinBreakClean} variable determines now the partitioning is done. 
If this variable is not set, then the polygons are built up by adding
trapezoids until the vertex limit is reached, at which point a new
polygon is started, and constructed using the remaining trapezoids. 
The process continues until all trapezoids have been included in a
polygon.  The resulting collection of polygons may have complicated
boundaries that interleave in a rather random way.

If {\et JoinBreakClean} is set, the vertex limit is initially ignored,
and a single polygon is created from all of the trapezoids.  If the
vertex limit is exceeded, the polygon is split in two pieces, either
horizontally or vertically.  If either piece still exceeds the limit,
it is subdivided in the same way, and so on until all polygons are
within the limit.  In this case, the boundaries are Manhattan.  This
processing is more compute-intensive than the other approach, but
provides a better looking layout.

% -----------------------------------------------------------------------------
% !jw 092717
\subsection{The {\cb !jw} Command: Join Wires}
\index{"!jw command}
\begin{quote}
Syntax: {\vt !jw} [{\vt -l}]
\end{quote}

Without arguments, this command will take the most recently selected
wire, and recursively join it with other similar (same width and
layer) wires that share an end point.
 
If the {\vt -l} option is given, all wires on the current layer in the
current cell will be joined with any similar wires that share an
endpoint.

The command works in electrical and physical modes.  Its initial
purpose was to fix designs imported from another EDA tool that had all
wires as two-vertex segments.  Within {\Xic}, an attempt is made to
keep wires maximally joined in general, which is more efficient, so
this command is probably rarely needed.

% -----------------------------------------------------------------------------
% !split 121713
\subsection{The {\cb !split} Command: Atomize Objects}
\index{"!split command}
\begin{quote}
Syntax: {\vt !split} [{\vt v}$|${\vt V}$|${\vt 1}]
\end{quote}
This is basically the reverse of {\cb !join}.  Selected polygons will
be converted to collections of boxes and four-sided polygons.

However, objects on layers with the {\vt NoMerge} keyword applied
cannot be split (or joined).  The {\cb Edit Tech Params} button in the
{\cb Attributes Menu} brings up an editor that allows changing of this
status.

This functionality is also available from the {\cb Split Horiz} and
{\cb Split Vert} buttons in the {\cb Join or Split Objects} panel from
the {\cb Join/Split} button in the {\cb Edit Menu}.

Wire objects can be split similar to polygons if the {\cb Include
wires (as polygons) in join/split} check box in the {\cb Join or Split
Objects} panel is set, or equivalently if the {\et JoinSplitWires}
variable is set.

If an argument is given that has {\vt v},{\vt V}, or {\vt 1} as a
first character, the splitting orientation is along the vertical,
i.e., objects are divided by vertical lines that intersect the
vertices.  This is the mode used by the {\cb Split Vert} button. 
Otherwise, splitting favors the horizontal orientation.


% -----------------------------------------------------------------------------
% !manh 100412
\subsection{The {\cb !manh} Command: Convert to Manhattan Polygons}
\index{"!manh command}
\begin{quote}
Syntax: {\vt !manh} {\it min\_box\_size} [{\it mode\/}]
\end{quote}
This command applies to selected polygons.  It will convert each
polygon to a Manhattan approximation, meaning that all sides will be
horizontal or vertical.

The first argument is the size, in microns, of the minimum box
width/height used to approximate non-Manhattan parts of the polygon.

The second argument is an integer that provides a choice of
algorithms.  If this argument is not given, a zero value is
understood.  Presently, there are two Manhattanizing algorithms
available, specified if {\it mode} is zero or nonzero.

When {\it mode} is zero (or not given), the operation works as
follows.  First, a polygon is decomposed into trapezoids, each of
which is subdivided horizontally if necessary so that it can be
further split vertically into rectangular and right-triangular pieces. 
The triangular pieces are divided, recursively, into a rectangular and
two residual right-triangular pieces.  All of the rectangular pieces
whose height and width are {\it min\_box\_size} or larger are kept,
and reassembled into a new Manhattan polygon.

In this mode, the rectangular elements can have arbitrary size,
(though sufficiently large), and there is no restriction on coordinate
locations.

When {\it mode} is nonzero, a different approach is taken.  First, a
polygon is decomposed into a collection of trapezoids, and each
trapezoid is processed.  For each trapezoid, all coordinates are moved
to a "grid" of size {\it min\_box\_size}.  If either side is
non-Manhattan, Bresenham's method is used to scan the trapezoid
vertically, creating a new Manhattan trapezoid for each "scan line"
(grid point) where the width changes.  The collection of trapezoids
produced is reassembled into a new Manhattan polygon.

In this mode, all coordinates are moved to the grid, thus all the
rectangular elements used to build the trapezoid have height and width
an integer multiple of {\it min\_box\_size}.

% -----------------------------------------------------------------------------
% !polyfix 033009
\subsection{The {\cb !polyfix} Command: Fix Polygon}
\index{"!polyfix command}
\begin{quote}
Syntax: {\vt !polyfix}
\end{quote}
This command will remove duplicate and in-line redundant vertices from
selected polygons.  In addition, it will repair the following
conditions:

\begin{itemize}
\item{If a reentrancy condition can be avoided by moving a vertex by
 one database unit, the vertex will be moved.}
\item{If a ``needle'' vertex is found, it will be removed.  A needle
 vertex is a vertex where the path doubles back on itself.}
\end{itemize}

% -----------------------------------------------------------------------------
% !polyrev 053108
\subsection{The {\cb !polyrev} Command: Reverse Polygon Winding}
\index{"!polyrev command}
\begin{quote}
Syntax: {\vt !polyrev}
\end{quote}
This will reverse the order of vertices of all selected polygons,
i.e., changing the winding from clockwise to counter-clockwise and
vice-versa.  This should rarely if ever be needed.

% -----------------------------------------------------------------------------
% !noacute 053108
\subsection{The {\cb !noacute} Command: Eliminate Acute Angles}
\index{"!noacute command}
\begin{quote}
Syntax: {\vt !noacute}
\end{quote}
This command will look at each currently selected polygon.  For
vertices that form an acute angle, vertices will be added so that no
angle is acute, i.e.  the sharp point is clipped off.  This command is
useful for preprocessing the database for flash conversion or other
functions where acute angles are undesirable.  It does not prevent DRC
errors, and in fact may produce them.  It also produces tiny (order of
the layer's minimum dimension or one micron, if the minimum width for
the layer is not given) changes to the layout.  For example, consider
a group of five or more polygons, each one of which is a pie section,
that together form a disk.  Running this command will produce a hole
in the center, where the angles are clipped.

The algorithm works as follows.  For each vertex $V_n$ of a polygon,
check the angle formed with adjacent vertices $V_{n-1}$,$V_{n+1}$.  If
the angle is acute, construct a circle around $V_n$ where the radius
is the minimum of the layer's minimum dimension or the distance to the
nearest of $V_{n-1}$,$V_{n+1}$.  Find the intersections of the circle
with segments $V_n$,$V_{n-1}$ and $V_n$,$V_{n+1}$.  Replace the vertex
$V_n$ with these two points.

% -----------------------------------------------------------------------------
% !togrid 053108
\subsection{The {\cb !togrid} Command: Move To Grid}
\index{"!togrid command}
\begin{quote}
Syntax: {\vt !togrid}
\end{quote}
This will move all vertices in selected boxes, polygons, and wires to
the nearest snap point, using the grid/snap defined for the main
window.  There is no effect on subcells or labels.  If the new object
can not be created due to it having zero area, the old object is
untouched.  Duplicate vertices are removed from the new objects. 
Objects with vertices that are off-grid can change size and position
due to this function.

% -----------------------------------------------------------------------------
% !tospot 100916
\subsection{The {\cb !tospot} Command: Modify for Spot Size}
\index{"!tospot command}
\index{spot size}
\begin{quote}
Syntax: {\vt !tospot} [{\it spotsize}]
\end{quote}
When an e-beam mask is written, the layout is rendered using a certain
pixel size (known as the ``spot size'') set by the e-beam equipment. 
This size may be as large as 0.5 microns but is typically much
smaller, with smaller sizes providing higher resolution, but taking
longer to write and therefor costing more.  There can be numerical
problems in ``rasterizing'' round objects to the e-beam grid.  Since
the round object is rendered as a collection of spot-pixels, the
feature is not particularly round, but most importantly the number of
pixels used may not be well defined, and therefor the figure area may
not be as expected, or vary depending on position or rotation.  {\Xic}

The {\cb !tospot} command will apply an algorithm (described below) to
all selected polygons.  The {\it spotsize}, if given, is the spot size
to use in microns.  Values up to 1.0 micron are accepted.  If not
given, the value is taken from the {\et SpotSize} variable if set, or
the value of the {\vt MfgGrid} from the technology file if {\et
SpotSize} is not set.

The algorithm is intended to translate small objects with many
vertices to a representation which will pass unchanged through e-beam
rasterization.  This will in general change the shape of an object, to
something close to that which will be rendered on the mask.

The algorithm uses the following logic:

\begin{enumerate}
\item{Find the bounding box of the figure.}
\item{Snap the box edges to the nearest spot boundaries.}
\item{If the center of the bounding box has changed, apply the same offset
    to the figure to keep it centered in the new bounding box.}
\item{Shrink the box by 1/2 of the spot size.}
\item{Clip the figure to the new bounding box.}
\item{For each vertex, move the vertex to the center of the closest spot.}
\item{Remove duplicate vertices.}
\item{Save the modified figure in the database.}
\end{enumerate}

Following application of the algorithm, each vertex of the figure is
centered in an e-beam spot, so it is unlikely that round-off or other
error will cause the figure to change during rasterization.

The algorithm is intended for unconnected, nonconducting objects such
as vias.  It should not in general be applied to wiring objects, since
it will generate small gaps between processed objects which were
originally touching, which will cause the extraction functions to
detect that the objects are disconnected.

Although the object is shown on-screen as a polygon, The actual
rendered object will be composed of pixels.  The size of the object
on-screen is therefor one spot-size smaller than the rendered size
(since half of the spot for each edge is not shown).

Applying {\cb !tospot} to circular objects created with a {\et
SpotSize} is {\it not} the same as creating the circular object with
the {\cb round} or {\cb donut} buttons with {\et SpotSize} nonzero. 
When using {\cb !tospot} on round objects created without {\et
SpotSize} set, it is best to use an even number of sides for round
objects.  In particular, an 8-sided figure is probably the best choice
for a ``circular'' via.

% -----------------------------------------------------------------------------
% !origin 053108
\subsection{The {\cb !origin} Command: Move Cell Origin}
\index{"!origin command}
\begin{quote}
Syntax: {\vt !origin} {\it x y\/} {\vt | n|s|e|w|nw|ne|sw|se}
\end{quote}
In physical mode, this will move the cell origin.  This applies a
translation to every object in the cell, and rebuilds the database. 
The operation is more efficient than selecting everything and applying
a move command, however there is no automatic ``undo'', except by
applying the reverse operation.
    
{\bf All instances of the cell will change position if the cell origin
is changed.}
    
If the arguments are a coordinate {\it x,y} pair, the origin is
shifted to that position (in microns) relative to the lower left
corner of the cell's bounding box.

Alternatively, the argument can be one of the following compass
directions:
      
\begin{tabular}{lp{4in}}
\vt n & The origin is moved to the top of the bounding
  box, the left/right position does not change.\\
\vt s & The origin is moved to the bottom of the bounding
  box, the left/right position does not change.\\
\vt e & The origin is moved to the right side of the
  bounding box, the up/down position does not change.\\
\vt w & The origin is moved to the left side of the
  bounding box, the up/down position does not change.\\
\vt nw & The origin is moved to the upper left corner of
  the bounding box.\\
\vt ne & The origin is moved to the upper right corner of
  the bounding box.\\
\vt sw & The origin is moved to the lower left corner of
  the bounding box.\\
\vt se & The origin is moved to the lower right corner of
  the bounding box.\\
\end{tabular}

% -----------------------------------------------------------------------------
% !import 053108
\subsection{The {\cb !import} Command: Import Cell Data}
\index{"!import command}
\begin{quote}
Syntax: {\vt !import} {\it cellname}
\end{quote}
In physical mode, this will move the contents of the physical part of
{\it cellname} into the physical part of the current cell (the
electrical parts are unchanged).  The physical part of {\it cellname}
will be empty after the operation.  The coordinates of the objects are
the same after the move, with respect to the origin of the current
cell.  This operation is not undoable.


\section{Layout Information}

% -----------------------------------------------------------------------------
% !fileinfo 041009
\subsection{The {\cb !fileinfo} Command: Show File Statistics}
\label{fileinfo}
\index{"!fileinfo command}
\begin{quote}
Syntax: {\vt !fileinfo} {\it filename} [{\it flags\/}] [{\it outfile\/}]
\end{quote}
This will print information about the archive file given as the first
argument.  The output will go to a text file in the current directory.

The optional second argument is an integer or string which determines
the type of information to print.  If an integer, the bits are flags
that control the possible data fields and printing modes.  The string
form is a space or comma-separated list of text tokens or hex
integers.  The hex numbers or equivalent values for the text tokens
are or'ed together to form the flags integer.  If the string contains
white space it must be quoted.

The flag keywords and values are described with the {\vt ChdInfo}
script function in \ref{ChdInfo}.

If not given or given as 0, all flags except for {\vt allcells}, {\vt
instances}, and {\vt flags} are taken as set.  This avoids printing
the lengthly cells/instances list by default.  The keyword {\vt all}
or value -1 can be used to obtain all available information.

If the {\it outfile} is not given, the output will go to a file named
``{\vt xic\_fileinfo.log}'' in the current directory, otherwise it
will go to the given file.  In either case, the user is prompted to
view the file when the operation is complete.

The operation has no effect on the database.

This command creates a Cell Hierarchy Digest (CHD) data structure for
the given file, and uses the CHD to obtain the information in a very
similar manner to the {\vt ChdInfo} script function.  In the {\cb
!fileinfo} command, the keyword flags listed below will show as
indicated, as for the {\vt FileInfo} script function:

\begin{description}
\item{\vt scale}\\
This will always be 1.0.
\item{\vt alias}\\
No aliasing is applied.
\item{\vt flags}\\
The flags will always be 0.
\end{description}

% -----------------------------------------------------------------------------
% !summary 060108
\subsection{The {\cb !summary} Command: Print Hierarchy Info}
\index{"!summary command}
\begin{quote}
Syntax: {\vt !summary} [{\vt -v}] [{\it filename\/}]
\end{quote}
This prints summary information (similar to the {\cb Info} command)
for each cell in the hierarchy rooted in the current cell to a file. 
If {\vt -v} is given, the output will be more verbose.  If no {\it
filename} is given, a file named ``{\vt xic\_summary.log}'' will be
created in the current directory.

% -----------------------------------------------------------------------------
% !compare 120110
\subsection{The {\cb !compare} Command: Compare Hierarchies}
\label{cellcomp}
\index{"!compare command}
\begin{quote}
Syntax: {\vt !compare} {\it arguments}
\end{quote}
This function compares the geometry and instance placements in cells
from two cell hierarchies, or between a cell hierarchy and cells in
memory, or between cells in memory.  It is also possible to compare
properties of cells, cell instances, and objects.  The results are
written to a log file.  It is used as a back-end for the {\cb Compare
Layouts} panel, and can be used directly.

There are three basic comparison modes.  The per-cell object mode
compares cell content object-to-object.  A difference will be
indicated if a given object does not have an exact counterpart in the
other cell.  The per-cell geometry mode does not look at objects, but
rather considers the area occupied by the objects.  Thus, differences
will be indicated only if the covered area differs.  The third
comparison mode logically flattens the hierarchy before comparing the
geometry.  Thus, differences will be indicated only if the flat
geometry (i.e., the mask layout) differs.

The results are written to a file named ``{\vt diff.log}'' in the
current directory.  Each object or region that appears in one cell and
not the other corresponding cell is written in a CIF-like format to
the log file, unless the {\vt -d} (diff only) option is given.

When the comparison finishes, the user is given the option to view the
log file.  The {\cb !diffcells} command can be used to create cells
from the log file for visualizing the differences.

\subsubsection{Common Options}

There is a large number of arguments that can be applied to set
various modes and provide further input.  These arguments must be
given as separate tokens, and all start with a `{\vt -}' symbol.  The
following options apply to all comparison modes.

\begin{description}
\item{{\vt -f1} {\it source1\/}}\\
This is the ``left'' source.  It is either the name of an archive
file, or the access name of a Cell Hierarchy Digest (CHD) in memory,
or a path to a CHD file.  This argument is not mandatory, and if
missing implies that cells listed for the left source are found in
main memory.

\item{{\vt -f2} {\it source2\/}}\\
This is the "right" source.  It is either the name of an archive file,
or the access name of a Cell Hierarchy Digest (CHD) in memory, or a
path to a CHD file.  This argument is not mandatory, and if missing
implies that cells listed for the right source are found in main
memory.
\end{description}

For backward compatibility, the ``{\vt -f1}'' and ``{\vt -f2}'' are
optional.  If otherwise unassociated strings appear in the command
line, the first will be taken as if given with {\vt -f1}, the second
(if any) will be taken as if given with {\vt -f2}.

If a layout file name is given as a source, a temporary CHD will be
created in memory and destroyed on command exit.  Thus for repeated
comparisons using the same file, it is more efficient to create the
CHD first, and pass its name to this command.

\begin{description}
\item{{\vt -c1} {\it cellname\/} ...}\\
This is a list of cell names found in the left source.  If more than
one name appears, the list should be quoted using double-quote marks. 
If no left source was given, the names should match cells in memory.

\item{{\vt -c2} {\it cellname\/} ...}\\
This is a list of equivalent cell names found in the right source.  If
more than one name appears, the list should be quoted using
double-quote marks.  If no right source was given, the names should
match cells in memory.
\end{description}

The actual list of cells to compare is generated by logic to be
described.  The left source is taken as the ``reference'' for cell
list creation.

In many cases, there is only one list of cells to compare (given in
{\vt -c1}), and each cell is sought in both sources.  If a cell is
found in one source and not the other, this will appear in the log
file, but is not considered to be an error.

If a {\vt -c2} ``equivalence'' list is given, there must be exactly
the same number of entries as given in the {\vt -c1} list.  The cells
in the two lists will be compared term-by-term, in order.  This is how
one can compare cells with differing names.  In all other cases, the
{\vt -c2} list should not appear.  It is an error if {\vt -c2} is
given without {\vt -c1}, or the list lengths differ.  However, the
{\vt -c2} list is ignored if in a per-cell comparison mode and the
{\vt -h} (recurse) option is given.

The interpretation of a non-existing {\vt -c1} list depends on the
comparison mode.  If in flat comparison mode, or in a per-cell mode
and the {\vt -h} (recurse) option is given, then the effective cell
list contains only the default cell from the left source.  If this was
a CHD name, the default cell is the one configured into the CHD, or
the first top-level cell found in the source file.  In the other
cases, a missing {\vt -c1} list is interpreted as all cells found in
the left source.

In the special case that neither a left or right source is specified,
then the {\vt -c1} and {\vt -c2} lists can not be empty, and the names
are cells in memory to compare.

In the per-cell modes with {\vt -h} (recurse) option given, each entry
in the {\vt -c1} list is hierarchically expanded to a full list of the
cells under the given cell, and these names are merged into a new list
that contains no duplicates.  If no {\vt -c1} list was given, per the
discussion above, the cell list is effectively the hierarchy of the
default cell from the left source.  The recurse option can not be used
unless a left source is specified, i.e., the left cells can't be from
memory.

\begin{description}
\item{{\vt -l} {\it layer\_list}}\\
The {\it layer\_list} is a space-separated list of layer names, which
must be quoted if more than one layer appears.  If no {\it
layer\_list} is given, all layers will be checked for differences.

\item{\vt -s}\\
If a {\it layer\_list} is given, differences will be recorded in all
layers {\bf except} the layers in the {\it layer\_list}.

\item{\vt -d}\\
Don't record the actual differences, only whether or not the cells
differ.  This only accounts for geometrical differences, properties
are ignored.

\item{{\vt -r} {\it max\_diffs}}\\
The integer {\it max\_diffs} sets the maximum number of differences to
allow before the comparison terminates.  If not given or given a value
0, there is no limit.  Beware that errors in the cell list could
potentially lead to enormous output, so it is usually advisable to put
a limit on the number of differences recorded.
\end{description}

The following options set the comparison mode.  The per-cell
comparison modes are generally faster and use less memory than the
flat mode, since only the geometry from the two cells being compared
is called into memory.  The flat mode is required if the two layouts
have differences in hierarchy.

\begin{description}
\item{\vt -g}\\
When {\vt -g} is given, per-cell geometric comparison is used.  All
``real'' objects (boxes, polygons and wires) are considered when
comparing geometry, text labels are ignored.

\item{\vt -f}\\
The {\vt -f} option indicates flat comparison mode, and will supersede
{\vt -g} if also given.  In flat comparison mode, geometry is
logically flattened before comparison.
\end{description}

If neither {\vt -f} or {\vt -g} appears in the argument list, per-cell
object mode is used.

\subsubsection{Per-Cell Object Mode Options}

\begin{description}
\item{{\vt -t} {\it obj\_types}}\\
The {\it obj\_types} is a word containing any or all of the letters
{\vt c,b,p,w,l} which indicate cells, boxes, polygons, wires, and
labels.  The letters indicate the types of objects that will be
considered.  If this option is not given, the default is ``{\vt
cbpw}'', i.e., labels are ignored.

Comparison of labels can lead to false differences when comparing
cells read from different file formats, since label bounding boxes are
not well defined across file format conversion.

\item{\vt -b}\\
When given, a two-vertex wire or four-vertex polygon that is rendered
as a Manhattan rectangle will match a rectangle object with the same
dimensions.  Thus, files that have had these features converted to
boxes to save space can be directly compared, without a lot of
spurious entries in output.
       
\item{\vt -n}\\
When given, if duplicate objects are present in one or both of the
files, unmatched duplicates will not be reported if one of the
duplicates has a match.  Thus files with duplicates removed can be
compared with the original file, and the duplicates will not appear in
output as differences.

\item{\vt -x}\\
Expand subcell arrays (if comparing subcells).  Cell arrays are
converted to individual placements before comparison, avoiding false
errors between arrayed and equivalent unarrayed layouts.

\item{\vt -h}\\
The cell list is expanded so that all cells in the hierarchy under the
given cells are compared.  The left source is used to extract the
hierarchy cells.  The left source must have been specified, this
option does no apply if the left cells are in memory.

\item{\vt -e}\\
If {\vt -e} is given, electrical cells will be compared.  Otherwise,
physical cells are compared.
\end{description}

Property comparisons are available only in per-cell object mode. 
Property lists of cells, instances, and objects can be filtered by
property number and compared.  Only the property lists of otherwise
identical instances or objects will be compared.  Property comparison
is turned off by default, but can be enabled with the {\vt -p} option.

\begin{description}
\item{{\vt -p} {\it spec\_word}}\\
This option will set up property list comparison, which is available
in per-cell object comparison mode.  The {\it spec\_word} is a
collection of characters from the list below, order is unimportant.

\begin{description}
\item{\vt b, p, w, l, c, s}\\
The presence of these letters enables property list comparison between
boxes, polygons, wires, labels, instances, and cells.  The indicated
object type or instance must also be enabled for checking with the
{\vt -t} option or by default, or the letter is ignored.  The {\vt s}
character will always enable comparison of the property lists of the
two source cells.

\item{\vt n,u}\\
These two letters control the filtering applied to property lists
before comparison.  The filters limit the properties to compare.  If
{\vt n} is given, no filtering is applied, so that all properties will
be considered.  This overrides {\vt u} (below) if both are given.

If {\vt u} is given, custom filtering will be applied.  There are
separate filters available for properties of cells, instances, and
objects, for both physical and electrical comparisons.  Custom
filtering can be set up through the {\cb Custom Property Filter Setup}
panel, or by directly setting the corresponding variables.  See the
description of the panel in \ref{prpfilt} for complete information.

If neither of these letters appear, default filtering is applied.  For
physical data, the default filtering action is no filtering.  For
electrical data, filtering is applied to cell and instance properties,
and object properties are ignored, so that difference reporting
applies to user-defined properties only.
\end{description}
\end{description}

Properties are compared by number and string.  In the output file,
property comparison result lines are all in comment form (with `{\vt
\#}' as the first character) so that they will be ignored if the file
is subsequently processed with the {\cb !diffcells} command.  Property
comparison results consist of a string indicating the cell, instance,
or object containing the properties.  If an instance or object, this
is common to both input sources.  Following this are listings of
properties found in one source and not the other.  Properties that are
identical in the two sources are not listed.

\subsubsection{Per-Cell Geometry Mode Options}

All of the options for per-cell object mode are available and have the
same function, except that the only code that is considered for {\vt
-t} is ``{\vt c}''.  By default, subcell checking is not enabled.  If
enabled (``{\vt -t c}'' is given), then subcell placements are checked
as in per-cell object mode.

When using per-cell geometry mode, the geometry is compared within
areas of a grid whose size is given by the {\et PartitionSize}
variable.  Experimenting with this size can lead to improved speed,
depending on the layout density.  The default partition size is 100
microns.  For best performance, this can be increased for low density,
or reduced for high density, where ``density'' refers to the number of
trapezoids per area.

\subsubsection{Flat Mode Options}

None of the per-cell options apply in flat mode, though with the
exception of {\vt -e} if given they will be benignly ignored.  Flat
mode applies only to physical data, and if {\vt -e} is given, an error
will result.

In flat mode, both {\it source} tokens must be provided, as flat
comparison to memory cells is not available.

\begin{description}
\item{{\vt -a} {\it L,B,R,T}}\\
The {\vt -a} option specifies the rectangular area where comparison is
performed.  If not given, comparison is performed over the entire cell
area of both cells.  The word that follows {\vt -a} consists of the
four rectangle coordinate values, in microns, separated by commas. 
There can be no white space.
\end{description}

The flat geometry mode is somewhat orthogonal to the other modes.  The
algorithm uses two levels of gridding to partition the layout into
pieces, and directly compares the geometry in each fine grid cell. 
This is very similar to the algorithm described for the {\vt
ChdIterateOverRegion} script function.

\begin{description}
\item{{\vt -i} {\it fine\_grid}}\\
This sets the size of the fine grid used for comparison.  The geometry
in each fine grid cell is compared.  The value is in microns in the
range 1.0 -- 100.0, if not given 20.0 is used.

\item{{\vt -m} {\it coarse\_mult}}\\
This sets the size of the coarse grid, as an integer multiple of the
fine grid size.  The coarse grid size is the chunk size for reading
geometry into memory.  Once in memory, the geometry is split into the
fine grid cells and compared.  Using too large of a coarse grid can
cause memory exhaustion for dense layouts, but on the other hand a
larger coarse grid size usually improves speed.  The user should
experiment to find the best values for the fine and coarse grid for
their layouts.  The acceptable range for this parameter is 1 -- 100. 
If not given, 20 is used.
\end{description}

% -----------------------------------------------------------------------------
% !diffcells 030909
\subsection{The {\cb !diffcells} Command: Create Cells from Comparisons}
\index{"!diffcells command}
\begin{quote}
Syntax: {\vt !diffcells} [{\it filename\/}]
\end{quote}
This command will read a file produced by the {\cb Compare Layouts}
panel or the {\cb !compare} command, and generate cells in the current
symbol table containing the difference objects.  If no {\it filename}
is given, a file named ``{\vt diff.log}'', in the current directory,
will be read.  Otherwise, the given file will be read, which should
contain comparison output in the format of the {\vt diff.log} file
produced by the comparison commands.

The new cells are given the name of the source cell with a suffix
``{\vt \_df12}'' or ``{\vt \_df21}''.  The ``12'' cells contain the
objects found in the ``{\vt <<<}'' cell but not the ``{\vt >>>}''
cell, and vice-versa for the ``21'' cells.  The created cells contain
only geometry, so do not have subcells, and instance differences are
ignored. 

This can be very useful for graphically displaying the differences
between cells.

% -----------------------------------------------------------------------------
% !empties 090914
\subsection{The {\cb !empties} Command: Check for Empty Cells}
\index{"!empties command}
\begin{quote}
Syntax: {\vt !empties} [{\vt force\_delete\_all}]
\end{quote}
\index{NoCheckEmpties variable}
This command will search through the hierarchy rooted in the current
cell, and list the empty cells.  Only the names of cells that have no
content (objects or subcells) in either electrical or physical mode
are listed.  This test is performed automatically when a new cell is
opened for editing/viewing, though this can be suppressed by setting
the {\et NoCheckEmpties} variable.

Instances of empty cells are shown on-screen as a small highlighting
box at the placement location.  If empty cells are found, the {\cb
Empty Cells} pop-up appears, which provides a means for their
deletion.  The deletion capability is available in the {\Xiv} feature
set as well, in a rare instance where database changes are allowed.  A
list of the empty cells is shown, each followed by ``yes'' or ``no'',
where ``yes'' implies that the cell will be deleted.  Initially, all
listings will be ``no'', but these can be changed by clicking on them. 
The {\cb Delete All} button sets all entries to ``yes'', and the {\cb
Skip All} button sets all entries to ``no''.  Pressing {\cb Apply}
will actually perform the deletions.

However, is is not possible to delete instances of empty cells that
are contained in a parent cell with the IMMUTABLE flag set.  Cells
referenced by an instance in an immutable parent will not be deleted,
however instances in non-immutable parents within the hierarchy will
be deleted.

If cells are deleted, the search for empty cells is repeated, and the
pop-up will be updated if any are found.  Additional cells may become
empty due to the previous deletions.

If the literal ``{\vt force\_delete\_all}'' argument is given, all
empty cells in the hierarchy, including those that become empty due to
prior deletions, will be deleted (if possible).  The pop-up will not
appear.

The current cell, if empty or if it becomes empty, will not be deleted.


% -----------------------------------------------------------------------------
% !area 060108
\subsection{The {\cb !area} Command: Measure Layer Area}
\index{"!area command}
\begin{quote}
Syntax: {\vt !area} [{\it layername\/}]
\end{quote}
The {\cb !area} command prints the area (in square microns) covered by
the given layer, in the current cell and all of its descendent cells. 
If {\it layername} is not given, the current layer is used, if in
physical mode.  Only physical mode layers can be given, and only
physical cells are computed.  This does {\it not} account for
overlapping objects.

% -----------------------------------------------------------------------------
% !perim 060108
\subsection{The {\cb !perim} Command: Measure Object Perimeter}
\index{"!perim command}
\begin{quote}
Syntax: {\vt !perim}
\end{quote}
This command will compute the perimeter of selected objects and
subcells and print the totals, in microns.  Labels are ignored. 
Separate totals are given for subcell perimeter, and for the perimeter
of geometric objects.

% -----------------------------------------------------------------------------
% !bb 060108
\subsection{The {\cb !bb} Command: Print Bounding Box}
\index{"!bb command}
\begin{quote}
Syntax: {\vt !bb}
\end{quote}
In physical mode, this prints the bounding box coordinates of the
current cell, in microns.

% -----------------------------------------------------------------------------
% !checkgrid 100412
\subsection{The {\cb !checkgrid} Command: Mark Off-Grid Vertices}
\index{"!checkgrid command}
\begin{quote}
Syntax: \parbox[t]{5in}{{\vt !checkgrid} [{\vt c}] [{\vt o}] or\\
 {\vt !checkgrid} [{\vt -}] [{\vt -l} {\it layer\_list\/}] [{\vt -s}]
 [{\vt -g} {\it spacing\/}] [{\vt -b} {\it L,B,R,T\/}]
 [{\vt -t} {\it bpw\_string\/}] [{\vt -d} {\it depth\/}]
 [{\vt -f} {\it outfile\/}]}
\end{quote}
This is really two commands in one.  The first mode checks objects in
the current cell, and will mark off-grid vertices on-screen.  The
second mode will check vertices to all levels of the hierarchy.

The first form will mark vertices of objects and cells that are
off-grid.  The reference grid is the grid currently applied in the
main drawing window.  If there are selected objects, these (only) will
be tested.  Objects or subcells that have an off-grid vertex will
remain selected, other objects will be deselected.  If no testable
objects are selected, all objects on visible, selectable layers will
be tested.  Cells will be checked if the `{\vt c}' modifier is given. 
Objects or cells that have an off-grid vertex will be selected, and
all off-grid vertices will be marked.

Giving the {\cb !checkgrid} command with the `{\vt o}' modifier (or
`{\vt n}' or `{\vt 0}' (zero)) will remove the marks from the screen.

If the first character of the argument string is `{\vt -}', the second
mode will be used.  An argument containing a single `{\vt -}' is valid
to enforce this.  The other possible arguments are listed below.  All
of these are optional.

The command will look at objects in the hierarchy, and if an object
vertex would appear off-grid in the current cell, it will be listed in
an output file.

\begin{description}
\item{{\vt -l} {\it layer\_list}}\\
The argument is a space-separated list of layer names, which should be
quoted if it contains more than one entry.  Only objects on the listed
layers will be checked, or if {\vt -s} is also given objects on layers
not listed will be checked.  If not given, all layers will be used.

\item{\vt -s}\\
If a {\it layer\_list} was given, objects on these layers will be
ignored.

\item{{\vt -g} {\it spacing}}\\
The {\it spacing}, in microns, is the assumed grid spacing.  If not
given, the value from the current grid setting will be used.

\item{{\vt -b} {\it L,B,R,T}}\\
This specifies a rectangular region in the current cell where testable
objects will be searched for.  If not given, the entire cell will be
searched.  The coordinates are in microns, separated by commas with no
white space.

\item{{\vt -t} {\it bpw\_string}}\\
This is a string consisting of one or more of the letters ``{\vt b}'',
``{\vt p}'', and ``{\vt w}''.  This indicates the type of objects to
test:  boxes, polygons, and wires.  If not given, ``{\vt bpw}'' is
assumed.

Note:  only the lower left and upper right vertices of boxes are
tested, since the other two are redundant.

\item{{\vt -d} {\it depth}}\\
This sets the maximum hierarchy depth to search for objects.  If not
given, all levels of the hierarchy will be searched.  A zero value
would search only the current cell.

\item{{\vt -f} {\it outfile}}\\
This sets the name of the output file, which will contain a sorted
list of off-grid vertices.  If not given, the name of the current
cell, suffixed with ``{\vt \_vertices.log}'', will be used.  If the
name is ``{\vt stdout}'', output will go to the standard output
(console window).
\end{description}

% -----------------------------------------------------------------------------
% !checkover 060108
\subsection{The {\cb !checkover} Command: Report Subcell Overlap}
\index{"!checkover command}
\begin{quote}
Syntax: {\vt !checkover [{\it filename\/}]}
\end{quote}
This command creates a report of subcell overlap in the current
physical cell.  The report is written to the given {\it filename}, or
to a temporary file if no name is given.  The user is given the option
to view the report, if a filename is given, otherwise the file viewer
pops up automatically for the temporary file, and the temporary file
is deleted.

% -----------------------------------------------------------------------------
% !check45 012016
\subsection{The {\cb !check45} Command: Select Non-45 Polys and/or Wires}
\index{"!check45 command}
\begin{quote}
Syntax: {\vt !check45} [{\vt p|w}]
\end{quote}
This will select polygons and/or wires in the current cell that have
an angle that is not an exact multiple of 45 degrees.  If an argument
``{\vt p}'' is given, only polygons are checked, or if the argument is
``{\vt w}'' only wires are checked.  Otherwise both polygons and wires
are checked.  Only objects on visible, selectable layers are checked.

% -----------------------------------------------------------------------------
% !dups 060108
\subsection{The {\cb !dups} Command: Select Coincident Objects}
\index{"!dups command}
\begin{quote}
Syntax: {\vt !dups}
\end{quote}
This checks the current cell for identical objects placed on top of
one another.  The duplicate objects are selected.  This command
initially deselects anything previously selected.

% -----------------------------------------------------------------------------
% !wirecheck 101609
\subsection{The {\cb !wirecheck} Command: Check Wires}
\index{"!wirecheck command}
\label{wirecheck}
\begin{quote}
Syntax: {\vt !wirecheck} [{\it layer ...}]
\end{quote}
Wire database objects have the property that their geometric shape is
not unambiguously specified.  Every tool contains code that generates
a polygon from the wire vertex list, which can be displayed and
further processed.  The details of how corners are handled, and how
the ``rounded'' end style is handled, can vary slightly between tools.

Some wires are difficult to represent as a polygon, and in fact may
cause failure with some tools (and possibly not others).  Although
wires sensibly created by hand would rarely if ever cause trouble,
wires generated by format converters or some other program might cause
failures, for example when ``fracturing'' the layout file during mask
generation.  Even wires that look reasonable on-screen may not be
renderable on other tools, thus {\Xic} provides some tests that can be
applied to flag potential problems.

Wires can be ``questionable'' or ``bad''.  Bad wires can not be
rendered, and will never be included in the {\Xic} database.  These
wires are always flagged as errors when seen.

Wires that are ``questionable'' have vertices that are closely spaced
compared to the wire width, and trigger an edge-clipping fix-up in the
wire-to-polygon function.  Such wires may cause rendering difficulty
in other tools.  In addition, wires whose polygon representation
requires more than 600 vertices are flagged as questionable.

When reading a layout file, questionable wires will be reported as
warnings in the log file.

This command can be used to find questionable wires in the current
cell.  It takes a list of layer names as arguments, which will limit
the testing to wires on those layers.  If no arguments are given, all
layers will be used.

If wires are selected before the command is given, only the selected
wires on the given layers (or on any layer, if no arguments are given)
will be checked.  If no wires are selected, all wires on the layers
given (or on any layer if no arguments are given) will be checked.

If a wire is determined to be questionable, it will be, or remain,
selected.  The {\cb Info} command in the {\cb View Menu} can be used
to determine the exact nature of the defect.

The flags that might be listed in the info for wires have the
following explanations.

\begin{description}
\item{\vt ONEVERT}\\
The wire consists of a single vertex only.  The interpretation of
this case may be tool-dependent.

\item{\vt ZEROWIDTH}\\
The wire has zero width.  Zero width wires have no physical
significance and should not appear in a physical layout, though
generally they are simply ignored.

\item{\vt CLOSEVERTS}\\
The wire contains at least two vertices whose spacing is less than
half of the wire width.  This may not be a problem, however wires
that are difficult to render will always have this condition.

\item{\vt CLIPFIX}\\
This flag indicates that special fix-up code was triggered when the
representing polygon was created, which indicates that rendering
requires non-trivial processing.  Wires that have this flag are
suspect (they will also always have {\vt CLOSEVERTS} set).

\item{\vt BIGPOLY}\\
This flag indicates that the representing polygon contains more
than 600 vertices.  This is not really a problem, by does indicate
that the wire may be overly complex.
\end{description}

Wires that are determined to be questionable will have one or more of
{\vt ZEROWIDTH}, {\vt CLIPFIX}, or {\vt BIGPOLY} set.

% -----------------------------------------------------------------------------
% !polycheck 033009
\subsection{The {\cb !polycheck} Command: Check Polygons}
\index{"!polycheck command}
\begin{quote}
Syntax: {\vt !polycheck} [{\it layer ...}]
\end{quote}
This command will test polygons for reentrancy and other defects.  It
takes a list of layer names as arguments, which will limit the testing
to polygons on those layers.  If no arguments are given, all layers
will be used.

If polygons are selected before the command is given, only the
selected polygons on the given layers (or on any layer, if no
arguments are given) will be checked.  If no polygons are selected,
all polygons on the layers given (or on any layer if no arguments are
given) will be checked.

If a polygon fails the test it will be, or remain, selected.  The {\cb
Info} command in the {\cb View Menu} can be used to determine the
exact nature of the failure.

Duplicate vertices will be silently removed from the checked polygons.

The polygons may be repairable with the {\cb !polyfix} command.

% -----------------------------------------------------------------------------
% !polymanh 100412
\subsection{The {\cb !polymanh} Command: Select Manhattan Polygons}
\index{"!polymanh command}
\begin{quote}
Syntax: {\vt !polymanh} [{\it arg\/}]
\end{quote}
Without an argument, this command will deselect all polygons, and then
select only those that are Manhattan.  If there is an argument, which
can be any text token, the non-Manhattan polygons will be selected
instead.

% -----------------------------------------------------------------------------
% !poly45 012016
\subsection{The {\cb !poly45} Command: Select Non-45 Polygons}
\index{"!poly45 command}
\begin{quote}
Syntax: {\vt !poly45}
\end{quote}
This will select polygons in the current cell that have an angle that
is not an exact multiple of 45 degrees.  All polygons on visible,
selectable layers are checked.

This is equivalent to using a ``{\vt p}'' argument with the {\cb
!check45} command.

% -----------------------------------------------------------------------------
% !polynum 060108
\subsection{The {\cb !polynum} Command: Number Vertices}
\index{"!polynum command}
\begin{quote}
Syntax: {\vt !polynum} [{\it arg\/}]
\end{quote}
This function activates a mode where the vertex numbers of selected
polygons are shown on-screen.  If no argument is given, the display
mode is toggled.  If the argument is ``{\vt y}'', ``{\vt 1}'', ``{\vt
on}'', etc., the display mode is enabled.  If the argument is ``{\vt
n}'', ``{\vt 0}'', ``{\vt off}'', etc., the display mode is disabled.

% -----------------------------------------------------------------------------
% !setflag 111609
\subsection{The {\cb !setflag} Command: Set Internal Cell Flags}
\index{"!setflag command}
\begin{quote}
Syntax: {\vt !setflag {\it name} 0|1}\\
Syntax: {\vt !setflag ?}\\
\end{quote}
This allows the flags associated with the current cell to be changed. 
The second form
of the command brings up a window containing a list of the flag names
and descriptions, as does {\cb !setflag} without arguments.

The {\et IMMUTABLE} and {\et LIBRARY} flags can also be modified with
the {\cb Set Cell Flags} pop-up from the {\cb Cells Listing} panel.

The IMMUTABLE flag will also control availability of user interface
features associated with cell editing.  This flag is also set by the
{\cb Enable Editing} button in the {\cb Edit Menu}.

\section{Libraries and Databases}

% -----------------------------------------------------------------------------
% !mklib 081318
\subsection{The {\cb !mklib} Command: Create Library File}
\index{"!mklib command}
\begin{quote}
Syntax: {\vt !mklib [{\it archive\_file\/}] [-d] [-a] [-l]|[-u]}
\end{quote}
This command will create or append to a library file adding references
to cells in the current hierarchy, or to cells in an archive file if
{\it archive\_file} is given.  If {\vt -a} is given, the library
entries will be appended to an existing library, otherwise a new
library will be created.  If {\vt -d} is given, a {\vt Directory}
reference will be created.  These are usually collections of native
{\Xic} cells.  The {\it archive\_file} argument is the directory path
in this case, if given.  If not given, the path will be prompted for. 
The {\vt -l} and {\vt -u} arguments are ignored with {\vt -d} given. 
Otherwise, if {\vt -l} is given, the reference name will be a
lower-cased version of the cell name, or, if {\vt -u} is given, the
reference will be upper-cased.

The following applies when {\vt -d} is not given.

if {\it archive\_file} is given, all cells found in the file will be
added to the output library as references.  If the file is not rooted,
a reference directory is prompted for.  This is the full path to the
directory containing the archive file.  The prompt is skipped if
{\it archive\_file} is rooted.

If {\it archive\_file} is not given, and the current cell was read
from an archive file, the user is prompted for the name of a reference
archive file.  If a name is given, the library entries will be in the
form
\begin{quote}
{\vt Reference} {\it refname} {\it reference\_path\/}/{\it name cellname}
\end{quote}
otherwise the references are in the form
\begin{quote}
{\vt Reference} {\it refname} {\it reference\_path\/}/{\it cellname}
\end{quote}
as for native cells.  The user is next prompted for the reference
path.  This should be the path to the directory where the referenced
cell files, or archive file, reside.  The current directory is the
default.  Finally, the user is prompted for the name of the library
file, which is then created, or appended to if it exists and {\vt -a}
was given.

{\bf Example}

You have a GDSII file named
{\vt /usr/local/cad/standard\_cells/std\_cell\_lib.gds} and you
want to enable the standard cell definitions in {\Xic} as
library cells.  This is a two step process.

\begin{enumerate}
\item{First create a library file with the command
\begin{quote}
\vt !mklib /usr/local/cad/standard\_cells/std\_cell\_lib.gds
\end{quote}
This creates a file named {\vt std\_cell\_lib.lib} in the current
directory.  Move this file to a directory in your cell search path if
desired (the current directory is probably in the search path).  You
may want a separate directory for library files, for example.}

\item{The library will need to be opened in order for cells in the
library to resolve references as designs are read.  From the {\cb
Libraries} panel from the {\cb Libraries List} button in the {\cb File
Menu}, double click the folder icon for the {\vt std\_cell\_lib.lib}
entry.  The icon will change to an open folder, indicating that the
library is now open.

You can add an {\vt OpenLibrary} call to your {\vt .xicstart} file, to
open the library automatically whenever {\Xic} starts.  Otherwise, you
will need to open it manually when needed.}
\end{enumerate}

% -----------------------------------------------------------------------------
% !lsdb 090809
\subsection{The {\cb !lsdb} Command: List Special Databases}
\index{"!lsdb command}
\begin{quote}
Syntax: {\vt !lsdb}
\end{quote}
This command pops up a list of the ``special'' databases currently in
memory, by name and type.  These are the databases created by the {\vt
ChdOpenOdb}, {\vt ChdOpenZdb}, and {\vt ChdOpenZbdb} script functions. 
Special databases are also used internally, for example in the {\cb
Cross Section} command from the {\cb View Menu}.


\section{Marks}

% -----------------------------------------------------------------------------
% !mark 120909
\subsection{The {\cb !mark} Command: Create User Marks}
\index{"!mark command}
\begin{quote}
Syntax: {\vt !mark l|b|t|u|c|e|d|w|r  [{\it attr\_flags\/}]}
\end{quote}
This command allows the user to add annotation marks to the cell
display, physical or electrical.  These marks are not part of the
design and will not be saved in output, but are useful for temporarily
marking or highlighting an area for reference.  They will appear on
plots of the cell.

The marks are persistent to a cell, meaning that they will appear
whenever the cell is displayed as the top-level cell in a window. 
Each cell in memory can have its own set of marks.  Marks are not
displayed in expanded subcells.

The first argument is a letter giving the initial type of mark to
create.  When the command is active, any of these letters may be typed
in a drawing window, which will change the current mark type.  While
the command is active, clicking twice or dragging will produce a mark,
and Shift-clicking in an existing mark will delete the mark.

The optional {\it attr\_flags} is a decimal number representing flags
bits that control presentation format of the mark.  The bits are

\begin{description}
\item{bit 0}\\
When set, a dashed line is used, otherwise solid.
\item{bit 1}\\
When set, the mark will blink.
\item{bit 2}\\
When set, an alternate color will be used for the mark (bit 1 is
ignored).  The default is the normal highlighting color.
\end{description}

The value is a digit representing the set bits, for example 3 sets bits 0
and 1, 5 sets bits 0 and 2, etc.  A value 0 is the default.

When the command is active, pressing a digit key will reset the current
attribute flags for subsequent marks.

The following marks are available:
\begin{description}
\item{\vt l}\\
Draw a line.  Click twice or drag to define the line endpoints.

\item{\vt b}\\
Draw an open box.  Click twice or drag to define the box boundary.

\item{\vt t}\\
Draw an open ``horizontal'' triangle, with the base a vertical line,
and the third point pointing to the left or right at the midpoint of
the base.  The triangle will fit inside of the ghost-drawn box shown
during creation.  The initial press location sets the x coordinate of
the triangle base.

\item{\vt u}\\
Draw an open ``vertical'' triangle, with the base a horizontal line,
and the third point pointing up or down at the midpoint of the base. 
The triangle will fit inside of the ghost-drawn box shown during
creation.  The initial press location sets the y coordinate of the
triangle base.

\item{\vt c}\\
Draw an open circle.  The press location is the center of the circle,
and the distance to the second point sets the radius.

\item{\vt e}\\
Draw an open ellipse.  The ellipse will fit inside of the ghost-drawn
box shown during creation.
\end{description}

To delete a mark, while the {\cb !mark} command is active, click on
the mark to delete with the {\kb Shift} key held.  Any mark under the
click location will be deleted, not just those of the current type.

Marks can be saved to a file, and restored from a file.  This is
accomplished by giving the following code letters, which can appear in
the same contexts as the mark code letters.

\begin{description}
\item{{\vt d} or {\vt w}}\\
The user will be prompted for the name of a file, then the
existing marks in the current cell will be written to the file.

\item{\vt r}\\
The user will be prompted for the name of a file, which should be in
the format produced with the {\vt d} or {\vt w} option.  If the file
was produced for the same cell name and display mode of the current
cell, the marks will be read from the file and added to the current
cell.
\end{description}

The file format is not currently documented, but is very simple and
should be easy to figure out by inspection.

The marks manipulated with the {\cb mark} command are the same as the
marks produced with the {\vt AddMark} script function.  Note that {\vt
AddMark} can create additional mark types not (yet) supported by the
command interface.


\section{Memory Management}

% -----------------------------------------------------------------------------
% !clearall 060108
\subsection{The {\cb !clearall} Command: Clear All Memory}
\index{"!clearall command}
\begin{quote}
Syntax: {\vt !clearall}
\end{quote}
This command will clear all program memory, no questions asked,
similar to the {\vt ClearAll} script function.  Be careful, since
anything cleared and not saved is gone forever.  There is no current
cell when the operation completes, so that a new cell must be opened
explicitly.

% -----------------------------------------------------------------------------
% !vmem 060108
\subsection{The {\cb !vmem} Command: Windows Virtual Memory Info}
\index{"!vmem command}
\begin{quote}
Syntax: {\vt !vmem}
\end{quote}
This command is available in Microsoft Windows releases only.  It will
print system virtual memory information in a pop-up window.  This
probably has very limited value to the user.

% -----------------------------------------------------------------------------
% !mmstats 060108
\subsection{The {\cb !mmstats} Command: Show Memory Manager
 Statistics}
\index{"!mmstats command}
\begin{quote}
Syntax: {\vt !mmstats}
\end{quote}
The command will print, on the console window, statistics from the
first-level memory manager.  The first column is the internal name of
a data structure being managed.  The second column is the size of the
structure in bytes.  The remaining columns are:

\begin{tabular}{ll}
\vt fl & length of the full block list, each block contains 64 entries\\
\vt fh & hash table width for full list entries\\
\vt nfl & length of the not-full block list\\
\vt nfh & hash table width for not-full list entries\\
\vt u & number of bytes in use\\
\vt nu & number of bytes allocated but not in use\\
\end{tabular}

This information is probably not of much value to the user.

% -----------------------------------------------------------------------------
% !mmclear 071815
\subsection{The {\cb !mmclear} Command: Clear Recycle Free Lists}
\index{"!mmclear command}
\begin{quote}
Syntax: {\vt !mmclear}
\end{quote}
This will free the caches associated with the memory manager.  Each
managed data type has a cache of deleted objects, which are used to
quickly service an allocation request.  This command will clear the
caches, giving the object memory back to the system.  This is
implicitly called by {\cb !clearall} and the {\vt ClearAll} script
function.


%\ifoa
\section{OpenAccess Interface}

% -----------------------------------------------------------------------------
% !oaversion 012713
\subsection{The {\cb !oaversion} Command: Print OpenAccess Release Number}
\index{"!oaversion command}
\begin{quote}
Syntax: {\vt !oaversion}
\end{quote}
This command exists only when the OpenAccess plug-in is loaded.

This command will print, on the prompt line, the OpenAccess release
number.

% -----------------------------------------------------------------------------
% !oadebug 062313
\subsection{The {\cb !oadebug} Command: Enable Logging}
\index{"!oadebug command}
\begin{quote}
Syntax: {\vt !oadebug} [{\vt +}{\vt |}{\vt -}] [{\vt l}[{\vt oad}]]
[{\vt p}[{\vt cell}]] [{\vt n}[{\vt et}]]
\end{quote}
This function enables or disables logging of OpenAccess interactions
and operations.  There are three categories of messages.

\begin{description}
\item{\vt load}\\
Messages emitted when reading cell data from OpenAccess and building
equivalent cell structures in {\it Xic}.

\item{\vt pcell}\\
Messages emitted when instantiating parameterized cells.

\item{\vt net}\\
Messages emitted when evaluating connectivity.
\end{description}

Each category can be separately enabled or disabled, depending on
whether the keyword follows a `$+$'' or `$-$'.  An initial virtual
`$+$' is assumed.  Only the first character of the keyword needs to be
given, and keyword recognition is case-insensitive.  All keywords are
initially disabled (no logging).

Example: turn on {\vt net}, turn off {\vt load}.
\begin{quote}
\vt !oadebug n -l
\end{quote}

With no arguments given, the command will print the present flag
status on the prompt line.

The debugging output will go to a log file named ``{\vt
oa\_debug.log}'' which will be located in the log files area.  The {\cb
Log Files} button in the {\cb Help Menu} will enable access to the log
files.

The {\cb Logging} button in the {\cb Help Menu} brings up a panel from
which the three OpenAccess logging flags can be set, as an alternative
to using the {\cb !oadebug} command.


% -----------------------------------------------------------------------------
% !oanewlib 012713
\subsection{The {\cb !oanewlib} Command: Create New OpenAccess Library}
\index{"!oanewlib command}
\begin{quote}
Syntax: {\vt !oanewlib} {\it libname} [{\it techlibname\/}]
\end{quote}
This command exists only when the OpenAccess plug-in is loaded.

This will create a new library {\it libname} if it does not already
exist.  The {\it techlibname} is the name of an existing library, if
given.  The new library will attach to the same technology database as
{\it techlibname}, or will attach to the local technology database
found in {\it techlibname} if {\it techlibname} has no attachment. 
If {\it techlibname} is given then it must exist.

If {\it techlibname} is not given, then the technology will be attached
from the library named in the {\et OaDefTechLibrary} variable, if that
variable is set.  If no technology source is found, the library will
be created with an empty technology database.

If the library is created, it will be given a property which allows
{\Xic} to write into it.  Setting or clearing of this property, or
``branding'' the library, can be controlled subsequently with the {\cb
!oabrand} command.

% -----------------------------------------------------------------------------
% !oabrand 022316
\subsection{The {\cb !oabrand} Command: Permit Save from {\Xic} in OA Lib}
\index{"!oabrand command}
\begin{quote}
Syntax: {\vt !oabrand} [{\it libname\/} [{\vt y|n}]]
\end{quote}
This command exists only when the OpenAccess plug-in is loaded.

By default, OpenAccess libraries that were not created by {\Xic} are
read-only within {\Xic}.  This is due to the fact that overwriting
Virtuoso views will destroy them for use with Virtuoso, and the same
probably applies to files for other tools as well.

If the second argument is not given, the branded status of the named
library is reported on the prompt line.  Otherwise, this function will
apply or remove the brand to a library.  The second argument, if
affirmative, will cause the brand to be applied.  Otherwise, an
existing brand will be removed.  This argument can be any commonly
known name for affirmation such as ``{\vt y}'', ``{\vt yes}'', ``{\vt
true}'', ``{\vt 1}'', etc.  If not recognized as affirmative, it is
taken as non-affirmative.

If no library is given, the variable {\et OaDefLibrary} is checked for
a library name, which is used if set. 

Libraries that are created by {\Xic} are already branded.  If needed,
this command can be used to remove write permission for {\Xic} by
un-branding.  This can also be used to brand a library created by
another tool, allowing {\Xic} to write into that library.  The user
must understand the risks involved.

% -----------------------------------------------------------------------------
% !oatech 032017
\subsection{The {\cb !oatech} Command: Query OA Technology Database}
\index{"!oatech command}
\begin{quote}
Syntax: {\vt !oatech} {\it cmd} {\it libname} [{\it args\/}]
\end{quote}
This command exists only when the OpenAccess plug-in is loaded.

This function has a number of forms, corresponding to various actions
to perform on the technology database.  These forms, and the
corresponding actions, are described below.  In each case, the first
character of the first token indicates the command type.  If this is
preceded by a hyphen, the hyphen will be ignored.  Thus, for example,
first arguments ``{\vt -p}'', ``{\vt p}'', and ``{\vt print}'' are all
equivalent.

\begin{description}
\item{[-]{\vt a}[{\vt ttach}] {\it libname} {\it fromlib}}\\
Attach the technology database from {\it fromlib} to {\it libname}. 
This will fail if {\it libname} has a local technology database, such
must be destroyed first.  If {\it fromlib} has an attachment, then
{\it libname} will receive the same attachment, otherwise {\it
libname} will attach to the local technology database in {\it
fromlib}.

\item{[-]{\vt d}[{\vt estroy}] {\it libname}}\\
If {\it libname} has an attached technology database, the attachment
will be removed.  Otherwise, the local technology database will be
destroyed.

\item{[-]{\vt h}[{\vt as\_attached}] {\it libname}}\\
This produces a message on the prompt line indicating whether or not
{\it libname} has an attached technology database, and if so, provides
the name of the library supplying the technology database.

\item{[-]{\vt p}[{\vt rint}] {\it libname} [{\vt -o} {\it filename\/}]
  [{\it which} [{\it prname\/}]]}\\
If {\it which} and {\it prname} are not given, a file in the format of
a Virtuoso ASCII technology file will be produced, containing all
technology information known to {\Xic} from the technology database
associated with {\it libname}. 

If {\it which} is given (including ``{\vt all}''), the file format is
not specific and a complete data dump of relevant data.  This is
intended for debugging and information searching.

Output goes to the console window by default, but the {\vt -o} option,
if given, signals that the following argument is a file name for
output.

The {\it which} is a code indicating what type of information to
print, and {\it prname} is a sub-type which applies to particular
values of {\it which}.  The prefixes understood for {\it which} are
listed below, characters that follow the prefix are ignored. 
Recognition is case-insensitive.

\begin{tabular}{lcl}
\bf prefix & \bf prname & \bf will print\\
``{\vt all}''  &   & everything\\
``{\vt u}''    &   & units\\
``{\vt an}''   & * & analysis libraries\\
``{\vt l}''    & * & layers\\
``{\vt o}''    & * & operating points\\
``{\vt p}''    & * & purposes\\
``{\vt si}''   & * & site definitions\\
``{\vt va}''   &   & values\\
``{\vt viad}'' & * & via definitions\\
``{\vt vias}'' &   & via specifications\\
``{\vt viav}'' &   & via variables\\
``{\vt co}''   & * & constraint groups\\
``{\vt cg}''   & * & constraint groups (as above)\\
``{\vt cp}''   &   & constraint parameters\\
``{\vt d}''    &   & derived layer parameters\\
``{\vt ap}''   &   & application object definitions\\
``{\vt g}''    & * & groups\\
\end{tabular}

For the types marked with an asterisk above, the {\it prname} is
recognized as the name associated with the records of that type, and
only the record with matching name, if any, will be printed.  If {\it
prname} is not given, all records of the selected type are printed.

\item{[-]{\vt u}[{\vt nattach}] {\it libname}}\\
If {\it libname} has an attached technology database, remove the
reference.
\end{description}

% -----------------------------------------------------------------------------
% !oasave 030416
\subsection{The {\cb !oasave} Command: Save Cell to OA Library}
\index{"!oasave command}
\begin{quote}
Syntax: {\vt !oasave} [{\vt -a}] [{\it libname\/}]
\end{quote}
This command exists only when the OpenAccess plug-in is loaded.

Save the current cell to {\it libname\/}.  If no library name is
given, the variable {\et OaDefLibrary} is checked for a library name,
which is used if set.  If the {\vt -a} option is given, the cell
hierarchy under the current cell is written, otherwise only the
current cell is written.  The value of the {\et OaUseOnly} variable
will limit the data written to electrical or physical.  This tracks
the setting ot the {\cb Data to use from OA} radio button group in the
{\cb OpenAccess Libraries} panel.

% -----------------------------------------------------------------------------
% !oaload 030416
\subsection{The {\cb !oaload} Command: Read Cell from OA Library}
\index{"!oaload command}
\begin{quote}
Syntax: {\vt !oaload} [{\it libname\/} [{\it cellname\/}]]
\end{quote}
This command exists only when the OpenAccess plug-in is loaded.

This will load the given cell and its hierarchy into {\Xic}.  If the
{\it cellname} is not given, all cells found in the library will be
loaded into {\Xic}.  If no library is given, the variable {\et
OaDefLibrary} is checked for a library name, which is used if set. 
The value of the {\et OaUseOnly} variable will limit the data read to
electrical or physical.  This tracks the setting ot the {\cb Data to
user from OA} radio button group in the {\cb OpenAccess Libraries}
panel.

% -----------------------------------------------------------------------------
% !oadelete 012713
\subsection{The {\cb !oadelete} Command: Delete OpenAccess Object}
\index{"!oadelete command}
\begin{quote}
Syntax: {\vt !oadelete} {\it libname} {\it cellname} [{\it viewname\/}]
\end{quote}
This command exists only when the OpenAccess plug-in is loaded.

The {\it viewname}, if given, can be an actual OpenAccess view name,
or ``{\vt electrical}'', or ``{\vt physical}''.  The latter two map
into corresponding OpenAccess view names.

The indicated cell and view in the library will be destroyed.  If the
{\it viewname} is not given, all views for the cell will be destroyed.

Be careful, this operation can not be undone.
%\fi


\section{Parameterized Cells}

% -----------------------------------------------------------------------------
% !rmpcprops 032017
\subsection{The {\cb !rmpcprops} Command: Remove PCell Properties}
\index{"!rmpcprops command}
\begin{quote}
Syntax: {\vt !rmpcprops} [{\vt -a}]
\end{quote}
{\bf Warning: this operation is not undoable.}

This command applies to all cells in the hierarchy of the current
physical cell.  There are two passes made through the hierarchy.  On
the first pass, cells that are parameterized cell (pcell) sub-masters
may have their {\et pc\_name} and {\et pc\_params} properties removed. 
This will be true for ``foreign'' pcells created in and imported from
another tool or library such as OpenAccess, and if {\vt -a} is given,
this will also apply to native pcells.  Once these properties are
removed from a pcell sub-master.  the cell becomes in all respects an
ordinary cell.

On the second pass, the masters of cell instances that have pcell
properties are checked, and if the master does not have pcell
properties (they were likely removed in the first pass), the instance
pcell properties are removed.

Running this command will remove any ambiguity about whether
sub-master cells will be saved to an archive (they will always be
saved, since they are now normal cells), and there will never be an
attempt to resolve placements of the cells by executing a super-master
(instances are no longer seen as pcell placements).  All history that
the cell was once created from a pcell super-master is gone.

This command is {\bf not undoable}.  Once the properties are stripped,
there is no way to put them back, except perhaps very laboriously by
hand.  Don't use this command unless you want all pcell history in the
current cell hierarchy to go away forever.

When importing design data from Cadence Virtuoso, for example, using
the Express PCell feature to obtain pcell sub-masters, you may wish to
use this command on the new hierarchy.  In {\Xic}, the pcells can not
be evaluated anyway, and their presence may cause trouble.  For
example, if the hierarchy is saved to disk as a GDSII or other archive
file, by default the sub-masters are {\bf not} written.  When reading
this file at some future time, unless the Virtuoso database is present
and able to provide the sub-masters, the pcell instances won't be
resolved.  Thus you must remember to explicitly enable saving the
sub-masters when writing output, unless you have used the {\cb
!rmpcprops} command.

% !preload 081318
\subsection{The {\cb !preload} Command: Pre-Load PCell Sub-Masters}
\index{"!preload command}
\begin{quote}
Syntax: {\vt !preload} {\it archive}
\end{quote}
Suppose that one has a collection of pcell sub-master {\Xic} cells
that have been imported from a foreign OpenAccess tool such as
Virtuoso.  These are assumed to not be portable pcells.  One would
like to use these cells to resolve pcells when reading directly from
the OpenAccess database.  There are two issues:  1) the system needs
to know that these cells are available, and 2) one has to remap the
cell names.  The first issue is fixed simply by making the sub-masters
available through the library mechanism.  The second issue is due to
the simple naming convention of the sub-master instantiations, which
suffixes the pcell name with ``{\vt \$\$}" followed by an integer. 
The integer is a count of when the cell was generated, and is
consistent with the design output at the time, but there is no
guarantee the the names are consistent with the design at other times.

This command will read a collection of cells into a temporary symbol
table.  Those that are pcell sub-masters have the property strings
entered into the internal pcell database, under the existing cell
name.  This will cause the correct cell name to be associated with a
given parameter set.  The cells are not saved, but the entries in the
pcell table persist so that resolution, when reading OpenAccess or
otherwise, will reference the correct cells.  The cell collection must
be available through an open library, and this function must be run
before loading the design.

The argument is either a path to a directory containing native pcell
sub-master cells, or a path to an archive file that contains the
cells.  This capability is also available with the {\vt
RegisterSubMasters} script function.

\section{Rulers}

% -----------------------------------------------------------------------------
% !dr 012815
\subsection{The {\cb !dr} Command: Delete Rulers}
\index{"!dr command}
\begin{quote}
Syntax: {\vt !dr} [{\it arg\/}]
\end{quote}
This will delete currently displayed rulers, as generated by the {\cb
Rulers} command in the {\cb View Menu}.  If no {\it arg} is given, the
most recently generated ruler is deleted.  The {\it arg} can be an
integer, or `{\vt a}'.  if `{\vt a}' is given, all rulers for the
current cell are deleted.  If a number is given, that ruler, counting
backward from the most recently generated, will be deleted, i.e., 0
erases the most recent ruler, 1 erases the one before that, etc.


\section{Scripts}

% -----------------------------------------------------------------------------
% !script 060108
\subsection{The {\cb !script} Command: Add Script}
\index{"!script command}
\begin{quote}
Syntax: {\vt !script} {\it name} [{\it path\/}]
\end{quote}
This command will add {\it name} to the list of user-defined function
buttons in the {\cb User Menu}.  When the button is pressed, the file
indicated by {\it path} will be executed as script text.  The {\it
name} variable should be the actual name to appear in the menu.  The
{\it path} should be a full path to a file, which can be any file name
as long as it contains a script, i.e., the {\vt .scr} extension is
optional.  A script added that has the same name as a script in the
technology file or the script path will supersede the previous script
definition.

If no {\it path} is given, any command previously added with the {\cb
!script} command with the same name is deleted from the {\cb User
Menu}.  This does not affect scripts defined in the technology file or
in the script path, except that these are reverted to if their names
matched an input to the {\cb !script} command.

% -----------------------------------------------------------------------------
% !rehash 060108
\subsection{The {\cb !rehash} Command: Rebuild User Menu}
\index{"!rehash command}
\begin{quote}
Syntax: {\vt !rehash}
\end{quote}
This command re-reads the script files and libraries along the script
search path, and rebuilds the {\cb User Menu}, the same as the {\cb
Rehash} button in the {\cb User Menu}.

% -----------------------------------------------------------------------------
% !exec 060108
\subsection{The {\cb !exec} Command: Execute a Script}
\index{"!exec command}
\begin{quote}
Syntax: {\vt !exec {\it script\/}}
\end{quote}
This command will execute a script.  The argument is a string giving
the script name or path.  If the script is a file, it must have a
``{\vt .scr}'' extension.  The ``{\vt .scr}''" extension is optional
in the argument.  If no path is given, the script will be opened from
the search path or from the internal list of scripts read from the
technology file or added with the {\cb !script} command.  If a path is
given, that file will be executed, if found.  It is also possible to
reference a script which appears in a sub-menu of the {\cb User Menu}
by giving a modified path of the form ``{\vt @@/{\it
libname}/.../{\it scriptname}}''.  The {\it libname} is the name of
the script menu, the ...  indicates more script menus if the menu is
more than one deep, and the last component is the name of the script.

% -----------------------------------------------------------------------------
% !lisp 062213
\subsection{The {\cb !lisp} Command: Execute Lisp Script}
\index{"!lisp command}
\index{functions}
\begin{quote}
Syntax: {\vt !lisp} {\it filename} [{\it args ...\/}]
\end{quote}
This is an interface to the Lisp/Skill parser that is under
development.  The {\it filename} is searched for in the script path
and the current directory, and is expected to contain a script in Lisp
format.  The file will be parsed and the code executed.

Any text following the filename will be parsed as Lisp and included in
the argument list.  The argument list can be accessed from within the
script through the global variables {\vt argc} and {\vt argv}.
\begin{description}
\item{\vt argc}\\
An integer giving the length of {\vt argv}.
\item{\vt argv}\\
A list.  The first element is the file name, followed by the arguments
if any.
\end{description}

See \ref{lisp} for a description of the language implementation in
{\Xic}.

% -----------------------------------------------------------------------------
% !py 021713
\subsection{The {\cb !py} Command: Execute Python Script}
\index{"!py command}
\index{Python}
\begin{quote}
Syntax: {\vt !py} {\it scriptfile} {\it args} ...
\end{quote}
This command is available only if the Python interpreter plug-in has
been loaded, and is not available under Microsoft Windows.

The arguments will be passed to the Python interpreter
for evaluation.

% -----------------------------------------------------------------------------
% !tcl 021813
\subsection{The {\cb !tcl} Command: Execute Tcl Script}
\index{"!tcl command}
\index{Tcl/Tk}
\begin{quote}
Syntax: {\vt !tcl} {\it scriptfile} {\it args} ...
\end{quote}
This command is available only if the Tcl/Tk or Tcl-only plug-in has
been loaded, and is not available under Microsoft Windows. 

The command will execute a Tcl script (see \ref{tcltk}), contained in
the file given as an argument.  Tk functions are not supported. 
Command arguments can be referenced in the script using the standard
{\vt argc}, {\vt argv} mechanism.  The language syntax is provided in
documentation supplied with Tcl, and is described in several books. 
Much information can be found on the internet.

The {\it scriptfile} is expected to contain Tcl commands, and is
linearly parsed and executed.

% -----------------------------------------------------------------------------
% !tk 021813
\subsection{The {\cb !tk} Command: Execute Tcl/Tk Script}
\index{"!tk command}
\index{Tcl/Tk}
\begin{quote}
Syntax: {\vt !tk} {\it scriptfile} {\it args} ...
\end{quote}
This command is available only if the Tcl/Tk plug-in has been loaded,
and is not available under Microsoft Windows.

This command will execute a Tcl/Tk script (see \ref{tcltk}), contained
in the file given as an argument.  Command arguments can be referenced
in the script using the standard {\vt argc}, {\vt argv} mechanism. 
The language syntax is provided in documentation supplied with Tcl/Tk,
and is described in several books.  Much information can be found on
the internet.

The {\it scriptfile} must have a {\vt .tcl} or {\vt .tk} extension,
appropriate for the file contents.  The Tk language is a superset of
Tcl, containing a graphical interface.  The files are executed
differently:  Tk files are executed in an event loop and a default
window will be created, and execution will continue until all created
windows are destroyed.  Tcl files are interpreted linearly, with no
graphics.

An example Tk script named ``{\vt tkdemo.tk}'' is provided with the
examples and can be used to set up and test the Tk execution facility.

% -----------------------------------------------------------------------------
% !listfuncs 060108
\subsection{The {\cb !listfuncs} Command: List Saved Functions}
\index{"!listfuncs command}
\index{functions}
\begin{quote}
Syntax: {\vt !listfuncs}
\end{quote}
This command pops up a list of the script functions that are currently
saved in memory.  All functions that {\it Xic} sees are saved.

% -----------------------------------------------------------------------------
% !rmfunc 060108
\subsection{The {\cb !rmfunc} Command: Remove Saved Function}
\index{"!rmfunc command}
\index{functions}
\begin{quote}
Syntax: {\vt !rmfunc} {\it func\_name\_reg\_exp}
\end{quote}
This command allows functions to be removed from memory.  The argument
is a regular expression that should match one or more function names. 
Saved functions can be listed with {\cb !listfuncs}.

% -----------------------------------------------------------------------------
% !mkscript 030215
\subsection{The {\cb !mkscript} Command: Create Current Cell Script}
\index{"!mkscript command}
\begin{quote}
Syntax: {\vt !mkscript} [{\vt -d} {\it depth\/}] [{\it filename\/}]
\end{quote}
This command writes a script file that will create the contents of the
current cell, and its hierarchy to arbitrary depth.  When executed,
the script will create the cells, and place objects and subcells as
needed to recreate the original cells.

This could be useful as a starting point for creating parameterized
cells.  It might also be useful to new users for learning the
scripting language.

The function presently works in one mode only, i.e., you can generate
a script that will build electrical or physical cells or hierarchies,
but not both modes together.  One could generate a script for each
mode and combine them by hand, however.

The {\it depth} argument is an integer depth, with 0 being the
default, which indicates to write the current cell only.  The value -1
or a word starting with `a' indicate all levels.

If a {\it filename} is given, output goes to that file.  Otherwise,
the script is written to ``{\vt mkscript.scr}'' in the current
directory.

Although things seem pretty solid for physical mode, electrical mode
is far more complex and should be considered experimental at this
point.  There are probably things that don't work, for example mutual
inductors probably won't be created.  The situation should improve in
time, though it is not clear if this feature is of much use in
electrical mode.

Incorporation of this feature led to some significant updates in
script functions and elsewhere for efficient support.

% -----------------------------------------------------------------------------
% !ldshared 072517
\subsection{The {\cb !ldshared} Command: Load Plug-In Script Library}
\index{"!ldshared command}
\begin{quote}
Syntax: {\vt !ldshared} {\it library\/} [{\it args...\/}]
\end{quote}
This will load a script library plug-in as created with the {\vt
scrkit} provided with {\Xic} distributions.  The {\vt scrkit}
directory contains files and instruction for creating libraries of
C/C++ functions which can be called from scripts.

The required argument is a path to the shared library file as
generated from the {\vt scrkit} system.  Anything else in the line is
passed to the library {\vt init} function verbatim.  The library
author can add a parser for this, for providing initialization options
if needed.

Loaded libraries can not be unloaded, but can be reloaded, perhaps
after modification and recompile.  If a library is reloaded, a {\cb
!rehash} is done, to eliminate bad function pointers to the library
functions, which would likely crash the program if referenced.

\section{Selections}

% -----------------------------------------------------------------------------
% !select 092717
\subsection{The {\cb !select} Command: Select Objects}
\index{"!select command}
\index{selections!"!select command}
\begin{quote}
Syntax: {\vt !select} {\it what\/} {\it qualifier\_or\_regex}
 [{\it keyword expression}\/]
\end{quote}
This command allows objects to be selected according to the
specification provided.  There is also a companion {\cb !desel}
command which deselects selected objects.

The values (literal) for {\it what} are:
\begin{quote}\rr
{\vt c}[ell]\\
{\vt l}[ayer]\\
{\vt n}[ame]\\
{\vt m}[odel]\\
{\vt v}[alue]\\
{\vt p}[aram] or {\vt i}[nitc]\\
{\vt o}[ther]\\
{\vt y}[...] (indicates {\et nophys})
\end{quote}
Only the first character of the token is significant.  If `{\vt c}'
is given, the intended targets for selection are subcells.  If `{\vt
l}' is given, the targets are objects on a specified layer.  The
remaining options specify electrical properties, which allows
selection of devices with these properties.  The {\vt param} property
was known in earlier releases as the {\vt initc} (initial condition)
property, both names are accepted.

The {\it qualifier\_or\_regex\/} is a pattern matching regular
expression.  This is expected to match the layer or cell name or
property value as per {\it what}.  All objects with a successful
pattern match are selected.  The layer qualifier consists of the layer
regular expression, followed by the optional tokens
\begin{quote}\rr
{\vt b}[oxes]\\
{\vt w}[ires]\\
{\vt p}[olygons]\\
{\vt l}[abels]\\
\end{quote}
These specify types of objects that will be selected.  For selecting
objects on physical layers, an additional {\it keyword expression}
pair can be included in the command.  The complete syntax in this case
is
\begin{quote}
    {\vt !select l[ayer] {\it layer\_re} [b[ox]] [w[ire]] [p[olygon]]
      [l[abel]] [{\it keyword expression\/}]}
\end{quote}
    
For layers, the hyphen (`{\vt -}') is an alias for the current layer,
but only as an isolated token and not as part of a layer expression.

The {\it keyword} is one of the DRC keywords {\et Overlap}, {\et
IfOverlap}, {\et NoOverlap}, {\et AnyOverlap}, {\et PartOverlap}, and
{\et AnyNoOverlap}, and the {\it expression} is a layer expression. 
If the {\it keyword} and {\it expression} are given, the {\it
expression} must be true if an object is to be selected or deselected
(with the {\cb !desel} command).  The logic is shown in the table
below.

\begin{description}
\item{\vt Overlap}\\
  True if the object is completely covered by the {\it expression\/}.
\item{\vt IfOverlap}\\
  True if the object is completely covered or completely uncovered
      by the {\it expression\/}.
\item{\vt NoOverlap}\\
  True if the object is completely uncovered by the {\it expression\/}.
\item{\vt AnyOverlap}\\
  True if there is nonzero overlap area between the object and the
  {\it expression\/}.
\item{\vt PartOverlap}\\
  True if the object is partially covered by the {\it expression\/}, i.e.,
  not completely covered or uncovered.
\item{\vt AnyNoOverlap}\\
  True if the object is not completely covered by the {\it expression\/}.
\end{description}
          
Examples:
\begin{quote}
    {\vt !select l CAA b Overlap CPG}
\end{quote}
This will select boxes on CAA that are entirely covered by CPG.

\begin{quote}
    {\vt !select l V1|V2 AnyNoOverlap M1 \& M2}
\end{quote}
This will select all geometric objects on V1 and V2 that are not
completely covered by both M1 and M2.

The {\cb !select}/{\cb !desel} commands with electrical property
modifiers also work in physical mode.  The selected cell will be the
physical dual of the electrical cell containing the property.  The
duality must have been established with the commands in the {\cb
Extract Menu}.

Examples:
\begin{quote}
Select all instances of the cell named ``andgate'':
\begin{quote}\vt
!select c andgate
\end{quote}
Select all instances of cells with name starting with ``and''.  The `.' is
a wildcard:
\begin{quote}\vt
!select c and.
\end{quote}
Select resistors R1-R9:
\begin{quote}\vt
!select n R[1-9]
\end{quote}
Select all polygons and wires on layer M2:
\begin{quote}\vt
!select l M2 w p
\end{quote}
Select everything on M2
\begin{quote}\vt
!select l M2
\end{quote}
\end{quote}

A blank field is taken as ``all''.  Entering {\vt !select} without
arguments selects everything in the cell.  Giving ``{\vt !select c}''
selects all subcells, etc.  For the layer modifier, the literal ``{\vt
all}'' can be used to specify all layers (hopefully there is no layer
named ``all'').  For example, ``{\vt !select l all b}'' selects boxes on
all layers.  This is redundant, since ``.'' performs the same global
match as ``all''.

There are a couple of special cases:  ``{\vt !select all}'' will
select all geometry (not subcells) the same as ``{\vt !select l}'',
and ``{\vt !select .}'' will select everything, the same as with no
argument.

The regular expression matching may take some getting used-to.  A
match will be indicated if the name contains a substring of the given
string, case insensitive.  For example, ``{\vt !select n Lc}'' would
match {\vt Lc, Vlc, IallCnt}, etc.  The circumflex (`\symbol{94}') can
be used to force matching at the start of a string, and the dollar
sign (`\$') forces matching at the end of a string.  Thus, to match a
literal, one should use the form ``\symbol{94}{\it string}\$''.

% -----------------------------------------------------------------------------
% !desel 060108
\subsection{The {\cb !desel} Command: Deselect Objects}
\index{"!desel command}
\begin{quote}
Syntax: {\vt !desel} {\it what qualifier\_or\_regex}
 [{\it keyword expression}\/]
\end{quote}
This is the companion to the {\cb !select} command.  The arguments are
the same, however objects indicated by the arguments are deselected if
selected, otherwise there is no effect.

% -----------------------------------------------------------------------------
% !zs 060108
\subsection{The {\cb !zs} Command: Zoom to Selected Objects}
\index{"!zs command}
\begin{quote}
Syntax: {\vt !zs}
\end{quote}
Giving this command will change the view in the current window (the
last drawing window to contain the mouse pointer) to show all selected
objects.  The window will zoom in or out to show all selections, plus
a small margin.


\section{Shell}

% -----------------------------------------------------------------------------
% !shell 022111
\subsection{The {\cb !shell} Command: Pop Up Terminal Window}
\label{shellcmd}
\index{"!shell command}
\begin{quote}
Syntax: {\vt !shell} [{\it command...\/}]
\end{quote}
Giving the command ``{\cb !shell}'' without arguments is equivalent to
giving a bare exclamation point with no following text.  If a {\it
command} is given, that command will be run in the pop-up window. 
This is equivalent to {\vt !}{\it command}, provided that this is not
also a built-in command.  The use of {\vt !shell} removes the
ambiguity.

The shell which is used to execute operating system commands can be
selected by the user, through the {\et Shell} variable and the {\cb
!set} command.  If this is not set, the {\et SHELL} environment
variable is used if set, otherwise the default ``{\vt /bin/sh}'' shell
is used, except under Windows where the standard ``DOS box'' is the
default.

Under Windows, it is possible to open a Cygwin {\vt bash} shell window
instead of the brain-dead ``DOS box'', if Cygwin is installed.  If the
{\et Shell} variable or {\et SHELL} environment variable (in that
precedence) contains the Windows path to the {\vt bash.exe} file, a
bash window will be used.  If neither is given, and {\vt bash.exe}
resides in {\vt /bin} or {\vt /cygwin/bin} on the current disk drive,
or the {\vt CYGWIN\_BIN} environment variable is set to the Windows
path to the directory containing {\vt bash.exe}, a bash shell will be
used.  Only if {\vt bash.exe} is not found, or one of the variables
specifically invokes ``{\vt cmd}'', will a DOS box be used.


% -----------------------------------------------------------------------------
% !ssh 022111
\subsection{The {\cb !ssh} Command: Connect to Remote System}
\index{"!ssh command}
\begin{quote}
Syntax: {\vt !ssh} [{\it hostname\/}]
\end{quote}
This command will pop up a terminal window that will contain an {\vt
ssh} login process to a remote host.  If the {\it hostname} is not
given with the command, it will be prompted for.
 
The {\it hostname} can actually contain additional {\vt ssh} options
if needed, and the name of the host can be in the form {\it
user\/}{\vt @}{\it host\/}, which allows logging in as {\it user\/}.
 
The {\vt ssh} process will establish X forwarding to the remote
system, and will automatically set the {\et SpiceHostDisplay} variable
if authentication is achieved before a time out.  This facilitates
using {\WRspice} on the remote system to perform simulations in
electrical mode, from the {\cb run} button in the side menu.  The
remote system must have a {\vt wrspiced} daemon running, and the {\et
SpiceHost} variable should be set to the remote host name.  The X
forwarding provided by the {\cb !ssh} shell takes care of display
string setting and permissions.  The {\cb !ssh} shell must remain
active while {\WRspice} is in use, as exiting the shell will break the
connection to {\WRspice} graphics.
 
See the description of the {\et SpiceHostDisplay} variable in
\ref{spicevars} for more information.
 
This command will work under Windows, if Cygwin is installed, along
with the Cygwin OpenSSH package.  The {\vt ssh} program will be found
if it resides in {\vt /bin} or {\vt /cygwin/bin} on the current disk,
or if the {\et CYGWIN\_BIN} environment variable is set to the path to
the directory that contains the {\vt ssh.exe} binary.  This is the
Windows path, not the path within Cygwin.  {\Xic} is not a Cygwin
program, and knows nothing about Cygwin mount points or symbolic
links.

\section{Technology File}

% -----------------------------------------------------------------------------
% !attrvars 021615
\subsection{The {\cb !attrvars} Command: List techfile attribute variables}
\index{"!attrvars command}
\begin{quote}
Syntax: {\vt !attrvars} [{\it filename\/}]
\end{quote}
Most of the internally recognized variables can be set from the
technology file (see \ref{attrvars}), using the same syntax as for
technology file keywords.  The variables are categorized as boolean or
string types, which are set using different syntax forms.

Most, but not all, variables can be set in this way.  There are a few
that are strange in one way or another and are excluded.

This command will list, in {\it filename\/}, the boolean and string
variable names that can be set in this manner.  This is intended for
reference purposes, and the list is rather long.

If {\it filename} is not specified, ``{\vt attrvars.txt}'' is used.

% -----------------------------------------------------------------------------
% !dumpcds 092717
\subsection{The {\cb !dumpcds} Command: Create Virtuoso$^{TM}$ Startup Files}
\index{"!dumpcds command}
\begin{quote}
Syntax: {\vt !dumpcds} [{\it basename\/}]
\end{quote}
This command dumps Cadence {\it Virtuoso\/}-compatible ASCII
technology, display resource (DRF), and GDSII layer mapping files
based on the present {\Xic} technology database.  The files produced
will be {\it basename\/}{\vt .txt}, {\it basename\/}{\vt .drf}, and
{\it basename\/}{\vt .gdsmap}, respectively.  If no {\it basename} is
given, it defaults to ``{\vt xic\_tech\_cds}''.


\section{Update Release}

% -----------------------------------------------------------------------------
% !update 102817
\subsection{The {\cb !update} Command: Download/Install Update}
\index{"!update command}
\begin{quote}
Syntax: {\vt !update}
\end{quote}
This command is equivalent to giving the special keyword ``{\vt
:xt\_pkgs}'' to the help system, which brings up the {\XicTools}
package management page (see \ref{update}).  The page lists installed
and available packages for each of the {\XicTools} programs for the
current operating system, and provides buttons to download and install
the packages.
 
Unlike in earlier {\Xic} releases, there is no provision for automatic
checking for updates, so this command or equivalent should be run
periodically to check for updated packages.

\section{Variables}
\label{setcmd}

% -----------------------------------------------------------------------------
% !set 102114
\subsection{The {\cb !set} Command: Set Variables}
\index{"!set command}
\index{variables}
\index{variables!setting}
\begin{quote}
Syntax: {\vt !set} {\it name} [{\it value\/}]
\end{quote}
The {\cb !set} command is used to set variable {\it name} to {\it
value}.  The {\it name} is the first token following {\cb !set}, and
{\it value} represents the rest of the line (which may be empty). 
White space is stripped from the front of the first word in
{\it value} and after the last word in {\it value}.  If {\it value}
is blank, the variable is understood as a boolean, and is ``set''.

Any variable name can be set in this manner, though there are a number
of variables with predefined names which have significance to {\Xic}
operation, which are listed in Appendix \ref{variables}.  Furthermore,
device properties can be set with a variant of this command.  A
variable which has been set can be removed with the {\cb !unset}
command.

In the {\cb !set} command, tokens in the {\it value} string of the
form \$({\it setvar}) are expanded to the string associated with {\it
setvar}, if {\it setvar} has been set previously.  This applies if
{\it setvar} was set with the {\cb !set} command or related script
functions, or if {\it setvar} is set in the environment, i.e., is an
environment variable (see \ref{xicenv}).  If {\it setvar} is not
resolved, no change is made.  Otherwise, in general, the token is
replaced with the value of {\it setvar}.

There is an exception to the direct-substitution rule.  If any
substitution string is of the form ``{\vt (...)}'', then the
parentheses and leading/trailing white space are stripped before
substitution, and the entire substituted string is enclosed in
parentheses if it is not already.  This is for convenience when adding
a directory to a search path (see \ref{searchpaths}) variable, and the
path is enclosed in parentheses, when using forms like
\begin{quote}
\vt !set path {\it dir} \$(path)
\end{quote}
In this case, the modified substitution rule ensures that {\it dir} is
logically placed in front of the search path in {\vt path}.  For
example, if {\vt path} is
\begin{quote}
\vt ( /dir1 /dir2 )
\end{quote}
then after the substitution implied above, one has
\begin{quote}
\vt path = ( {\it dir} /dir1 /dir2 )
\end{quote}
which is correct.  If the direct substitution was applied instead,
this would give
\begin{quote}
\vt path = {\it dir} ( /dir1 /dir2 )
\end{quote}
which is garbage as interpreted as a search path.

% -----------------------------------------------------------------------------
% !unset 060108
\subsection{The {\cb !unset} Command: Unset Variables}
\index{"!unset command}
\index{variables!unsetting}
\begin{quote}
Syntax: {\vt !unset} {\it varname}
\end{quote}
This command will remove the previously set {\it varname} from the
internal list of variables which have been set.  Some internal variables,
such as the paths, can not be unset, however they can be altered with the
{\cb !set} command.

% -----------------------------------------------------------------------------
% !setdump 060108
\subsection{The {\cb !setdump} Command: Dump Variables}
\index{"!setdump command}
\begin{quote}
Syntax: {\vt !setdump} [{\it filename\/}]
\end{quote}
This command will dump to {\it filename} a listing of all of the
currently defined variables, in a format accepted by the script
parser, i.e., as a series of {\vt Set} function calls.  This block can
be cut/pasted into an initialization file to restore state.

If the {\it filename} is not given, output goes to the standard
output.


\section{{\WRspice} Interface}

% -----------------------------------------------------------------------------
% !spcmd 020809
\subsection{The {\cb !spcmd} Command: Run {\WRspice} Command}
\index{"!spcmd command}
\begin{quote}
Syntax: {\vt !spcmd} [{\WRspice} command ...]
\end{quote}
This will establish a stream to {\WRspice} (if not already
established) and run the command (if given).  This is a means for
running arbitrary {\WRspice} commands.  Text output goes to the
console window.

In addition to the {\WRspice} commands, the client-side directive
\begin{quote}
{\vt send} {\it filename}
\end{quote}
is available.  The {\it filename} is that of a local SPICE input file. 
The file will have {\vt .include} and {\vt .lib} lines expanded
locally, and {\vt .spinclude}, {\vt .splib} lines will be converted to
``{\vt include}'', ``{\vt .lib}'', as is done for decks created within
{\Xic}.  The result will be sent to {\WRspice} and sourced.

